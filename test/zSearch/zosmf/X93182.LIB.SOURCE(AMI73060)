       IDENTIFICATION DIVISION.
       PROGRAM-ID. AMI73060.
      ******************************************************************
      *                    ASSOCIACAO MUTUALISTA                       *
      *                      *******************                       *
      *                                                                *
      *                       TITULO DO PROGRAMA                       *
      *                *********************************               *
      *                                                                *
      *    PROGRAMA   : AMI73060.                                      *
      *    DESCRICAO  : ESTA TRANSACAO PROCEDE A INSCRICAO EM          *
      *                 CAPITAIS DE PREVIDÊNCIA,                       *
      *                 DIFERIDOS COM OPÇÃO + CTI,                     *
      *                 CAPITAIS PARA JOVENS + CTI,                    *
      *                 PENSÕES DE REFORMA + CTI + CS                  *
      *                 PARA ASSOCIADOS EFECTIVOS/CANDIDATOS.          *
      *                                                                *
      ******************************************************************
      *           L O G     D E     A L T E R A C O E S                *
      ******************************************************************
      *  INICIO  * AUTOR  * C O M E N T A R I O S                      *
      ******************************************************************
      *2007-11-15* BALTIT * ALTERACAO AO BALCAO TITULAR                *
      *----------------------------------------------------------------*
      * 20101202 * XLUJLN * TRATAMENTO DE CLIENTES COM ORIGEM NO       *
      *          *        * FINIBANCO.                                 *
      *----------------------------------------------------------------*
      * 20110124 * XLUJLN * IMPEDIR DE ASSOCIAR CONTA FINIBANCO P/ DE- *
      *          *        * BITO DE CLIENTES NÃO FINIBANCO.            *
      *----------------------------------------------------------------*
      * 20121015 * X92509 * ALTERAÇÃO DO CÁLCULO DAS RESERVAS E        *
      *          *        * RESPONSABILIDADES PARA SEREM CALCULADOS    *
      *          *        * PELO SAS (WEBSERVICES)                     *
      *----------------------------------------------------------------*
      * 20130114 * X92475 * PASSA A TRATAR OS CAMPOS DA CONTA DE       *
      *          *        * SUBSCRICAO   DA   NOVA   VIEW AMVT0109     *
      *----------------------------------------------------------------*
      *2013-02-11* X92475 * PASSA A TRATAR NOVO SUBPRODUTO 93          *
      *----------------------------------------------------------------*
      *2013-03-05* X91726 * RETIRAR TODOS OS ACESSOS A TABELA AMT02,   *
      *          *        * SUBSTITUINDO PELA ROTINA AMCP4000 E        *
      *          *        * ACRESCENTAR VALIDACAO SUBPRODUTO 70        *
      *          *        * ONDE SE VERIFICAM VALIDACOES               *
      *          *        * COM SUBPRODUTO 60 E 80                     *
      *----------------------------------------------------------------*
      *2013-04-23* X92475 * A ACTUALIZACAO DA AMT41  PASSA  A          *
      *          *        * SER EFECTUADA NA AM88.                     *
      *----------------------------------------------------------------*
      *2013-05-03* X92475 * SE VEM DA BM45 E O PRODUTO E 73/93         *
      *          *        * (PENSAO   REFORMA), NAO VALIDA DATA INICIO *
      *----------------------------------------------------------------*
      *2013-07-10* X92475 * VALIDA MINIMO LIBERACAO A CABECA           *
      *----------------------------------------------------------------*
      *2013-09-18* X92599 * NOVOS REGULAMENTOS: AGRAVAMENTO DE IDADE   *
      *----------------------------------------------------------------*
      *2013-09-25* X92599 * NOVOS REGULAMENTOS: VALIDACAO IDADE 18/19  *
      *----------------------------------------------------------------*
      *2014-01-06* X91726 * ALTERACAO NO PARAGRAFO 2270-INSP-MEDICA    *
      *----------------------------------------------------------------*
      *2014-06-06* X92567 * C4570 - AM - NOVAS DECLARAçõES DE BOM      *
      *          *        * ESTADO DE SAúDE                            *
      *----------------------------------------------------------------*
      *2015-01-15* XPSJOF * C5165 - AM - NORMATIVO COMPLEMENTAR 2015   *
      *          *        * GRELHAS MEDICAS                            *
      *----------------------------------------------------------------*
      *2015-04-15* U78772 *        * 1651  - AM - IMPLEMENTAR DISPLAY/ *
      *          *        *        * DEBUG - TAT02(EAK)                *
      *----------------------------------------------------------------*
      *2015-05-14* X92567 * DSI-01835 - CALCULO DA IDADE DO BENEFICIÁ- *
      *          * (ALT01)* RIO SEM AGRAVAMENTO.                       *
      *          *        *                                            *
      *----------------------------------------------------------------*
      *2015-06-19* X92567 * C5719 - CORRECÇÃO DE DADOS DE CÁLCULO E    *
      *          * (ALT02)* ALTERAÇÃO DE ÉCRANS.                       *
      *          *        * ALTERAÇÃO DA VIEW DA AMT01(09->10)         *
      ******************************************************************
      *     DATA     | USER |                                          *
      *    PEDIDO    |  TAG | DESCRICAO DA ALTERACAO                   *
      *--------------+------+------------------------------------------*
      *  2015-11-10  |X92475| A IDADE PARA CALCULO DOS EXAMES  MéDICOS *
      *  MC0461-DP-N |MC0461| é A CRONOLóGICA NO DIA.                  *
      *--------------+------+------------------------------------------*
      *  2016-12-13  |X91360| PDI-C13368:                              *
      *              |C13368| PEDIDO DE AUTORIZAÇÃO PARA D.O.'S        *
      *              |      | NÃO TITULADAS (NOVAS SUBSCRIÇÕES).       *
      *--------------+------+------------------------------------------*
      *  2017-03-14  |X92567| PDI-C22948-DP-E - NORMATIVO COMPLEMENTAR *
      *              |      |                   2017                   *
      *              |      | SUBSTITUIR A AMR01013 PELA AMR01014(NOVA)*
      *--------------+------+------------------------------------------*
      *  2018-05-23  |XZ0614| PROJETO AM - MOVIMENTAÇÃO OIC - C82065   *
      *              |      | (BLOCO 5)                                *
      *              |      | ALTERAçãO: C82065                        *
      *--------------+------+------------------------------------------*
      *  2018-10-03  |XZ0643|PDI-C82065 - VALIDACAO IBAN NACIONAL      *
      *--------------+------+------------------------------------------*
      * 20190225     |DESMSG|PDI-C119891 - BALCãO 510                  *
      *--------------+------+------------------------------------------*
      * 2020-05-20   |DESMSG|PDI-C138491 - AMVT0115-CGESTMUT           *
      * 2020-07-01   |DESMSG|PDI-C123517 - CAMPO 'Nº DE CLIENTE EMPRESA*
      *              |      |              PAGA QUOTAS'                *
      *--------------+------+------------------------------------------*
      *16-12-2020* U78772 * PDI-189130 ALTERAÇÃO TAXA TÉCNICA
      *--------------+------+------------------------------------------*
      ******************************************************************
      * 2021-03-03 * X93182 * PDI C194062 - MOVIMENTAÇÃO OIC           *
      *            *        * MOVIMENTAÇÕES COM IBANS OIC SÓ SÃO       *
      *            *        * PERMITIDAS PARA BALCÕES DA APLICAÇÃO AM  *
      ******************************************************************
      * 2022-03-03 | X93182 | PDI-C201277 - DBES - Alteração dos       *
      *            | (alt03)| movimentos registados na transação GM65  *
      ******************************************************************
      *2022-07-28  * X93181 * SEGREGAÇÂO DE CLIENTES MGAM              *
      *            *  ALT02 * DADOS BASICOS DE CLIENTE:                *
      *            *        *   CLT07 -> GMT09_RELCLI                  *
      *            *        *   CLT01 -> GMT10_BASICOS                 *
      *            *        *   CLT05 -> GMT11_COMPPART                *
      *            *        *   CLT06 -> GMT12_COMPEMP                 *
      *            *        *   CLT38 -> GMT11_COMPPART                *
      ******************************************************************
      * 2022-09-29 * X93182 * INCLUSAO DO AMCPGM00 (GMT10) P/ VALIDAÇÃO*
      *            *  ALT03 * DO ZCLIENTE MANTENDO-SE O ACESSO AO COPY *
      *            *        * AMCPCL00 PARA ZCLIEMP                    *
      *            *        * +                                        *
      *            *        * SUBSTITUICAO DO AMCP0004 (CLT07) P/ COPY *
      *            *        * AMCPGM04                                 *
      ******************************************************************
      ******************************************************************
      * 2022-10-03 * XZ2534 * PDI C207004.F3 - INSERÇAO NOVA ROTINA    *
      *            * 207004 * PARA VALIDAR EXISTENCIA DOCUM.           *
      *            *        * POR DIGITALIZAR                          *
      *            *        * SE CTIPSOC = 'C' NÃO ENTRA NA ROTINA     *
      ******************************************************************
      * 2023-09-26 * XZ0643  * ITR85815_PROTOCOLOS REDE MUTUALISTA     *
      *            *  ALT04  * => ACORDOS                              *
      ******************************************************************
      * 2023-12-15 * XZ0643  * ITR108642 - Criação de Regra de Exceção *
      *            *  ALT05  * à operatoria am34                       *
      ******************************************************************
      *================================================================*
       ENVIRONMENT DIVISION.
      ******************************************************************
      *           E N V I R O N M E N T         D I V I S I O N        *
      ******************************************************************
       CONFIGURATION SECTION.
      ******************************************************************
      *-----------------------------------------
       SPECIAL-NAMES.
           DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      ******************************************************************
      *           D A T A                       D I V I S I O N        *
      ******************************************************************
       WORKING-STORAGE SECTION.
      *
       01  FILLER                          PIC X(40) VALUE
           'INICIO WORKING-STORAGE AMI73060         '.
      *
      ******************************************************************
      *                                                                *
      *       COPYS DE LLAMADAS A RUTINAS A NIVEL 05                   *
      *                                                                *
      ******************************************************************
      *
       01 NIVEL-01-AMR00100.
       COPY AMCL0100.

       01 NIVEL-01-CMR00300.
       COPY CMCL0300.
      *
      ******************************************************************
      *       WORK AREA                                                *
      ******************************************************************
       COPY AMCB7000.
       COPY AMCB7002.
       COPY AMCB7006.
       COPY AMCB7008.
       COPY AMCB7010.

      *C123517 2021jun21
       COPY CLCL0001.
 ALT04 COPY GMCL0013.
      ******************************************************************
      *           DECLARACOES DE DB2                                   *
      ******************************************************************
      * C82065(I)
      * ALT02 (I)
      *    EXEC SQL INCLUDE AMCD0109 END-EXEC.
      *    EXEC SQL INCLUDE AMCD0110 END-EXEC.
      *    EXEC SQL INCLUDE AMCD0113 END-EXEC.
      * ALT02 (F)
      *C138491
           EXEC SQL INCLUDE AMCD0115 END-EXEC.
      * C82065(F)
      *
           EXEC SQL INCLUDE AMCD0102 END-EXEC.
      *
           EXEC SQL INCLUDE AMCD0800 END-EXEC.
      *
           EXEC SQL INCLUDE AMCD1004 END-EXEC.
      *
           EXEC SQL INCLUDE AMCD2000 END-EXEC.
      *
      * C82065(I)
      *    EXEC SQL INCLUDE AMCD3004 END-EXEC.
           EXEC SQL INCLUDE AMCD3008 END-EXEC.
      * C82065(F)
      *
      *    EXEC SQL INCLUDE AMCD3401 END-EXEC.
           EXEC SQL INCLUDE AMCD3403 END-EXEC.
      *
           EXEC SQL INCLUDE AMCD3600 END-EXEC.
      *
           EXEC SQL INCLUDE AMCD6300 END-EXEC.
      *
           EXEC SQL INCLUDE TACD0200 END-EXEC.
      *
           EXEC SQL INCLUDE DCCD1202 END-EXEC.
      *
           EXEC SQL INCLUDE DCCD1500 END-EXEC.
      *
           EXEC SQL INCLUDE CMCD0300 END-EXEC.
      *
           EXEC SQL INCLUDE CMCD0502 END-EXEC.
      *
           EXEC SQL INCLUDE CMCD1300 END-EXEC.
      *
           EXEC SQL INCLUDE CMCD1400 END-EXEC.
      *
           EXEC SQL INCLUDE CMCD1500 END-EXEC.
      *
           EXEC SQL INCLUDE CMCD1600 END-EXEC.
      *
           EXEC SQL INCLUDE CMCD3000 END-EXEC.
      *ALT02(I)
      *    EXEC SQL INCLUDE GMCD0900 END-EXEC.
           EXEC SQL INCLUDE GMCD1000 END-EXEC.
           EXEC SQL INCLUDE GMCD1100 END-EXEC.
      *    EXEC SQL INCLUDE CLCD0500 END-EXEC.
           EXEC SQL INCLUDE CLCD0104 END-EXEC.
           EXEC SQL INCLUDE CLCD0703 END-EXEC.
      *ALT02(F)
      *
           EXEC SQL INCLUDE CLCD0803 END-EXEC.
      *
           EXEC SQL INCLUDE DCCD0100 END-EXEC.
      *
           EXEC SQL INCLUDE ATCW0006 END-EXEC.
      *
           EXEC SQL INCLUDE AMCLTB47 END-EXEC.
      *
      ******************************************************************
      *           MENSAGEM DE INPUT E  OUTPUT                          *
      ******************************************************************
           EXEC SQL INCLUDE AMCV7300 END-EXEC.
      *
           EXEC SQL INCLUDE AMCV7301 END-EXEC.
      *
      *
       COPY OPCV0900.
       COPY OPCV0901.
      *
       COPY OPCV1300.
       COPY OPCV1301.
      ******************************************************************
      *            CONSTANTES COM CODIGOS DE ERRO                      *
      ******************************************************************
       COPY ATCK0001.
      *
       COPY ATCK0002.
      *
       COPY ATCK0004.
      *
       COPY AMCK0001.
      *
       COPY AMCK0004.
      * C82065(I)
       COPY AMCK0002.
      * C82065(F)
      *
       COPY AMCWCL00.
      *
       COPY AMCWDC00.
      *
       COPY AMCWDC01.
      *
       COPY AMCX1000.
      *
           EXEC SQL INCLUDE AMCW0004 END-EXEC.
      *
       COPY AMCW1000.
      *
       COPY ATCW3000.
      *
       COPY DPCK0001.
      *
       COPY ATCL0006.
      *
       COPY SYCL0200.
       COPY CLCLCT08.
      * C82065 (I)
       COPY CICW0011.
      * C82065 (F)
207004******************************************************************
207004*AREA DE COMUNICAÇAO ROTINA AMR00016
207004******************************************************************
207004
207004 COPY AMCL0016.
207004*
      ******************************************************************
      *       WORK AREA ROTINA AMR01062                                *
      ******************************************************************
       01  NIVEL-01-AMR06000.
           COPY AMCL6000.
      *
       01  NIVEL-01-AMR06002.
           COPY AMCL6002.
      *
       01  NIVEL-01-AMR06006.
           COPY AMCL6006.
      *
       01  NIVEL-01-AMR06008.
           COPY AMCL6008.
      *
       01  NIVEL-01-AMR06010.
           COPY AMCL6010.
      *
       01  NIVEL-01-AMR01062.
           COPY AMCL1062.
      *
       01 NIVEL-01-AMR01014.
          COPY AMCL1014.
      *
       01  NIVEL-01-AMR01500.
           COPY AMCL1500.
      *
      ******************************************************************
      *           AREAS DE TRABALHO                                    *
      ******************************************************************
       COPY ATCW0009.
      *
       COPY ATCW0005.
           88 AMVT0115-NOTFND                   VALUE +100.
           88 AMVT0115-OK                       VALUE +0.
           88 AMVT0102-NOTFND                   VALUE +100.
           88 AMVT0102-OK                       VALUE +0.
           88 AMVT0800-NOTFND                   VALUE +100.
           88 AMVT0800-OK                       VALUE +0.
           88 AMVT2000-NOTFND                   VALUE +100.
           88 AMVT2000-OK                       VALUE +0.
           88 AMVT3008-NOTFND                   VALUE +100.
           88 AMVT3008-OK                       VALUE +0.
           88 AMVT3403-NOTFND                   VALUE +100.
           88 AMVT3403-OK                       VALUE +0.
           88 AMVT3600-NOTFND                   VALUE +100.
           88 AMVT3600-OK                       VALUE +0.
           88 AMVT6300-NOTFND                   VALUE +100.
           88 AMVT6300-OK                       VALUE +0.
           88 TAVT0200-NOTFND                   VALUE +100.
           88 TAVT0200-OK                       VALUE +0.
           88 DCVT1202-NOTFND                   VALUE +100.
           88 DCVT1202-OK                       VALUE +0.
           88 DCVT1500-NOTFND                   VALUE +100.
           88 DCVT1500-OK                       VALUE +0.
           88 CLVT0803-NOTFND                   VALUE +100.
           88 CLVT0803-OK                       VALUE +0.
           88 CAVT0900-NOTFND                   VALUE +100.
           88 CAVT0900-OK                       VALUE +0.
           88 CMVT0300-NOTFND                   VALUE +100.
           88 CMVT0300-OK                       VALUE +0.
           88 CMVT0502-NOTFND                   VALUE +100.
           88 CMVT0502-OK                       VALUE +0.
           88 CMVT1201-NOTFND                   VALUE +100.
           88 CMVT1201-OK                       VALUE +0.
           88 CMVT1300-NOTFND                   VALUE +100.
           88 CMVT1300-OK                       VALUE +0.
           88 CMVT1400-NOTFND                   VALUE +100.
           88 CMVT1400-OK                       VALUE +0.
           88 CMVT1500-NOTFND                   VALUE +100.
           88 CMVT1500-OK                       VALUE +0.
           88 CMVT1600-NOTFND                   VALUE +100.
           88 CMVT1600-OK                       VALUE +0.
           88 CMVT2401-NOTFND                   VALUE +100.
           88 CMVT2401-OK                       VALUE +0.
           88 CMVT3000-NOTFND                   VALUE +100.
           88 CMVT3000-OK                       VALUE +0.
           88 CMVT3100-NOTFND                   VALUE +100.
           88 CMVT3100-OK                       VALUE +0.
           88 GMVT1100-NOTFND                   VALUE +100.
           88 GMVT1100-OK                       VALUE +0.
           88 CLVT0100-NOTFND                   VALUE +100.
           88 CLVT0100-OK                       VALUE +0.
           88 SYVT1200-NOTFND                   VALUE +100.
           88 SYVT1200-OK                       VALUE +0.
           88 DCVT0100-NOTFND                   VALUE +100.
           88 DCVT0100-OK                       VALUE +0.
      ******************************************************************
      *           AREA DE JOURNAL                                      *
      ******************************************************************
        COPY SYCW0001.
      *
      ******************************************************************
      *           COMMAREA PARA JOURNAL                                *
      ******************************************************************
       COPY ATCL0003.
       COPY ATCL0002.
       COPY DPCW0010.
       COPY CLCW0078.
       COPY CMCW0100.
       COPY CMCX0100.
      *
      ******************************************************************
      *           CONSTANTES                                           *
      ******************************************************************
       01  CON-CONSTANTES.
           05 WS-CON-N0                    PIC 9(01) VALUE 0.
           05 WS-CON-N1                    PIC 9(01) VALUE 1.
           05 WS-CON-N2                    PIC 9(01) VALUE 2.
           05 WS-CON-N3                    PIC 9(01) VALUE 3.
           05 WS-CON-N5                    PIC 9(01) VALUE 5.
           05 WS-CON-N6                    PIC 9(01) VALUE 6.
           05 WS-CON-N8                    PIC 9(01) VALUE 8.
           05 WS-CON-N10                   PIC 9(02) VALUE 10.
           05 WS-CON-N14                   PIC 9(02) VALUE 14.
           05 WS-CON-N20                   PIC 9(02) VALUE 20.
           05 WS-CON-N21                   PIC 9(02) VALUE 21.
           05 WS-CON-N24                   PIC 9(02) VALUE 24.
           05 WS-CON-N25                   PIC 9(02) VALUE 25.
           05 WS-CON-N34                   PIC 9(02) VALUE 34.
           05 WS-CON-N35                   PIC 9(02) VALUE 35.
           05 WS-CON-N40                   PIC 9(02) VALUE 40.
           05 WS-CON-N54                   PIC 9(02) VALUE 54.
           05 WS-CON-N55                   PIC 9(02) VALUE 55.
           05 WS-CON-N65                   PIC 9(02) VALUE 65.
           05 WS-CON-N70                   PIC 9(02) VALUE 70.
           05 WS-CON-N100                  PIC 9(03) VALUE 100.
           05 WS-CON-N125                  PIC 9(03) VALUE 125.
           05 WS-CON-N350                  PIC 9(03) VALUE 350.
           05 WS-CON-N600                  PIC 9(03) VALUE 600.
           05 WS-CON-N999                  PIC 9(03) VALUE 999.
           05 WS-CON-N2500                 PIC 9(07) VALUE 2500 .
           05 WS-CON-N4000                 PIC 9(07) VALUE 4000 .
           05 WS-CON-N5000                 PIC 9(07) VALUE 5000 .
           05 WS-CON-N6000                 PIC 9(07) VALUE 6000 .
           05 WS-CON-N7000                 PIC 9(07) VALUE 7000 .
           05 WS-CON-N7500                 PIC 9(07) VALUE 7500 .
           05 WS-CON-N10000                PIC 9(07) VALUE 10000.
           05 WS-CON-N15000                PIC 9(07) VALUE 15000.

           05 WS-CON-0                     PIC X(01) VALUE '0'.
           05 WS-CON-1                     PIC X(01) VALUE '1'.
           05 WS-CON-2                     PIC X(01) VALUE '2'.
           05 WS-CON-3                     PIC X(01) VALUE '3'.
           05 WS-CON-4                     PIC X(01) VALUE '4'.
           05 WS-CON-5                     PIC X(01) VALUE '5'.
           05 WS-CON-9                     PIC X(01) VALUE '9'.
           05 WS-CON-A                     PIC X(01) VALUE 'A'.
           05 WS-CON-B                     PIC X(01) VALUE 'B'.
           05 WS-CON-C                     PIC X(01) VALUE 'C'.
           05 WS-CON-N                     PIC X(01) VALUE 'N'.
           05 WS-CON-S                     PIC X(01) VALUE 'S'.
           05 WS-CON-F                     PIC X(01) VALUE 'F'.
           05 WS-CON-H                     PIC X(01) VALUE 'H'.
           05 WS-CON-I                     PIC X(01) VALUE 'I'.
           05 WS-CON-L                     PIC X(01) VALUE 'L'.
           05 WS-CON-P                     PIC X(01) VALUE 'P'.
           05 WS-CON-Q                     PIC X(01) VALUE 'Q'.
           05 WS-CON-E                     PIC X(01) VALUE 'E'.
207004     05 WS-CON-V                     PIC X(01) VALUE 'V'.
           05 WS-CON-00                    PIC X(02) VALUE '00'.
           05 WS-CON-01                    PIC X(02) VALUE '01'.
           05 WS-CON-02                    PIC X(02) VALUE '02'.
           05 WS-CON-03                    PIC X(02) VALUE '03'.
           05 WS-CON-08                    PIC X(02) VALUE '08'.
           05 WS-CON-09                    PIC X(02) VALUE '09'.
           05 WS-CON-13                    PIC X(02) VALUE '13'.
           05 WS-CON-19                    PIC X(02) VALUE '19'.
           05 WS-CON-20                    PIC X(02) VALUE '20'.
           05 WS-CON-21                    PIC X(02) VALUE '21'.
           05 WS-CON-23                    PIC X(02) VALUE '23'.
           05 WS-CON-51                    PIC X(02) VALUE '51'.
           05 WS-CON-53                    PIC X(02) VALUE '53'.
           05 WS-CON-54                    PIC X(02) VALUE '54'.
           05 WS-CON-56                    PIC X(02) VALUE '56'.
           05 WS-CON-60                    PIC X(02) VALUE '60'.
           05 WS-CON-70                    PIC X(02) VALUE '70'.
           05 WS-CON-71                    PIC X(02) VALUE '71'.
           05 WS-CON-72                    PIC X(02) VALUE '72'.
           05 WS-CON-73                    PIC X(02) VALUE '73'.
           05 WS-CON-74                    PIC X(02) VALUE '74'.
           05 WS-CON-80                    PIC X(02) VALUE '80'.
           05 WS-CON-81                    PIC X(02) VALUE '81'.
           05 WS-CON-83                    PIC X(02) VALUE '83'.
           05 WS-CON-84                    PIC X(02) VALUE '84'.
           05 WS-CON-89                    PIC X(02) VALUE '89'.
           05 WS-CON-91                    PIC X(02) VALUE '91'.
           05 WS-CON-93                    PIC X(02) VALUE '93'.
           05 WS-CON-96                    PIC X(02) VALUE '96'.
           05 WS-CON-99                    PIC X(02) VALUE '99'.
           05 WS-CON-A1                    PIC X(02) VALUE 'A1'.
           05 WS-CON-A3                    PIC X(02) VALUE 'A3'.
           05 WS-CON-A4                    PIC X(02) VALUE 'A4'.
           05 WS-CON-A9                    PIC X(02) VALUE 'A9'.
           05 WS-CON-A0                    PIC X(02) VALUE 'A0'.
           05 WS-CON-A6                    PIC X(02) VALUE 'A6'.
           05 WS-CON-AM                    PIC X(02) VALUE 'AM'.
           05 WS-CON-AU                    PIC X(02) VALUE 'AU'.
           05 WS-CON-OP                    PIC X(02) VALUE 'OP'.
           05 WS-CON-PA                    PIC X(02) VALUE 'PA'.
           05 WS-CON-000                   PIC X(03) VALUE '000'.
           05 WS-CON-A01                   PIC X(03) VALUE 'A01'.
           05 WS-CON-M01                   PIC X(03) VALUE 'M01'.
           05 WS-CON-M03                   PIC X(03) VALUE 'M03'.
           05 WS-CON-M06                   PIC X(03) VALUE 'M06'.
           05 WS-CON-M12                   PIC X(03) VALUE 'M12'.
           05 WS-CON-U00                   PIC X(03) VALUE 'U00'.
           05 WS-CON-013                   PIC X(03) VALUE '013'.
           05 WS-CON-777                   PIC X(03) VALUE '777'.
      *C119891
           05 WS-CON-510                   PIC X(03) VALUE '510'.
           05 ZCLIENTE-AM-815837           PIC 9(10) VALUE 815837.
           05 WS-CON-999                   PIC X(03) VALUE '999'.
           05 WS-CON-BM45                  PIC X(04) VALUE 'BM45'.
           05 WS-CON-EAK                   PIC X(03) VALUE 'EAK'.
           05 WS-CON-NPROGRAM              PIC X(08) VALUE 'AMI73060'.
           05 WS-CON-AMVT0115              PIC X(08) VALUE 'AMVT0115'.
           05 WS-CON-AMVT0102              PIC X(08) VALUE 'AMVT0102'.
           05 WS-CON-AMVT0800              PIC X(08) VALUE 'AMVT0800'.
           05 WS-CON-AMVT1004              PIC X(08) VALUE 'AMVT1004'.
           05 WS-CON-AMVT2000              PIC X(08) VALUE 'AMVT2000'.
           05 WS-CON-AMVT3008              PIC X(08) VALUE 'AMVT3008'.
           05 WS-CON-AMVT3403              PIC X(08) VALUE 'AMVT3403'.
           05 WS-CON-AMVT3600              PIC X(08) VALUE 'AMVT3600'.
           05 WS-CON-AMVT6300              PIC X(08) VALUE 'AMVT6300'.
           05 WS-CON-DCVT1202              PIC X(08) VALUE 'DCVT1202'.
           05 WS-CON-DCVT1500              PIC X(08) VALUE 'DCVT1500'.
           05 WS-CON-CLVT0803              PIC X(08) VALUE 'CLVT0803'.
           05 WS-CON-CMVT0300              PIC X(08) VALUE 'CMVT0300'.
           05 WS-CON-CMVT0502              PIC X(08) VALUE 'CMVT0502'.
           05 WS-CON-CMVT1300              PIC X(08) VALUE 'CMVT1300'.
           05 WS-CON-CMVT1400              PIC X(08) VALUE 'CMVT1400'.
           05 WS-CON-CMVT1500              PIC X(08) VALUE 'CMVT1500'.
           05 WS-CON-CMVT1600              PIC X(08) VALUE 'CMVT1600'.
           05 WS-CON-CMVT3000              PIC X(08) VALUE 'CMVT3000'.
           05 WS-CON-GMVT1100              PIC X(08) VALUE 'GMVT1100'.
           05 WS-CON-AMI73060              PIC X(08) VALUE 'AMI73060'.
           05 WS-CON-OPI09090              PIC X(08) VALUE 'OPI09090'.
           05 WS-CON-OPI13060              PIC X(08) VALUE 'OPI13060'.
207004     05 WS-CON-AMR00016              PIC X(08) VALUE 'AMR00016'.
 ALT04     05 WS-CON-ROT-GMR00013          PIC X(08) VALUE 'GMR00013'.
           05 WS-CON-00010101              PIC X(08) VALUE '00010101'.
           05 WS-CON-99991231              PIC X(08) VALUE '99991231'.
           05 WS-CON-0001-01-01            PIC X(10) VALUE '0001-01-01'.
           05 WS-CON-9999-12-31            PIC X(10) VALUE '9999-12-31'.
          05 WS-CON-ROT-CLCLCT08           PIC X(08) VALUE 'CLRCLT08'.
           05 WS-CON-QUESTIONARIO          PIC X(50) VALUE
             'NECESSÁRIO PREENCHIMENTO DE QUESTIONÁRIO CLÍNICO  '.
           05 WS-CON-INSPECCAO             PIC X(50) VALUE
             'INSPECÇÃO MÉDICA PRESENCIAL OBRIGATÓRIA           '.
           05 WS-GAVISO-1.
              10 FILLER                    PIC X(32)
                  VALUE 'FOI ATRIBUIDO O N. DE INSCRICAO '.
              10 WS-GAVISO-1-ZINSCRIC      PIC 9(3) VALUE ZEROS.
              10 FILLER                    PIC X(17)
                  VALUE ' E O N. DE CONTA '.
              10 WS-GAVISO-1-CBALCAO       PIC X(3) VALUE SPACES.
              10 FILLER                    PIC X(1)
                  VALUE '.'.
              10 WS-GAVISO-1-CPRODUTO      PIC X(2) VALUE SPACES.
              10 FILLER                    PIC X(1)
                  VALUE '.'.
              10 WS-GAVISO-1-CNUMECTA      PIC X(6) VALUE SPACES.
              10 FILLER                    PIC X(1)
                  VALUE '-'.
              10 WS-GAVISO-1-CDIGICTA      PIC X(1) VALUE SPACES.

           05 WS-CON-DCONTD              PIC X(08) VALUE 'DCONTD  '.
           05 WS-CON-MMOVIM              PIC X(08) VALUE 'MMOVIM  '.
           05 WS-CON-MCAPITAL            PIC X(08) VALUE 'MCAPITAL'.
           05 WS-CON-MCAPACTU            PIC X(08) VALUE 'MCAPACTU'.
           05 WS-CON-MQUOTAIN            PIC X(08) VALUE 'MQUOTAIN'.
           05 WS-CON-MQUOTAAC            PIC X(08) VALUE 'MQUOTAAC'.
           05 WS-CON-QAGRAVID            PIC X(08) VALUE 'QAGRAVID'.
           05 WS-CON-QPRAZO              PIC X(08) VALUE 'QPRAZO  '.
           05 WS-CON-CLIBERAC            PIC X(08) VALUE 'CLIBERAC'.
           05 WS-CON-CSITSUB             PIC X(08) VALUE 'CSITSUB '.
           05 WS-CON-IDADECRO            PIC X(08) VALUE 'IDADECRO'.
           05 WS-CON-DNASCIM             PIC X(08) VALUE 'DNASCIM '.
           05 WS-CON-DNASCIMB            PIC X(08) VALUE 'DNASCIMB'.
           05 WS-CON-IDADEACT            PIC X(08) VALUE 'IDADEACT'.
           05 WS-CON-IDADAIBP            PIC X(08) VALUE 'IDADAIBP'.
           05 WS-CON-CODPER              PIC X(08) VALUE 'CODPER  '.
           05 WS-CON-DCALCDEC            PIC X(08) VALUE 'DCALCDEC'.
           05 WS-CON-DULTLIB             PIC X(08) VALUE 'DULTLIB '.
           05 WS-CON-DFIMCOBQ            PIC X(08) VALUE 'DFIMCOBQ'.
           05 WS-CON-DTVENCIM            PIC X(08) VALUE 'DTVENCIM'.
           05 WS-CON-CISENCAO            PIC X(08) VALUE 'CISENCAO'.
           05 WS-CON-DFIMISEN            PIC X(08) VALUE 'DFIMISEN'.
           05 WS-CON-MQTSUPL             PIC X(08) VALUE 'MQTSUPL '.
           05 WS-CON-QPRESTQS            PIC X(08) VALUE 'QPRESTQS'.
           05 WS-CON-PERCAGQT            PIC X(08) VALUE 'PERCAGQT'.
           05 WS-CON-CNUMVIDA            PIC X(08) VALUE 'CNUMVIDA'.
           05 WS-CON-CPRFGPE1            PIC X(08) VALUE 'CPRFGPE1'.
           05 WS-CON-CPRFGPE2            PIC X(08) VALUE 'CPRFGPE2'.
           05 WS-CON-CRISCO1             PIC X(08) VALUE 'CRISCO1 '.
           05 WS-CON-CRISCO2             PIC X(08) VALUE 'CRISCO2 '.
           05 WS-CON-PRESPGPE            PIC X(08) VALUE 'PRESPGPE'.
           05 WS-CON-ZEMPREST            PIC X(08) VALUE 'ZEMPREST'.
           05 WS-CON-ZEMPOIC             PIC X(08) VALUE 'ZEMPOIC '.
           05 WS-CON-CBANCO              PIC X(08) VALUE 'CBANCO  '.
           05 WS-CON-IAVISOIC            PIC X(08) VALUE 'IAVISOIC'.
           05 WS-CON-QPRZEMP             PIC X(08) VALUE 'QPRZEMP '.
           05 WS-CON-QPRZSEG             PIC X(08) VALUE 'QPRZSEG '.
           05 WS-CON-DINIEMPR            PIC X(08) VALUE 'DINIEMPR'.
           05 WS-CON-CEMPREST            PIC X(08) VALUE 'CEMPREST'.
           05 WS-CON-TXJURO              PIC X(08) VALUE 'TXJURO  '.
           05 WS-CON-PCOBDIV             PIC X(08) VALUE 'PCOBDIV '.
           05 WS-CON-CLISBOR             PIC X(08) VALUE 'CLISBOR '.
           05 WS-CON-PINVIDA2            PIC X(08) VALUE 'PINVIDA2'.
           05 WS-CON-QAGRAV2V            PIC X(08) VALUE 'QAGRAV2V'.
           05 WS-CON-ZDIAGNO2            PIC X(08) VALUE 'ZDIAGNO2'.
           05 WS-CON-CTIPSOC2            PIC X(08) VALUE 'CTIPSOC2'.
           05 WS-CON-ZSOCIO2             PIC X(08) VALUE 'ZSOCIO2 '.
           05 WS-CON-CDIGISO2            PIC X(08) VALUE 'CDIGISO2'.
           05 WS-CON-AMT01        PIC X(18) VALUE 'AMVT0115_BASIOPER '.
           05 WS-CON-AMT30        PIC X(18) VALUE 'AMVT3008_HISTOPER '.
           05 WS-CON-TRANS               PIC X(04) VALUE 'AM73'.
           05 WS-CON-AM76                PIC X(04) VALUE 'AM76'.
           05 WS-CON-CA                  PIC X(02) VALUE 'CA'.
           05 WS-CELEMTAB-COMPLETO       PIC X(10) VALUE SPACES.
           05 WS-NELEMC01                PIC X(10) VALUE SPACES.
           05 WS-CPLSUBS                 PIC X(02) VALUE SPACES.
           05 WS-CURRENTDATE             PIC X(10) VALUE SPACES.
           05 WS-CON-AM2                 PIC X(03) VALUE 'AM2'.
           05 WS-CON-TAVT0200            PIC X(08) VALUE 'TAVT0200'.
           05 WS-CON-AMR07000            PIC X(08) VALUE 'AMR07000'.
           05 WS-CON-AMR07002            PIC X(08) VALUE 'AMR07002'.
           05 WS-CON-AMR07006            PIC X(08) VALUE 'AMR07006'.
           05 WS-CON-AMR07008            PIC X(08) VALUE 'AMR07008'.
           05 WS-CON-AMR07010            PIC X(08) VALUE 'AMR07010'.
           05 ABEND-CALLER-ID            PIC X(30) VALUE SPACES.
           05 MSG-SELECT                 PIC X(20) VALUE
                                             'ERRO LEITURA TABELA '.
           05 WS-SQLCODE                 PIC  ----9  VALUE ZEROES.

      *    PDI C194062 - INICIO
           05 WS-CON-AM-SERV-GEST-ADMIN    PIC X(03) VALUE '777'.
           05 WS-CON-BALCAO-AM             PIC X(03) VALUE '510'.
           05 WS-CON-CPERFIL-DINAM-MGAM    PIC X(06) VALUE 'AMDINA'.
      *    PDI C194062 - FIM

      *
       01 CON-CLI-FINIBANCO                PIC X(03) VALUE 'FB '.
       01 WS-CONTA-AUX.
          05 WS-CBALCAO-AUX                PIC X(03).
          05 WS-CPRODUTO-AUX               PIC X(02).
          05 WS-CNUMECTA-AUX               PIC X(06).
          05 WS-CDIGICTA-AUX               PIC X(01).
      *
       01  WS-DATA-10.
           10  WS-DATA-ANO                 PIC  9(04).
           10  FILLER                      PIC  X(01) VALUE '-'.
           10  WS-DATA-MES                 PIC  9(02).
           10  FILLER                      PIC  X(01) VALUE '-'.
           10  WS-DATA-DIA                 PIC  9(02).
      *
       01  WS-DATA-08.
           10  WS-DATA-ANO                 PIC  9(04).
           10  WS-DATA-MES                 PIC  9(02).
           10  WS-DATA-DIA                 PIC  9(02).
       01  SW-DEBUG                        PIC  X(2).
           88 SW-DEBUG-SIM                         VALUE 'SS' 'SN' 'NS'.
           88 SW-DEBUG-NAO                         VALUE 'NN'.
      *
      ******************************************************************
      *                  FLAGS E SWITCHES                              *
      ******************************************************************
       01  WS-PRODSPROD                     PIC X(04) VALUE SPACES.
              88 CAP-PREV       VALUE '7181'.
              88 MOD-V1         VALUE '7181'.
              88 MOD-V2         VALUE '7491'.
              88 MOD-7491       VALUE '7491'.

       01 WS-AVISO                          PIC X(01) VALUE SPACES.
              88 CONTROLA-AVISO                      VALUE '1'.
       01 WS-TIPO-AVISO                     PIC X(01) VALUE SPACES.
              88 INSPECAO-MEDICA                     VALUE '1'.

       01  SWITCH-EXISTE-REGISTO         PIC X(01)    VALUE 'N'.
           88 SW-NAO-EXISTE-REGISTO                   VALUE 'N'.
           88 SW-EXISTE-REGISTO                       VALUE 'S'.
      *
       01  SWITCH-ALTERA-CATIVO          PIC X(01) VALUE 'N'.
           88 SW-ALTERA-CATIVO-SIM                 VALUE 'S'.
      *
      ******************************************************************
      *           VARIAVEIS                                            *
      ******************************************************************
       01  WS-VARIAVEIS.
           05 WS-CTEXAMED-MAE              PIC  X(1) VALUE SPACES.
           05 WS-CTEXAMED-CTI              PIC  X(1) VALUE SPACES.
           05 WS-CTEXAMED-CS               PIC  X(1) VALUE SPACES.

           05 WS-MVALOR-MIN         PIC  9(07) COMP-3 VALUE ZEROS.
           05 WS-IIMOBRIG-MAE       PIC  X(01)             VALUE SPACES.
           05 WS-IIMOBRIG-CTI       PIC  X(01)             VALUE SPACES.
           05 WS-IIMOBRIG-CS        PIC  X(01)             VALUE SPACES.
           05 WS-ICNTSEG-MAE        PIC  X(01)             VALUE SPACES.
           05 WS-MIN-DCONTD         PIC  X(10)             VALUE SPACES.
           05 WS-MIN-DCONTD8        PIC  X(08)             VALUE SPACES.
           05 WS-CPLREM-MAE         PIC  X(04)             VALUE SPACES.
           05 WS-CPLREM-CTI         PIC  X(04)             VALUE SPACES.
           05 WS-CPLREM-CS          PIC  X(04)             VALUE SPACES.
           05 WS-CPERFRA-MAE        PIC  X(03)             VALUE SPACES.
           05 WS-CBALCAO            PIC  X(03)             VALUE SPACES.
           05 WS-CPRODUTO           PIC  X(02)             VALUE SPACES.
           05 WS-CNUMECTA           PIC  X(06)             VALUE SPACES.
           05 WS-CDIGICTA           PIC  X(01)             VALUE SPACES.
           05 WS-INDSUBMT-MAE       PIC  X(01)             VALUE SPACES.
           05 WS-INDSUBMT-CTI       PIC  X(01)             VALUE SPACES.
           05 WS-INDSUBMT-CS        PIC  X(01)             VALUE SPACES.
           05 WS-CNATJUR            PIC  X(06)             VALUE SPACES.
           05 WS-CSITCTA            PIC  X(01)             VALUE SPACES.
           05 WS-CTRATCTA           PIC  X(02)             VALUE SPACES.
           05 WS-CTRATCTA-SUB       PIC  X(02)             VALUE SPACES.
           05 WS-DDIAOP             PIC  X(10)             VALUE SPACES.
           05 WS-DATAOPER           PIC  X(10)             VALUE SPACES.
           05 WS-DFIMCOBQ-MAE       PIC  X(10)             VALUE SPACES.
           05 WS-DTVENCIM-MAE       PIC  X(10)             VALUE SPACES.
           05 WS-DFIMCOBQ-CTI       PIC  X(10)             VALUE SPACES.
           05 WS-DTVENCIM-CTI       PIC  X(10)             VALUE SPACES.
           05 WS-DFIMCOBQ-CS        PIC  X(10)             VALUE SPACES.
           05 WS-DTVENCIM-CS        PIC  X(10)             VALUE SPACES.

           05 WS-DIF-IDADES         PIC  9(03)             VALUE ZEROS.
           05 WS-QPRAZO-N           PIC  9(03)             VALUE ZEROS.
           05 WS-PRAZOMIN-MAE       PIC  9(03)             VALUE ZEROS.
           05 WS-PRAZOMAX-MAE       PIC  9(03)             VALUE ZEROS.
           05 WS-PRAZOMIN-CTI       PIC  9(03)             VALUE ZEROS.
           05 WS-PRAZOMAX-CTI       PIC  9(03)             VALUE ZEROS.
           05 WS-PRAZOMIN-CS        PIC  9(03)             VALUE ZEROS.
           05 WS-PRAZOMAX-CS        PIC  9(03)             VALUE ZEROS.
           05 WS-ZSEQUEN-1          PIC  9(10)             VALUE ZEROS.
           05 WS-ZSEQUEN-1B         PIC  9(06)             VALUE ZEROS.

           05 WS-NUMINSC            PIC S9(09)      COMP   VALUE ZEROS.
           05 COD-RETORNO           PIC S9(03)      COMP   VALUE ZEROS.
           05 WS-INDICADOR          PIC S9(04)      COMP   VALUE ZEROS.

           05 WS-QPRAZO-MAE         PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-QPRAZO-CTI         PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-QPRAZO-CS          PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-IDADRECB-MAE       PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-IDADRECB-CTI       PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-IDADRECB-CS        PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-IDADEACT-BEN       PIC S9(03)      COMP-3 VALUE ZEROS.
      *    05 WS-IDADEACT-REC-BEN   PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-IDADETET-REC-BEN   PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-IDADEACT-SOCIO     PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-IDADEACT-SOCIO-DIA PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-CONTADOR           PIC S9(03)      COMP-3 VALUE ZEROS.
           05 WS-IDADETET-SOCIO     PIC S9(03)V     COMP-3 VALUE ZEROS.
           05 WS-IDADETET-SOCIO-DIA PIC S9(03)V     COMP-3 VALUE ZEROS.
      * ALT02 (I)
           05 WS-IDADEACT-DTVENCIM  PIC S9(03)V     COMP-3 VALUE ZEROS.
      * ALT02 (F)
           05 WS-MAX-ZINSCRIC       PIC S9(03)V     COMP-3 VALUE ZEROS.
           05 WS-MVALORQT-MAE       PIC S9(10)V9(8) COMP-3 VALUE ZEROS.
           05 WS-MVALORQT-CTI       PIC S9(10)V9(8) COMP-3 VALUE ZEROS.
           05 WS-MVALORQT-CS        PIC S9(10)V9(8) COMP-3 VALUE ZEROS.
           05 WS-MVALORQT-TOTAL     PIC S9(10)V9(8) COMP-3 VALUE ZEROS.
           05 WS-MQUOTAIN           PIC S9(10)V9(8) COMP-3 VALUE ZEROS.
           05 WS-MCAPITAL           PIC S9(10)V9(8) COMP-3 VALUE ZEROS.
           05 WS-MCAPITAL-PREF      PIC S9(10)V9(8) COMP-3 VALUE ZEROS.
           05 WS-MULTIPLO-QUOTA     PIC S9(10)V9(8) COMP-3 VALUE ZEROS.
           05 WS-MQUOTAIN-AUX       PIC S9(10)V9(8) COMP-3 VALUE ZEROS.
           05 WS-VAR-AUX            PIC S9(13)V99   COMP-3 VALUE ZEROS.
           05 WS-MMULTSUB-MAE       PIC S9(13)V99   COMP-3 VALUE ZEROS.
           05 WS-MMULTSUB-CTI       PIC S9(13)V99   COMP-3 VALUE ZEROS.
           05 WS-MMULTSUB-CS        PIC S9(13)V99   COMP-3 VALUE ZEROS.
           05 WS-MULTSUBC-MAE       PIC S9(02)V     COMP-3 VALUE ZEROS.
           05 WS-MULTSUBC-CTI       PIC S9(02)V     COMP-3 VALUE ZEROS.
           05 WS-MULTSUBC-CS        PIC S9(02)V     COMP-3 VALUE ZEROS.
           05 WS-ZCLIEMP            PIC S9(10)      COMP-3 VALUE ZEROS.
           05 WS-MCAPITAL-INSP      PIC S9(13)V99   COMP-3 VALUE ZEROS.
           05 WS-VAR-AUX-2          PIC S9(13)V99   COMP-3 VALUE ZEROS.
           05 WS-TOTAL-MAE          PIC S9(11)V99   COMP-3 VALUE ZEROS.
           05 WS-TOTAL-COMP1        PIC S9(11)V99   COMP-3 VALUE ZEROS.
           05 WS-TOTAL-COMP2        PIC S9(11)V99   COMP-3 VALUE ZEROS.

           05 WS-COD-PRAZO.
              10 WS-TIP-PRAZO       PIC X(1)               VALUE 'N'.
              10 WS-NUM-PRAZO       PIC 9(2)               VALUE ZEROS.

           05 WS-DATA-AAAAMMDD.
              10  WS-DATA-AAAAMMDD-ANO  PIC  9(04)         VALUE ZEROS.
              10  WS-DATA-AAAAMMDD-MES  PIC  9(02)         VALUE ZEROS.
              10  WS-DATA-AAAAMMDD-DIA  PIC  9(02)         VALUE ZEROS.

           05 WS-DATA8-ACTU.
              10  WS-DATA8-ACTU-ANO PIC  9(04)             VALUE ZEROS.
              10  WS-DATA8-ACTU-MES PIC  9(02)             VALUE ZEROS.
              10  WS-DATA8-ACTU-DIA PIC  9(02)             VALUE ZEROS.

           05 WS-DATA8-18ANOS.
              10  WS-DATA8-18ANOS-ANO PIC 9(04)            VALUE ZEROS.
              10  WS-DATA8-18ANOS-MES PIC 9(02)            VALUE ZEROS.
              10  WS-DATA8-18ANOS-DIA PIC 9(02)            VALUE ZEROS.

           05 WS-DATA8-DTVENCIM.
              10  WS-DATA8-DTVENCIM-ANO PIC 9(04)          VALUE ZEROS.
              10  WS-DATA8-DTVENCIM-MES PIC 9(02)          VALUE ZEROS.
              10  WS-DATA8-DTVENCIM-DIA PIC 9(02)          VALUE ZEROS.

           05 WS-DATA8-RECB.
              10  WS-DATA8-RECB-ANO PIC  9(04)             VALUE ZEROS.
              10  WS-DATA8-RECB-MES PIC  9(02)             VALUE ZEROS.
              10  WS-DATA8-RECB-DIA PIC  9(02)             VALUE ZEROS.

           05 WS-DATA8-MAE.
              10  WS-DATA8-MAE-ANO  PIC  9(04)             VALUE ZEROS.
              10  WS-DATA8-MAE-MES  PIC  9(02)             VALUE ZEROS.
              10  WS-DATA8-MAE-DIA  PIC  9(02)             VALUE ZEROS.

           05 WS-DATA8-CTI.
              10  WS-DATA8-CTI-ANO  PIC  9(04)             VALUE ZEROS.
              10  WS-DATA8-CTI-MES  PIC  9(02)             VALUE ZEROS.
              10  WS-DATA8-CTI-DIA  PIC  9(02)             VALUE ZEROS.

           05 WS-DTLIMITE-CTI.
              10  WS-DTLIMITE-CTI-ANO PIC 9(04)            VALUE ZEROS.
              10  WS-DTLIMITE-CTI-MES PIC 9(02)            VALUE ZEROS.
              10  WS-DTLIMITE-CTI-DIA PIC 9(02)            VALUE ZEROS.

           05  WS-CSEQUEN.
               10  WS-CBAL          PIC  X(03)             VALUE SPACES.
               10  WS-CPROD         PIC  X(02)             VALUE SPACES.

           05 WS-NUMCTADO.
              10 WS-CPRODSAQ        PIC  X(02)             VALUE SPACES.
              10 WS-CCNTSAQ         PIC  X(06)             VALUE SPACES.
              10 WS-CDIGISAQ        PIC  X(01)             VALUE SPACES.

           05 WS-CONTA-AM-MAE.
              10 WS-CBALCAO-MAE     PIC  X(03)             VALUE SPACES.
              10 WS-CPRODUTO-MAE    PIC  X(02)             VALUE SPACES.
              10 WS-CNUMECTA-MAE    PIC  X(06)             VALUE SPACES.
              10 WS-CDIGICTA-MAE    PIC  X(01)             VALUE SPACES.

           05 WS-CBALSAQ-CAT-ANT    PIC  X(03)             VALUE SPACES.
           05 WS-CPRODSAQ-CAT-ANT   PIC  X(02)             VALUE SPACES.
           05 WS-CCNTSAQ-CAT-ANT    PIC  X(06)             VALUE SPACES.
           05 WS-CDIGISAQ-CAT-ANT   PIC  X(01)             VALUE SPACES.

      * C82065(I)
           05 WS-CPAISIBSQ-CAT-ANT  PIC X(4)               VALUE SPACES.
           05 WS-CBANIBSQ-CAT-ANT   PIC X(4)               VALUE SPACES.
           05 WS-CCTAIBSQ-CAT-ANT   PIC X(15)              VALUE SPACES.
           05 WS-CDIGIBSQ-CAT-ANT   PIC X(2)               VALUE SPACES.
      *
           05 WS-CIBANDEV.
              15 WS-CPAISIBSQ             PIC X(04)   VALUE SPACES.
              15 WS-CBANIBSQ              PIC X(04)   VALUE SPACES.
              15 WS-CCTAIBSQ              PIC X(15)   VALUE SPACES.
              15 WS-CDIGIBSQ              PIC X(02)   VALUE SPACES.
              15 WS-RESTOBSQ              PIC X(09)   VALUE SPACES.
           05 WS-CIBANBSB.
              15 WS-CPAISIBSB             PIC X(04)   VALUE SPACES.
              15 WS-CBANIBSB              PIC X(04)   VALUE SPACES.
              15 WS-CCTAIBSB              PIC X(15)   VALUE SPACES.
              15 WS-CDIGIBSB              PIC X(02)   VALUE SPACES.
              15 WS-RESTOBSB              PIC X(09)   VALUE SPACES.
      * C82065 (F)

           05 WS-CSUBPROD-MAE       PIC  X(02)             VALUE SPACES.
           05 WS-ZINSCRIC-MAE       PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-MCAPACTU-MAE       PIC S9(13)V9(2) COMP-3 VALUE ZEROS.
           05 WS-CPRODUTO-CTI       PIC  X(02)             VALUE SPACES.
           05 WS-CSUBPROD-CTI       PIC  X(02)             VALUE SPACES.
           05 WS-ZINSCRIC-CTI       PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-MCAPACTU-CTI       PIC S9(13)V9(2) COMP-3 VALUE ZEROS.

           05 WS-AMT01-CPRODUTO     PIC  X(02)             VALUE SPACES.
           05 WS-AMT01-CBALCAO      PIC  X(03)             VALUE SPACES.
           05 WS-AMT01-CNUMECTA     PIC  X(06)             VALUE SPACES.
           05 WS-AMT01-CDIGICTA     PIC  X(01)             VALUE SPACES.
           05 WS-AMT01-CTIPSOC      PIC  X(01)             VALUE SPACES.
           05 WS-AMT01-ZSOCIO       PIC S9(07)      COMP-3 VALUE ZEROS.
           05 WS-AMT01-CDIGISOC     PIC S9(01)      COMP-3 VALUE ZEROS.
           05 WS-AMT01-CESTADO      PIC  X(02)             VALUE SPACES.

           05 WS-AMT01-CSUBPROD     PIC  X(02)         VALUE SPACES.
           05 WS-AMT01-DCONTD       PIC  X(10)         VALUE SPACES.
           05 WS-AMT01-QPRAZO       PIC S9(03)V COMP-3 VALUE ZEROS.
           05 WS-AMT01-ZINSCRIC     PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-AMT01-CSITSUB      PIC  X(02)             VALUE SPACES.
           05 WS-AMT01-IDADECRO     PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-AMT01-DNASCIM      PIC  X(10)             VALUE SPACES.
           05 WS-AMT01-DNASCIMB     PIC  X(10)             VALUE SPACES.
           05 WS-AMT01-IDADEACT     PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-AMT01-IDADAIBP     PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-AMT01-CODPER       PIC  X(03)             VALUE SPACES.
           05 WS-AMT01-DCALCDEC     PIC  X(10)             VALUE SPACES.
           05 WS-AMT01-DULTLIB      PIC  X(10)             VALUE SPACES.
           05 WS-AMT01-DFIMCOBQ     PIC  X(10)             VALUE SPACES.
           05 WS-AMT01-DTVENCIM     PIC  X(10)             VALUE SPACES.
           05 WS-AMT01-CISENCAO     PIC  X(02)             VALUE SPACES.
           05 WS-AMT01-DFIMISEN     PIC  X(10)             VALUE SPACES.
           05 WS-AMT01-MQTSUPL      PIC S9(9)V9(2) COMP-3  VALUE ZEROS.
           05 WS-AMT01-QPRESTQS     PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-AMT01-PERCAGQT     PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-AMT01-QAGRAVID     PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-AMT01-MCAPITAL     PIC S9(13)V9(2) COMP-3 VALUE ZEROS.
           05 WS-AMT01-MCAPACTU     PIC S9(13)V9(2) COMP-3 VALUE ZEROS.
           05 WS-AMT01-MQUOTAIN     PIC S9(11)V9(2) COMP-3 VALUE ZEROS.
           05 WS-AMT01-MQUOTAAC     PIC S9(11)V9(2) COMP-3 VALUE ZEROS.

           05 WS-AMT01-CCOBADIC        PIC S9(1)V   COMP-3 VALUE ZEROS.
           05 WS-AMT01-CTRATCTA     PIC X(2).
           05 WS-AMT01-CBALSAQ      PIC X(3).
           05 WS-AMT01-CPRODSAQ     PIC X(2).
           05 WS-AMT01-CCNTSAQ      PIC X(6).
           05 WS-AMT01-CBALSUB      PIC X(3).
           05 WS-AMT01-CPRDSUB      PIC X(2).
           05 WS-AMT01-CCTASUB      PIC X(6).
           05 WS-AMT01-CDIGSUB      PIC X(1).
      * C82065(I)
           05 WS-AMT01-CPAISIBSQ    PIC X(4).
           05 WS-AMT01-CBANIBSQ     PIC X(4).
           05 WS-AMT01-CCTAIBSQ     PIC X(15).
           05 WS-AMT01-CDIGIBSQ     PIC X(2).
           05 WS-AMT01-CPAISIBSB    PIC X(4).
           05 WS-AMT01-CBANIBSB     PIC X(4).
           05 WS-AMT01-CCTAIBSB     PIC X(15).
           05 WS-AMT01-CDIGIBSB     PIC X(2).
      * C82065(I)
      *PDI-C138491
           05 WS-AMT01-CGESTMUT     PIC X(5).
      *C123517
           05 WS-AMT01-IPAGAEMP     PIC X(1).
           05 WS-AMT01-ZCLIEMP      PIC S9(10)V USAGE COMP-3.

           05 WS-AMVT0115-CCOBADIC     PIC S9(1)V   COMP-3 VALUE ZEROS.

           05 WS-AMVT0115-CTIPSOC      PIC  X(01).
           05 WS-AMVT0115-ZSOCIO       PIC S9(07)V     COMP-3.
           05 WS-AMVT0115-CDIGISOC     PIC S9(01)V     COMP-3.
           05 WS-AMVT0115-ZINSCRIC     PIC S9(03)V     COMP-3.
           05 WS-AMVT0115-CPRODUTO     PIC  X(02).
           05 WS-AMVT0115-CSUBPROD     PIC  X(02).
           05 WS-AMVT0115-MCAPITAL     PIC S9(13)V9(2) COMP-3.

           05 WS-AMT30-CPRODUTO     PIC  X(02).
           05 WS-AMT30-CBALCAO      PIC  X(03).
           05 WS-AMT30-CNUMECTA     PIC  X(06).
           05 WS-AMT30-CDIGICTA     PIC  X(01).
           05 WS-AMT30-ZMOVCTA      PIC S9(5)V COMP-3      VALUE ZEROS.
           05 WS-AMT30-DDIAOP       PIC  X(10)             VALUE SPACES.
           05 WS-AMT30-DDIAVL       PIC  X(10)             VALUE SPACES.
           05 WS-AMT30-DCONTD       PIC  X(10)             VALUE SPACES.
           05 WS-AMT30-MMOVIM       PIC S9(11)V9(2) COMP-3 VALUE ZEROS.
           05 WS-AMT30-GREFMOV      PIC  X(15).
           05 WS-AMT30-MCAPITAL     PIC S9(13)V9(2) COMP-3 VALUE ZEROS.
           05 WS-AMT30-MCAPACTU     PIC S9(13)V9(2) COMP-3 VALUE ZEROS.
           05 WS-AMT30-MQUOTAIN     PIC S9(11)V9(2) COMP-3 VALUE ZEROS.
           05 WS-AMT30-MQUOTAAC     PIC S9(11)V9(2) COMP-3 VALUE ZEROS.
           05 WS-AMT30-QAGRAVID     PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-AMT30-QPRAZO       PIC S9(3)V COMP-3      VALUE ZEROS.
           05 WS-AMT30-CLIBERAC     PIC  X(01)             VALUE SPACES.
           05 WS-AMT30-CBALSAQ           PIC X(3).
           05 WS-AMT30-CPRODSAQ          PIC X(2).
           05 WS-AMT30-CCNTSAQ           PIC X(6).
           05 WS-AMT30-CDIGISAQ          PIC X(1).
      * C82065(I)
           05 WS-AMT30-CPAISIBSQ    PIC X(4).
           05 WS-AMT30-CBANIBSQ     PIC X(4).
           05 WS-AMT30-CCTAIBSQ     PIC X(15).
           05 WS-AMT30-CDIGIBSQ     PIC X(2).
           05 WS-AMT30-CPAISIBSB    PIC X(4).
           05 WS-AMT30-CBANIBSB     PIC X(4).
           05 WS-AMT30-CCTAIBSB     PIC X(15).
           05 WS-AMT30-CDIGIBSB     PIC X(2).
      * C82065(F)

           05 WS-NUMERICO10              PIC 9(10).
           05 WS-NUMERICO10-EDIT         PIC ZZZZZZZZZ9.
           05 WS-NUMERICO13-2            PIC 9(13)V99.
           05 WS-NUMERICO13-2-EDIT       PIC ZZ.ZZZ.ZZZ.ZZ9,99.

           05 WS-CSUBPROD-1         PIC  X(02)             VALUE SPACES.
           05 WS-CSUBPROD-2         PIC  X(02)             VALUE SPACES.
      *
      *C123517 - 2021JUN21
           05 WS-CTIPCLI-ZCLIEMP           PIC X(1)    VALUE SPACES.
      *
      ******************************************************************
      *              DECLARACOES DE CURSORES DB2                       *
      ******************************************************************
           EXEC SQL
               DECLARE CRS-AMT01-1 CURSOR FOR
                  SELECT CPRODUTO,
                         CBALCAO,
                         CNUMECTA,
                         CDIGICTA
                    FROM AMVT0115_BASIOPER
                   WHERE CTIPSOC  = :AMVT0115-CTIPSOC
                     AND ZSOCIO   = :AMVT0115-ZSOCIO
                     AND CDIGISOC = :AMVT0115-CDIGISOC
                     AND CPRODUTO = :AMVT0115-CPRODUTO
                     AND CSUBPROD = :AMVT0115-CSUBPROD
           END-EXEC.
      *
           EXEC SQL
                DECLARE CRS-CMT05 CURSOR FOR
                SELECT MCAPMAX ,
                       CTEXAMED
                  FROM CMVT0502_INSPMED
                 WHERE CPRODUTO  = :CMVT0502-CPRODUTO
                   AND CSUBPROD  = :CMVT0502-CSUBPROD
                   AND CMOEDA    = :CMVT0502-CMOEDA
                   AND IDADEMAX >= :CMVT0502-IDADEMAX
                   AND CPLSUBS   = :CMVT0502-CPLSUBS
                   AND TXPROG    = :CMVT0502-TXPROG
                   AND DINICIO  <= :CMVT0502-DINICIO
                   AND DFIM     >= :CMVT0502-DFIM
                   AND MCAPMAX  >= :CMVT0502-MCAPMAX
                   AND MCAPMIN  <= :CMVT0502-MCAPMIN
                   AND IDADEMIN <= :CMVT0502-IDADEMIN
                   AND CRISCO    = :CMVT0502-CRISCO
                   AND CLIBERAC  = :CMVT0502-CLIBERAC
               FOR FETCH ONLY
               OPTIMIZE FOR 1 ROW
           END-EXEC.

           EXEC SQL
               DECLARE CRS-AMT01-INSP CURSOR FOR
              SELECT  CPRODUTO,
                      CBALCAO ,
                      CNUMECTA,
                      CDIGICTA,
                      CSUBPROD,
                      ZINSCRIC,
                      ZORDPROC,
                      MCAPACTU
                FROM  AMVT0102_BASIOPER
               WHERE  CTIPSOC  =  :AMVT0102-CTIPSOC
                 AND  ZSOCIO   =  :AMVT0102-ZSOCIO
                 AND  CDIGISOC =  :AMVT0102-CDIGISOC
                 AND  ZINSCRIC <> :AMVT0102-CDIGISOC
                 AND ((CSUBPROD = '59'
                  OR  CSUBPROD = '89'
                  OR  CSUBPROD = 'A9'
                  OR  CSUBPROD = '62'
                  OR  CSUBPROD = '60'
                  OR  CSUBPROD = '80')

                  OR (CSUBPROD = '51'
                 AND  INDSBPRO = '1')

                  OR (CSUBPROD IN ('81', 'A1')
                 AND  INDSBPRO = '1')
                  OR (CSUBPROD = '56'
                 AND  INDSBPRO = '1')

                  OR (CSUBPROD IN ('96', 'A6')
                 AND  INDSBPRO = '1')
                  OR (CSUBPROD = '53'
                 AND  INDSBPRO = '1')

                  OR (CSUBPROD = '83'
                 AND  INDSBPRO = '1')
                  OR (CSUBPROD = '93'
                 AND  INDSBPRO = '1')
                  OR (CSUBPROD = 'A3'
                 AND  INDSBPRO = '1')

                  OR (CSUBPROD = '54'
                 AND  INDSBPRO = '1')
                  OR (CSUBPROD IN ('84', 'A4')
                 AND  INDSBPRO = '1'))
                 AND  CESTADO IN ('00', '01', '02')
               ORDER BY ZINSCRIC, ZORDPROC DESC
               FOR FETCH ONLY
           END-EXEC.
      *
       01  FILLER                         PIC X(40) VALUE
           'FIM DA WORKING-STORAGE AMI73060         '.
      *
      ******************************************************************
       LINKAGE SECTION.
      ******************************************************************
      *---- COMMAREA COMPLETA (ARQUITECTURA + APLICACAO AM)
       01  DFHCOMMAREA                    PIC X(4092).

       COPY ATCL0001 REPLACING ==ATCL0001-COMMAREA== BY
            ==ATCL0001-COMMAREA REDEFINES DFHCOMMAREA==.
      *
       PROCEDURE DIVISION.
      ******************************************************************
      *           P R O C E D U R E             D I V I S I O N        *
      ******************************************************************
      *
      ******************************************************************
       0000-MAINLINE.
      ******************************************************************

           PERFORM 1000-INICIO-PROGRAMA
              THRU 1999-INICIO-PROGRAMA-EXIT.

           IF SW-DEBUG-SIM
              DISPLAY 'AMI73060 - 0000-MAINLINE'
              DISPLAY ' ATCL0001-CACCAO      ' ATCL0001-CACCAO
              DISPLAY ' ATCL0001-PEDIDO-DADOS' ATCL0001-PEDIDO-DADOS
              DISPLAY ' ATCL0001-SIMULACAO   ' ATCL0001-SIMULACAO
           END-IF.


      *    PDI C194062 - INICIO
              IF ATCL0001-SEM-ERROS
      *    PDI C194062 - INICIO
                 PERFORM 2000-PROC-PROGRAMA
                    THRU 2999-PROC-PROGRAMA-EXIT
      *    PDI C194062 - INICIO
           END-IF.
      *    PDI C194062 - INICIO

           PERFORM 3000-FINAL-PROGRAMA
              THRU 3999-FINAL-PROGRAMA-EXIT.
      *
       0999-MAINLINE-EXIT.
           GOBACK.
      ******************************************************************
       1000-INICIO-PROGRAMA.
      ******************************************************************

           PERFORM 1010-VALIDA-DEBUG
              THRU 1010-VALIDA-DEBUG-EXIT.

           IF SW-DEBUG-SIM DISPLAY '1000-INICIO-PROGRAMA ' END-IF.

           MOVE ATCL0001-MSG               TO AMCV7300-MSG.
 mab       MOVE AMCV7300-ASE               TO AMCV7301-ASE.

      * C82065(I)
           IF AMCV7300-CPAISIBSQ EQUAL AMCK0002-CON-CPAIS-PT
           AND AMCV7300-CBANIBSQ EQUAL AMCK0002-CON-CBANCO-MG
              MOVE AMCV7300-CCTAIBSQ(2:3)   TO AMCV7300-CBALSAQ
              MOVE AMCV7300-CCTAIBSQ(7:2)   TO AMCV7300-CPRODSAQ
              MOVE AMCV7300-CCTAIBSQ(9:6)   TO AMCV7300-CCNTSAQ
              MOVE AMCV7300-CCTAIBSQ(15:1)  TO AMCV7300-CDIGISAQ
      *C123517 - 2021JUN21
              PERFORM 1300-OBT-TITULAR-CTASAQ
                 THRU 1300-OBT-TITULAR-CTASAQ-EXIT
           ELSE
              MOVE SPACES                   TO AMCV7300-CBALSAQ
                                               AMCV7300-CPRODSAQ
                                               AMCV7300-CCNTSAQ
                                               AMCV7300-CDIGISAQ
           END-IF.

           IF AMCV7300-CPAISIBSB EQUAL AMCK0002-CON-CPAIS-PT
           AND AMCV7300-CBANIBSB EQUAL AMCK0002-CON-CBANCO-MG
              MOVE AMCV7300-CCTAIBSB(2:3)   TO AMCV7300-CBALSUB
              MOVE AMCV7300-CCTAIBSB(7:2)   TO AMCV7300-CPRDSUB
              MOVE AMCV7300-CCTAIBSB(9:6)   TO AMCV7300-CCTASUB
              MOVE AMCV7300-CCTAIBSB(15:1)  TO AMCV7300-CDIGSUB
           ELSE
              MOVE SPACES                   TO AMCV7300-CBALSUB
                                               AMCV7300-CPRDSUB
                                               AMCV7300-CCTASUB
                                               AMCV7300-CDIGSUB
           END-IF.

      * C82065(F)

 mab****   MOVE AMCV7300-ASE               TO AMCV7301-ASE.

           INITIALIZE AMCV7301-ADE
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLAMVT0115-BASIOPER
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLAMVT1004-COMPLASS
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLAMVT2000-BENEFICI
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLAMVT3008-HISTOPER
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLAMVT3403-MOTPEND
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLCLVT0803-RELCON
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLCMVT0300-DADGERAL
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLCMVT0502-INSPMED
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLCMVT1300-PERIOENT
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLCMVT1400-LIMIDADE
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLCMVT1500-IDADES
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLCMVT1600-PLANOSUB
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLCMVT3000-QUOTAS
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLGMVT1000-BASICOS
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLGMVT1100-COMPPART
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLDCVT0100-CONTAS
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           INITIALIZE DCLDCVT1500-RELCTA
               REPLACING ALPHANUMERIC DATA BY SPACES.

           EXEC CICS
               HANDLE CONDITION
               ERROR (9010-ERRO-CICS)
           END-EXEC.
      *
           MOVE ATCL0001-DDIAOP        TO ATCW3000-DATA8 .
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT .
           MOVE ATCW3000-DATA10        TO WS-DDIAOP .
      *
           MOVE ATCL0001-SEQ-OPERACAO   TO ATCW0009-SEQUENCIA-OPER.
      *
           MOVE LENGTH OF ATCL0001-SQLERRM-DATA
                                            TO ATCL0001-SQLERRM-LEN.
           MOVE LENGTH OF AMCV7301-MSG      TO AMCV7301-LENGTH.
           MOVE AMCV7300-CORIGASS           TO AMCV7301-CORIGASS.
           MOVE AMCV7300-DAUTORIZ           TO AMCV7301-DAUTORIZ.
           MOVE AMCV7300-CBIC               TO AMCV7301-CBIC.
           MOVE AMCV7300-CIBAN              TO AMCV7301-CIBAN.
      *
      *X92567 - C4570 (I)
           MOVE AMCV7300-IEMIQCLI           TO AMCV7301-IEMIQCLI.
      *X92567 - C4570 (F)
      *
      *    PDI C194062 - INICIO

      *    MOVIMENTAÇÕES COM IBANS OIC SÓ SÃO PERMITIDAS PARA BALCÕES
      *    DA APLICAÇÃO AM

           IF AMCV7300-CBANIBSQ NOT EQUAL AMCK0002-CON-CBANCO-MG OR
              AMCV7300-CBANIBSB NOT EQUAL AMCK0002-CON-CBANCO-MG

              IF ATCL0001-CBALCAO-OPER NOT EQUAL
                                       WS-CON-AM-SERV-GEST-ADMIN  AND
                 ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-BALCAO-AM AND
                 ATCL0001-CPERFIL      NOT EQUAL
                                       WS-CON-CPERFIL-DINAM-MGAM

                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-288      TO AMCV7301-CBALCAO-MSG
                 MOVE WS-CON-1              TO AMCV7301-CBALCAO-S

              END-IF
           END-IF.
      *    PDI C194062 - FIM

       1999-INICIO-PROGRAMA-EXIT.
           EXIT.
      ******************************************************************
      *    VERIFICA SE TEM SW-DEBUG-SIM (TODOS OU DETERMIDADOS UTILIZADO
      ******************************************************************
       1010-VALIDA-DEBUG.
      *
           MOVE WS-CON-EAK                   TO TAVT0200-CTABELA.
           MOVE WS-CON-NPROGRAM              TO TAVT0200-CELEMTAB.

           EXEC SQL
             SELECT NELEMC01, NELEMC02, NELEMC03
               INTO :TAVT0200-NELEMC01, :TAVT0200-NELEMC02,
                    :TAVT0200-NELEMC03
               FROM TAVT0200_TABELAS
              WHERE CTABELA  = :TAVT0200-CTABELA
                AND CELEMTAB = :TAVT0200-CELEMTAB
           END-EXEC.
      *
           MOVE WS-CON-TAVT0200          TO ATCL0001-TABLE-NAME.
      *
           PERFORM 9020-DB2CHECK
              THRU 9029-DB2CHECK-EXIT.
      *
           IF ATCL0001-SEM-ERROS
              IF TAVT0200-OK
                 IF TAVT0200-NELEMC02 EQUAL '99999'      AND
                    TAVT0200-NELEMC03 EQUAL '99999'
                    MOVE TAVT0200-NELEMC01(1:2)
                                         TO SW-DEBUG
                 ELSE
                    IF ATCL0001-CUTILIZA EQUAL TAVT0200-NELEMC02 OR
                       ATCL0001-CUTILIZA EQUAL TAVT0200-NELEMC03
                       MOVE TAVT0200-NELEMC01(1:2)
                                         TO SW-DEBUG
                    ELSE
                       MOVE 'NN'         TO SW-DEBUG
                    END-IF
                 END-IF
              ELSE
                 IF TAVT0200-NOTFND
                    MOVE 'NN'            TO SW-DEBUG
                 ELSE
                    MOVE ATCK0002-ABEND-DB2
                                         TO ATCL0001-IND-ERROS
                    MOVE WS-CON-1        TO AMCV7301-CTIPSOC-S
                    MOVE AMCK0001-CON-497
                                         TO AMCV7301-CTIPSOC-MSG
                 END-IF
              END-IF
           ELSE
              MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-497      TO AMCV7301-CTIPSOC-MSG
           END-IF.

           IF SW-DEBUG-SIM DISPLAY '1010-VALIDA-DEBUG' END-IF.
      *
       1010-VALIDA-DEBUG-EXIT.
           EXIT.
      ******************************************************************
      *C123517 - 2021jun21    1300-OBT-TITULAR-CTASAQ                  *
      ******************************************************************
       1300-OBT-TITULAR-CTASAQ.

           IF SW-DEBUG-SIM DISPLAY '1300-OBT-TITULAR-CTASAQ    ' END-IF.

           MOVE WS-CON-N2                     TO CLCL0001-COD-OPERACAO
           MOVE ZEROS                         TO CLCL0001-ZCLIENTE
           MOVE AMCV7300-CPRODSAQ             TO CLCL0001-CPRODUTO
           MOVE AMCV7300-CBALSAQ              TO CLCL0001-CBALCAO
           MOVE AMCV7300-CCNTSAQ              TO CLCL0001-CNUMECTA
           MOVE AMCV7300-CDIGISAQ             TO CLCL0001-CDIGICTA

           PERFORM CLCP0001-TITULAR
              THRU CLCP0001-TITULAR-EXIT

           IF ATCL0001-SEM-ERROS
              IF SW-DEBUG-SIM
                 DISPLAY 'c123517 1 - cta-saq CLCL0001-ZCLIENTE = '
                                              CLCL0001-ZCLIENTE
                                          ' ' AMCV7300-CBALSAQ
                                          '.' AMCV7300-CPRODSAQ
                                          '.' AMCV7300-CCNTSAQ
                                          '-' AMCV7300-CDIGISAQ
              END-IF
              IF CLCL0001-TIT-NOTFND
                 MOVE ATCK0002-ERROS-FUNCAO  TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-078       TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1               TO AMCV7301-CTIPSOC-S
              ELSE
                 MOVE CLCL0001-ZCLIENTE      TO AMCV7300-ZCLIEMP
              END-IF
           END-IF.

      *** OPERAÇÕES SOBRE CONTAS 'AM'
           IF ATCL0001-SEM-ERROS
              IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777 AND
                 ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-510
                 IF CLCL0001-ZCLIENTE = ZCLIENTE-AM-815837
                    MOVE AMCK0001-CON-161      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS

                    DISPLAY 'ZCLIENTE-AM = 815837 E BALCAO = '
                             ATCL0001-CBALCAO-OPER
                 END-IF
              END-IF
           END-IF.
       1300-OBT-TITULAR-CTASAQ-EXIT. EXIT.
      ******************************************************************
       2000-PROC-PROGRAMA.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2000-PROC-PROGRAMA' END-IF.
      *
207004*VALIDA ROTINA AMR00016
207004     IF ATCL0001-SEM-ERROS AND ATCL0001-SIMULACAO-NAO
207004        AND AMCV7300-CTIPSOC = 'E'
207004        PERFORM 2100-VALIDA-AMR00016
207004           THRU 2100-VALIDA-AMR00016-EXIT
207004     END-IF.
      *
      * C82065 (I)
           IF ATCL0001-SEM-ERROS
              PERFORM 2001-VALIDA-IBANPT
                 THRU 2001-VALIDA-IBANPT-EXIT
           END-IF.
      * C82065 (F)

           IF ATCL0001-SEM-ERROS
              PERFORM 2010-MOVER-INPUT
                 THRU 2019-MOVER-INPUT-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2100-VALIDA
                 THRU 2199-VALIDA-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2200-CALCULA-FORMATA
                 THRU 2299-CALCULA-FORMATA-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              NOT ATCL0001-SIMULACAO-SIM
              PERFORM 2300-ACTUALIZA
                 THRU 2399-ACTUALIZA-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS AND NOT ATCL0001-SIMULACAO-SIM
      * C82065(I)
           AND AMCV7300-CPAISIBSQ EQUAL AMCK0002-CON-CPAIS-PT
           AND AMCV7300-CBANIBSQ  EQUAL AMCK0002-CON-CBANCO-MG
      * C82065(F)
              IF SW-ALTERA-CATIVO-SIM
                 PERFORM 2400-ANULA-CATIVO
                    THRU 2499-ANULA-CATIVO-EXIT

                 IF ATCL0001-SEM-ERROS
                    IF AMCV7300-CBALSAQ NOT EQUAL SPACES AND
                      (WS-TOTAL-MAE   NOT EQUAL ZEROS OR
                       WS-TOTAL-COMP1 NOT EQUAL ZEROS OR
                       WS-TOTAL-COMP2 NOT EQUAL ZEROS)
                       PERFORM 2400-INSERE-CATIVO
                          THRU 2499-INSERE-CATIVO-EXIT
                    END-IF
                 END-IF
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              SET ATCL0001-ANUL-NOTRUNC TO TRUE

              IF ATCL0001-SIMULACAO-SIM
                 IF AMCV7300-CSUBPROD EQUAL WS-CON-83
                 OR AMCV7300-CSUBPROD EQUAL WS-CON-93
                 OR AMCV7300-CSUBPROD EQUAL WS-CON-A3
                    MOVE ZEROS                TO AMCV7301-QPRAZO
      * ALT02 (I)
      *             MOVE WS-IDADRECB-MAE      TO AMCV7301-IDADRECB
                    MOVE WS-IDADEACT-DTVENCIM TO AMCV7301-IDADRECB
      * ALT02 (F)
                    MOVE WS-QPRAZO-CTI        TO AMCV7301-QPRAZO-CTI
                 END-IF

                 IF AMCV7300-CSUBPROD EQUAL (WS-CON-96 OR WS-CON-A6)
                    MOVE ZEROS                TO AMCV7301-QPRAZO
      * ALT02 (I)
      *             MOVE WS-IDADRECB-MAE      TO AMCV7301-IDADRECB
                    MOVE WS-IDADEACT-DTVENCIM TO AMCV7301-IDADRECB
      * ALT02 (F)
                    MOVE WS-QPRAZO-CTI        TO AMCV7301-QPRAZO-CTI
                 END-IF

                 IF AMCV7300-CSUBPROD EQUAL (WS-CON-84 OR WS-CON-A4)
                    MOVE WS-QPRAZO-MAE        TO AMCV7301-QPRAZO
                    MOVE ZEROS                TO AMCV7301-IDADRECB
                    MOVE WS-QPRAZO-CTI        TO AMCV7301-QPRAZO-CTI
                 END-IF
              END-IF

              IF AMCV7301-QPRAZO EQUAL WS-CON-N999
                 MOVE ZEROS             TO AMCV7301-QPRAZO
              END-IF
              IF AMCV7301-IDADRECB EQUAL WS-CON-N999
                 MOVE ZEROS             TO AMCV7301-IDADRECB
              END-IF
              IF AMCV7301-QPRAZO-CTI EQUAL WS-CON-N999
                 MOVE ZEROS             TO AMCV7301-QPRAZO-CTI
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2500-FORMATA-OUTPUT
                 THRU 2599-FORMATA-OUTPUT-EXIT
           END-IF.
      *
       2999-PROC-PROGRAMA-EXIT.
           EXIT.
207004******************************************************************
207004*                       2100-VALIDA-AMR00016
207004******************************************************************
207004 2100-VALIDA-AMR00016.
207004*
207004     IF SW-DEBUG-SIM DISPLAY "2100-VALIDA-AMR00016" END-IF.
207004*
207004     INITIALIZE AMCL0016-COMMAREA
207004                REPLACING NUMERIC BY ZEROES
207004                     ALPHANUMERIC BY SPACES.
207004*
207004     IF SW-DEBUG-SIM
207004        SET AMCL0016-DEBUG-SIM   TO TRUE
207004     END-IF.
207004*
207004     MOVE AMCV7300-CTIPSOC      TO AMCL0016-I-CTIPSOC  .
207004     MOVE AMCV7300-ZSOCIO       TO AMCL0016-I-ZSOCIO   .
207004     MOVE AMCV7300-CDIGISOC     TO AMCL0016-I-CDIGISOC .
207004
207004     CALL  WS-CON-AMR00016     USING AMCL0016-COMMAREA.
207004*
207004     IF AMCL0016-SEM-ERROS
207004        DISPLAY 'AMCL0016-O-DOC-DIG : ' AMCL0016-O-DOC-DIG
207004        DISPLAY 'AMCV7300-ZINSCRIC-S: ' AMCV7300-ZINSCRIC-S
207004        IF AMCL0016-O-DOC-DIG EQUAL 'S'
207004       AND AMCV7300-ZINSCRIC-S NOT EQUAL 'V'
207004           MOVE WS-CON-V             TO AMCV7301-ZINSCRIC-S
207004           MOVE ATCK0002-AUTORIZACAO TO ATCL0001-IND-ERROS
207004           MOVE AMCK0001-CON-318     TO AMCV7301-ZINSCRIC-MSG
207004        END-IF
207004     ELSE
207004        MOVE AMCL0016-IND-ERROS        TO ATCL0001-IND-ERROS
207004        MOVE AMCL0016-NR-ERRO          TO AMCV7301-ZINSCRIC-MSG
207004        MOVE WS-CON-1                  TO AMCV7301-ZINSCRIC-S
207004     END-IF.
207004*
207004 2100-VALIDA-AMR00016-EXIT.
207004     EXIT.
      ******************************************************************
       2001-VALIDA-IBANPT.
      ******************************************************************
           IF SW-DEBUG-SIM
              DISPLAY "2001-VALIDA-IBANPT"
           END-IF.
      *
           MOVE AMCV7300-CPAISIBSB       TO WS-CPAISIBSB.
           MOVE AMCV7300-CBANIBSB        TO WS-CBANIBSB.
           MOVE AMCV7300-CCTAIBSB        TO WS-CCTAIBSB.
           MOVE AMCV7300-CDIGIBSB        TO WS-CDIGIBSB.
      *
           IF SW-DEBUG-SIM
              DISPLAY 'WS-CPAISIBSB :' WS-CPAISIBSB
              DISPLAY 'WS-CBANIBSB  :' WS-CBANIBSB
              DISPLAY 'WS-CCTAIBSB  :' WS-CCTAIBSB
              DISPLAY 'WS-CDIGIBSB  :' WS-CDIGIBSB
              DISPLAY 'WS-CIBANBSB  :' WS-CIBANBSB
           END-IF.
      *
           IF ATCL0001-SEM-ERROS
           AND WS-CIBANBSB NOT EQUAL SPACES
              INITIALIZE  CICW0011-CALC-NIB

              MOVE WS-CIBANBSB(5:21)        TO CICW0011-NIB

              PERFORM CICP0011-CALCULAR-NIB
                 THRU CICP0011-CALCULAR-NIB-EXIT

              IF SW-DEBUG-SIM
                 DISPLAY 'CICW0011-DIGICALC :' CICW0011-DIGICALC
                 DISPLAY 'AMCV7300-CPAISIBSB:' AMCV7300-CPAISIBSB
              END-IF

              IF ((WS-CDIGIBSB NOT = CICW0011-DIGICALC)
                 OR
                 (AMCV7300-CPAISIBSB NOT EQUAL 'PT50'))

                  DISPLAY 'ERRO IBAN SUBSCRICAO!'

                  MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                  MOVE AMCK0001-CON-387      TO AMCV7301-NUMCONTA-MSG
                  MOVE WS-CON-1              TO AMCV7301-NUMCONTA-S
              END-IF
           END-IF.
      *

           MOVE AMCV7300-CPAISIBSQ     TO WS-CPAISIBSQ .
           MOVE AMCV7300-CBANIBSQ      TO WS-CBANIBSQ .
           MOVE AMCV7300-CCTAIBSQ      TO WS-CCTAIBSQ .
           MOVE AMCV7300-CDIGIBSQ      TO WS-CDIGIBSQ .
      *
           IF ATCL0001-SEM-ERROS
              AND WS-CIBANDEV NOT EQUAL SPACES
      *
              IF SW-DEBUG-SIM
                 DISPLAY 'WS-CPAISIBSQ :' WS-CPAISIBSQ
                 DISPLAY 'WS-CBANIBSQ  :' WS-CBANIBSQ
                 DISPLAY 'WS-CCTAIBSQ  :' WS-CCTAIBSQ
                 DISPLAY 'WS-CDIGIBSQ  :' WS-CDIGIBSQ
                 DISPLAY 'WS-CIBANDEV  :' WS-CIBANDEV
              END-IF
      *
              INITIALIZE  CICW0011-CALC-NIB

              MOVE WS-CIBANDEV(5:21)        TO CICW0011-NIB

              PERFORM CICP0011-CALCULAR-NIB
                 THRU CICP0011-CALCULAR-NIB-EXIT

              DISPLAY 'CICW0011-DIGICALC :' CICW0011-DIGICALC
              DISPLAY 'AMCV7300-CPAISIBSQ:' AMCV7300-CPAISIBSQ

              IF ((WS-CDIGIBSQ NOT = CICW0011-DIGICALC)
                 OR
                 (AMCV7300-CPAISIBSQ NOT EQUAL 'PT50'))

                 DISPLAY 'ERRO IBAN DE SAQUE!'

                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-387      TO AMCV7301-NUMCONTA-MSG
                 MOVE WS-CON-1              TO AMCV7301-NUMCONTA-S
              END-IF
           END-IF.
      *
       2001-VALIDA-IBANPT-EXIT.
           EXIT.
      ******************************************************************
       2010-MOVER-INPUT.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2010-MOVER-INPUT'
              DISPLAY '  CTIPSOC......: ' AMCV7300-CTIPSOC        '.'
              DISPLAY '  ZSOCIO.......: ' AMCV7300-ZSOCIO         '.'
              DISPLAY '  CDIGISOC.....: ' AMCV7300-CDIGISOC       '.'
              DISPLAY '  GTITULO......: ' AMCV7300-GTITULO        '.'
              DISPLAY '  ZINSCRIC.....: ' AMCV7300-ZINSCRIC       '.'
              DISPLAY '  CPRODUTO.....: ' AMCV7300-CPRODUTO       '.'
              DISPLAY '  CSUBPROD.....: ' AMCV7300-CSUBPROD       '.'
              DISPLAY '  CBALCAO......: ' AMCV7300-CBALCAO        '.'
              DISPLAY '  CPRODUTO-N...: ' AMCV7300-CPRODUTO-N     '.'
              DISPLAY '  CNUMECTA.....: ' AMCV7300-CNUMECTA       '.'
              DISPLAY '  CDIGICTA.....: ' AMCV7300-CDIGICTA       '.'
              DISPLAY '  CMOEDA.......: ' AMCV7300-CMOEDA         '.'
              DISPLAY '  DCONTD.......: ' AMCV7300-DCONTD         '.'
              DISPLAY '  DNASCIM-SOC1.: ' AMCV7300-DNASCIM-SOC1   '.'
              DISPLAY '  QAGRAVID.....: ' AMCV7300-QAGRAVID       '.'
              DISPLAY '  CODPER.......: ' AMCV7300-CODPER         '.'
              DISPLAY '  CBALSAQ......: ' AMCV7300-CBALSAQ        '.'
              DISPLAY '  CPRODSAQ.....: ' AMCV7300-CPRODSAQ       '.'
              DISPLAY '  CCNTSAQ......: ' AMCV7300-CCNTSAQ        '.'
              DISPLAY '  CDIGISAQ.....: ' AMCV7300-CDIGISAQ       '.'
              DISPLAY '  IPAGAEMP.....: ' AMCV7300-IPAGAEMP       '.'
              DISPLAY '  ZCLIEMP......: ' AMCV7300-ZCLIEMP        '.'
              DISPLAY '  CEMPSEC......: ' AMCV7300-CEMPSEC        '.'
              DISPLAY '  CPLSUBS......: ' AMCV7300-CPLSUBS        '.'
              DISPLAY '  TXPROG.......: ' AMCV7300-TXPROG         '.'
              DISPLAY '  QPRAZO.......: ' AMCV7300-QPRAZO         '.'
      * ALT02 (I)
              DISPLAY '  QIDRFSOL.....: ' AMCV7300-QIDRFSOL       '.'
      * ALT02 (F)
              DISPLAY '  IDADRECB.....: ' AMCV7300-IDADRECB       '.'
              DISPLAY '  PCONVPEN.....: ' AMCV7300-PCONVPEN       '.'
              DISPLAY '  ZCLIENTE-BEN.: ' AMCV7300-ZCLIENTE-BEN   '.'
              DISPLAY '  GTITULO-BEN..: ' AMCV7300-GTITULO-BEN    '.'
              DISPLAY '  DNASCIM-BEN..: ' AMCV7300-DNASCIM-BEN    '.'
              DISPLAY '  CLIBERAC.....: ' AMCV7300-CLIBERAC       '.'
              DISPLAY '  MMOVIM.......: ' AMCV7300-MMOVIM         '.'
              DISPLAY '  MQUOTAIN.....: ' AMCV7300-MQUOTAIN       '.'
              DISPLAY '  MCAPITAL.....: ' AMCV7300-MCAPITAL       '.'
              DISPLAY '  ICTI.........: ' AMCV7300-ICTI           '.'
              DISPLAY '  INDSBPRO-CTI.: ' AMCV7300-INDSBPRO-CTI   '.'
              DISPLAY '  QPRAZO-CTI...: ' AMCV7300-QPRAZO-CTI     '.'
              DISPLAY '  MMOVIM-CTI...: ' AMCV7300-MMOVIM-CTI     '.'
              DISPLAY '  MQUOTAIN-CTI.: ' AMCV7300-MQUOTAIN-CTI   '.'
              DISPLAY '  MCAPITAL-CTI.: ' AMCV7300-MCAPITAL-CTI   '.'
              DISPLAY '  ICS..........: ' AMCV7300-ICS            '.'
              DISPLAY '  MMOVIM-CS....: ' AMCV7300-MMOVIM-CS      '.'
              DISPLAY '  MQUOTAIN-CS..: ' AMCV7300-MQUOTAIN-CS    '.'
              DISPLAY '  MMOVIM-TOT...: ' AMCV7300-MMOVIM-TOT     '.'
              DISPLAY '  MQUOTAIN-TOT.: ' AMCV7300-MQUOTAIN-TOT   '.'
              DISPLAY '  GNOMEMED.....: ' AMCV7300-GNOMEMED       '.'
              DISPLAY '  MEXAMES......: ' AMCV7300-MEXAMES        '.'
              DISPLAY '  ZCLIENTE-SOC1: ' AMCV7300-ZCLIENTE-SOC1  '.'
              DISPLAY '  COPERAC......: ' AMCV7300-COPERAC        '.'
              DISPLAY '  GDESMOV......: ' AMCV7300-GDESMOV        '.'
              DISPLAY '  CORIGASS.....: ' AMCV7300-CORIGASS       '.'
              DISPLAY '  DAUTORIZ.....: ' AMCV7300-DAUTORIZ       '.'
              DISPLAY '  CBIC.........: ' AMCV7300-CBIC           '.'
              DISPLAY '  CIBAN........: ' AMCV7300-CIBAN          '.'
      * C82065(I)
              DISPLAY '  CBALSUB .....:'  AMCV7300-CBALSUB
              DISPLAY '  CPRDSUB .....:'  AMCV7300-CPRDSUB
              DISPLAY '  CCTASUB .....:'  AMCV7300-CCTASUB
              DISPLAY '  CDIGSUB .....:'  AMCV7300-CDIGSUB
              DISPLAY '  CBALMPI .....:'  AMCV7300-CBALMPI
              DISPLAY '  CPRDMPI .....:'  AMCV7300-CPRDMPI
              DISPLAY '  CCTAMPI .....:'  AMCV7300-CCTAMPI
              DISPLAY '  CDIGMPI .....:'  AMCV7300-CDIGMPI
              DISPLAY '  CTRANS  .....:'  AMCV7300-CTRANS
              DISPLAY '  ZEMPREST.....:'  AMCV7300-ZEMPREST
              DISPLAY '  DTVENCIM.....:'  AMCV7300-DTVENCIM
              DISPLAY '  IEMIQCLI.....:'  AMCV7300-IEMIQCLI
              DISPLAY '  IACTQCLI.....:'  AMCV7300-IACTQCLI
              DISPLAY '  QIDRFSOL.....:'  AMCV7300-QIDRFSOL
              DISPLAY '  CPAISIBSQ....:'  AMCV7300-CPAISIBSQ
              DISPLAY '  CBANIBSQ ....:'  AMCV7300-CBANIBSQ
              DISPLAY '  CCTAIBSQ ....:'  AMCV7300-CCTAIBSQ
              DISPLAY '  CDIGIBSQ ....:'  AMCV7300-CDIGIBSQ
              DISPLAY '  CPAISIBSB....:'  AMCV7300-CPAISIBSB
              DISPLAY '  CBANIBSB ....:'  AMCV7300-CBANIBSB
              DISPLAY '  CCTAIBSB ....:'  AMCV7300-CCTAIBSB
              DISPLAY '  CDIGIBSB ....:'  AMCV7300-CDIGIBSB
      * C82065(F)
      *PDI-C138491
              DISPLAY '  CGESTMUT ....:'  AMCV7300-CGESTMUT
           END-IF.

           MOVE AMCV7300-CTIPSOC       TO AMCV7301-CTIPSOC .
           MOVE AMCV7300-ZSOCIO        TO AMCV7301-ZSOCIO  .
           MOVE AMCV7300-CDIGISOC      TO AMCV7301-CDIGISOC.
           MOVE AMCV7300-GTITULO       TO AMCV7301-GTITULO .
           MOVE AMCV7300-ZINSCRIC      TO AMCV7301-ZINSCRIC.
           MOVE AMCV7300-CPRODUTO      TO AMCV7301-CPRODUTO.
           MOVE AMCV7300-CSUBPROD      TO AMCV7301-CSUBPROD.
           MOVE AMCV7300-CBALCAO       TO AMCV7301-CBALCAO .
           MOVE AMCV7300-NUMCONTA      TO AMCV7301-NUMCONTA.
           MOVE AMCV7300-CMOEDA        TO AMCV7301-CMOEDA  .
           MOVE AMCV7300-DCONTD        TO AMCV7301-DCONTD  .
           MOVE AMCV7300-DNASCIM-SOC1  TO AMCV7301-DNASCIM-SOC1.
           MOVE AMCV7300-QAGRAVID      TO AMCV7301-QAGRAVID.
           MOVE AMCV7300-CODPER        TO AMCV7301-CODPER  .
           MOVE AMCV7300-CBALSAQ       TO AMCV7301-CBALSAQ .
           MOVE AMCV7300-CPRODSAQ      TO AMCV7301-CPRODSAQ.
           MOVE AMCV7300-CCNTSAQ       TO AMCV7301-CCNTSAQ .
           MOVE AMCV7300-CDIGISAQ      TO AMCV7301-CDIGISAQ.
      * C82065(I)
           MOVE AMCV7300-CPAISIBSQ     TO AMCV7301-CPAISIBSQ.
           MOVE AMCV7300-CBANIBSQ      TO AMCV7301-CBANIBSQ .
           MOVE AMCV7300-CCTAIBSQ      TO AMCV7301-CCTAIBSQ .
           MOVE AMCV7300-CDIGIBSQ      TO AMCV7301-CDIGIBSQ .
      * C82065(F)
           MOVE AMCV7300-IPAGAEMP      TO AMCV7301-IPAGAEMP.
           MOVE AMCV7300-ZCLIEMP       TO AMCV7301-ZCLIEMP .
           MOVE AMCV7300-CEMPSEC       TO AMCV7301-CEMPSEC .

           MOVE AMCV7300-CPLSUBS       TO AMCV7301-CPLSUBS     .
           MOVE AMCV7300-TXPROG        TO AMCV7301-TXPROG      .
           MOVE AMCV7300-QPRAZO        TO AMCV7301-QPRAZO      .
      * ALT02 (I)
           MOVE AMCV7300-QIDRFSOL      TO AMCV7301-QIDRFSOL    .
      * ALT02 (F)
           MOVE AMCV7300-IDADRECB      TO AMCV7301-IDADRECB    .
           MOVE AMCV7300-PCONVPEN      TO AMCV7301-PCONVPEN    .
           MOVE AMCV7300-ZCLIENTE-BEN  TO AMCV7301-ZCLIENTE-BEN.
           MOVE AMCV7300-GTITULO-BEN   TO AMCV7301-GTITULO-BEN .
           MOVE AMCV7300-DNASCIM-BEN   TO AMCV7301-DNASCIM-BEN .
           MOVE AMCV7300-CLIBERAC      TO AMCV7301-CLIBERAC    .
           MOVE AMCV7300-MMOVIM        TO AMCV7301-MMOVIM      .
           MOVE AMCV7300-MQUOTAIN      TO AMCV7301-MQUOTAIN    .
           MOVE AMCV7300-MCAPITAL      TO AMCV7301-MCAPITAL    .

           MOVE AMCV7300-ICTI          TO AMCV7301-ICTI        .
           MOVE AMCV7300-INDSBPRO-CTI  TO AMCV7301-INDSBPRO-CTI.
           MOVE AMCV7300-QPRAZO-CTI    TO AMCV7301-QPRAZO-CTI  .
           MOVE AMCV7300-MMOVIM-CTI    TO AMCV7301-MMOVIM-CTI  .
           MOVE AMCV7300-MQUOTAIN-CTI  TO AMCV7301-MQUOTAIN-CTI.
           MOVE AMCV7300-MCAPITAL-CTI  TO AMCV7301-MCAPITAL-CTI.

           MOVE AMCV7300-ICS           TO AMCV7301-ICS         .
           MOVE AMCV7300-MMOVIM-CS     TO AMCV7301-MMOVIM-CS   .
           MOVE AMCV7300-MQUOTAIN-CS   TO AMCV7301-MQUOTAIN-CS .

           MOVE AMCV7300-MMOVIM-TOT    TO AMCV7301-MMOVIM-TOT  .
           MOVE AMCV7300-MQUOTAIN-TOT  TO AMCV7301-MQUOTAIN-TOT.

           MOVE AMCV7300-GNOMEMED      TO AMCV7301-GNOMEMED.
           MOVE AMCV7300-MEXAMES       TO AMCV7301-MEXAMES.

           MOVE AMCV7300-ZCLIENTE-SOC1 TO AMCV7301-ZCLIENTE-SOC1.

           MOVE AMCV7300-COPERAC       TO AMCV7301-COPERAC.
           MOVE AMCV7300-GDESMOV       TO AMCV7301-GDESMOV.

           MOVE AMCV7300-CBALSUB       TO AMCV7301-CBALSUB .
           MOVE AMCV7300-CPRDSUB       TO AMCV7301-CPRDSUB .
           MOVE AMCV7300-CCTASUB       TO AMCV7301-CCTASUB .
           MOVE AMCV7300-CDIGSUB       TO AMCV7301-CDIGSUB .
      * C82065(I)
           MOVE AMCV7300-CPAISIBSB     TO AMCV7301-CPAISIBSB.
           MOVE AMCV7300-CBANIBSB      TO AMCV7301-CBANIBSB .
           MOVE AMCV7300-CCTAIBSB      TO AMCV7301-CCTAIBSB .
           MOVE AMCV7300-CDIGIBSB      TO AMCV7301-CDIGIBSB .
      * C82065(F)
           MOVE AMCV7300-CBALMPI       TO AMCV7301-CBALMPI .
           MOVE AMCV7300-CPRDMPI       TO AMCV7301-CPRDMPI .
           MOVE AMCV7300-CCTAMPI       TO AMCV7301-CCTAMPI .
           MOVE AMCV7300-CDIGMPI       TO AMCV7301-CDIGMPI .
      *PDI-C138491
           MOVE AMCV7300-CGESTMUT      TO AMCV7301-CGESTMUT .
      *
       2019-MOVER-INPUT-EXIT.
           EXIT.
      ******************************************************************
       2100-VALIDA.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2100-VALIDA' END-IF.

           PERFORM 9500-SELECT-AMT01
              THRU 9500-SELECT-AMT01-EXIT.
      *
           IF ATCL0001-SEM-ERROS
              PERFORM 2101-VALIDA-SOCIO
                 THRU 2101-VALIDA-SOCIO-EXIT
           ELSE
              PERFORM 3000-FINAL-PROGRAMA
           END-IF
      *
           IF ATCL0001-SEM-ERROS
              PERFORM 2102-VALIDA-CLIENTE
                 THRU 2102-VALIDA-CLIENTE-EXIT
           ELSE
              PERFORM 3000-FINAL-PROGRAMA
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2103-OBTEM-COMPLEMENTARES
                 THRU 2103-OBTEM-COMPLEMENTARES-EXIT
           ELSE
              PERFORM 3000-FINAL-PROGRAMA
           END-IF.

      * 2013-05-03 - VALIDAçãO ESPECIAL PARA BM45-73/93 - INICIO
           IF ATCL0001-SEM-ERROS
              IF AMCV7300-CPRODUTO = WS-CON-73 AND
                (AMCV7300-CSUBPROD = WS-CON-93 OR
                 AMCV7300-CSUBPROD = WS-CON-A3)
              THEN
                 PERFORM 2104-VERIFICA-BM45
                    THRU 2104-VERIFICA-BM45-EXIT
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF WS-AMT30-GREFMOV  = WS-CON-BM45 AND
                 AMCV7300-CPRODUTO = WS-CON-73   AND
                (AMCV7300-CSUBPROD = WS-CON-93   OR
                 AMCV7300-CSUBPROD = WS-CON-A3)
              THEN
                 PERFORM 2104-VAL-CMT03-BM45-73-93
                    THRU 2104-VAL-CMT03-BM45-73-93-EXIT
              ELSE
                 PERFORM 2104-VALIDA-CMT03
                    THRU 2104-VALIDA-CMT03-EXIT
              END-IF
      * 2013-05-03 - VALIDAçãO ESPECIAL PARA BM45-73/93 - FIM
           ELSE
              PERFORM 3000-FINAL-PROGRAMA
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2106-VALIDA-DCONTD
                 THRU 2106-VALIDA-DCONTD-EXIT
           ELSE
              PERFORM 3000-FINAL-PROGRAMA
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-CLIBERAC EQUAL WS-CON-1
                 IF AMCV7300-CODPER NOT EQUAL WS-CON-U00
                    MOVE WS-CON-U00         TO AMCV7300-CODPER
                    MOVE WS-CON-U00         TO AMCV7301-CODPER
                 END-IF
              ELSE
                 IF AMCV7300-CODPER EQUAL WS-CON-U00
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-036      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2107-VAL-PERIODICIDADE
                 THRU 2107-VAL-PERIODICIDADE-EXIT
           ELSE
              PERFORM 3000-FINAL-PROGRAMA
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-CBALSAQ NOT EQUAL SPACES
                 PERFORM 2108-VALIDA-CONTA-DO
                    THRU 2108-VALIDA-CONTA-DO-EXIT

                 IF ATCL0001-SEM-ERROS AND
                    NOT ATCL0001-SIMULACAO-SIM
                    PERFORM 2109-VAL-TITULAR-AUT
                       THRU 2109-VAL-TITULAR-AUT-EXIT
                 END-IF
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-ZCLIEMP NOT EQUAL ZEROS
                 PERFORM 2110-VALIDA-ZCLIEMP
                    THRU 2110-VALIDA-ZCLIEMP-EXIT
              END-IF
           ELSE
              PERFORM 3000-FINAL-PROGRAMA
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-CEMPSEC NOT EQUAL ZEROS
      * C82065(I)
      *          IF AMCV7300-CBALSAQ  NOT EQUAL SPACES OR
      *             AMCV7300-CPRODSAQ NOT EQUAL SPACES OR
      *             AMCV7300-CCNTSAQ  NOT EQUAL SPACES OR
      *             AMCV7300-CDIGISAQ NOT EQUAL SPACES
                 IF AMCV7300-CPAISIBSQ NOT EQUAL SPACES OR
                    AMCV7300-CBBANSAQ  NOT EQUAL SPACES
      * C82065(F)
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-065      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
      * C82065(I)
      *          IF AMCV7300-CBALSAQ  EQUAL SPACES OR
      *             AMCV7300-CPRODSAQ EQUAL SPACES OR
      *             AMCV7300-CCNTSAQ  EQUAL SPACES OR
      *             AMCV7300-CDIGISAQ EQUAL SPACES
                 IF AMCV7300-CPAISIBSQ EQUAL SPACES OR
                    AMCV7300-CBBANSAQ  EQUAL SPACES
      * C82065(F)
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-104      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-CLIBERAC EQUAL WS-CON-1
                 IF AMCV7300-CBALSAQ EQUAL SPACES
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-938      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.

      *2013-07-10* VALIDA MíNIMO LIBERAçãO à CABEçA - INICIO
           IF ATCL0001-SEM-ERROS
              PERFORM 2111-VALIDA-CMT16
                 THRU 2111-VALIDA-CMT16-EXIT
           END-IF.
      *2013-07-10* VALIDA MíNIMO LIBERAçãO à CABEçA - FIM

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-ZCLIENTE-BEN NOT EQUAL ZEROS
                 IF CMVT0300-INDBENEF NOT EQUAL WS-CON-1
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-942      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 IF CMVT0300-INDBENEF EQUAL WS-CON-1
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-951      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-ZCLIENTE-BEN NOT EQUAL ZEROS
                 PERFORM 2113-VALIDA-CLIENTE-BEN
                    THRU 2113-VALIDA-CLIENTE-BEN-EXIT
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-ZCLIENTE-BEN NOT EQUAL ZEROS
                 PERFORM 2114-OBTEM-COMPLEM-BEN
                    THRU 2114-OBTEM-COMPLEM-BEN-EXIT
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2115-CALCULA-IDADES-1
                 THRU 2115-CALCULA-IDADES-1-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-ZCLIENTE-BEN NOT EQUAL ZEROS
                 PERFORM 2116-CALCULA-IDADES-BEN
                    THRU 2116-CALCULA-IDADES-BEN-EXIT
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-CSUBPROD EQUAL WS-CON-83
              OR AMCV7300-CSUBPROD EQUAL WS-CON-93
              OR AMCV7300-CSUBPROD EQUAL WS-CON-A3
      * ALT02 (I)
      *          IF AMCV7300-IDADRECB NOT GREATER WS-IDADEACT-SOCIO
                 IF AMCV7300-QIDRFSOL NOT GREATER WS-IDADEACT-SOCIO
      * ALT02 (F)
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-052      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.
      *
           IF ATCL0001-SEM-ERROS
              IF AMCV7300-CSUBPROD EQUAL (WS-CON-96 OR WS-CON-A6)
      * ALT02 (I)
      *          IF AMCV7300-IDADRECB NOT GREATER WS-IDADEACT-BEN
                 IF AMCV7300-QIDRFSOL NOT GREATER WS-IDADEACT-BEN
      * ALT02 (F)
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-052      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-ICTI EQUAL WS-CON-1
                 PERFORM 2117-VALIDA-CMT03-CTI
                    THRU 2117-VALIDA-CMT03-CTI-EXIT
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-QAGRAVID GREATER WS-CON-N10 AND
                 AMCV7300-ICTI       EQUAL WS-CON-1
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-981      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2118-PRAZO-RECEB
                 THRU 2118-PRAZO-RECEB-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF WS-QPRAZO-MAE GREATER WS-PRAZOMAX-MAE
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-990      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF

              IF WS-QPRAZO-MAE LESS WS-PRAZOMIN-MAE
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-991      TO AMCV7301-ZSOCIO-MSG
                 MOVE WS-CON-1              TO AMCV7301-ZSOCIO-S
              END-IF
           END-IF.


           IF ATCL0001-SEM-ERROS
              IF WS-QPRAZO-CTI GREATER WS-PRAZOMAX-CTI
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-990      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF

              IF WS-QPRAZO-CTI LESS WS-PRAZOMIN-CTI
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-991      TO AMCV7301-ZSOCIO-MSG
                 MOVE WS-CON-1              TO AMCV7301-ZSOCIO-S
              END-IF
           END-IF.
      *
           IF ATCL0001-SEM-ERROS
              IF AMCV7300-CSUBPROD EQUAL (WS-CON-96 OR WS-CON-A6)
                 IF AMCV7300-ZCLIENTE-BEN NOT EQUAL ZEROS
                    PERFORM 2128-CAL-IDADE-REC-BEN
                       THRU 2128-CAL-IDADE-REC-BEN-EXIT
                 END-IF
      *
                 IF ATCL0001-SEM-ERROS
                    IF WS-IDADETET-REC-BEN LESS 18
                       MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                       MOVE AMCK0001-CON-743     TO AMCV7301-CTIPSOC-MSG
                       MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                    END-IF
                 END-IF
              END-IF
           END-IF.
      *
           IF ATCL0001-SEM-ERROS
              IF AMCV7300-ICS      EQUAL WS-CON-1 AND
                (AMCV7300-CSUBPROD EQUAL WS-CON-83 OR
                 AMCV7300-CSUBPROD EQUAL WS-CON-93 OR
                 AMCV7300-CSUBPROD EQUAL WS-CON-A3)
                 PERFORM 2119-VALIDA-CMT03-CS
                    THRU 2119-VALIDA-CMT03-CS-EXIT
              ELSE
                 MOVE WS-CON-0     TO AMCV7301-ICS
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2120-VAL-LIMIDADES
                 THRU 2120-VAL-LIMIDADES-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-ZCLIENTE-BEN NOT EQUAL ZEROS
                 PERFORM 2121-VAL-LIMIDADES-BEN
                    THRU 2121-VAL-LIMIDADES-BEN-EXIT
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-ICTI EQUAL WS-CON-1
                 PERFORM 2122-VAL-LIMIDADES-CTI
                    THRU 2122-VAL-LIMIDADES-CTI-EXIT
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2123-OBTEM-ZINSCRIC
                 THRU 2123-OBTEM-ZINSCRIC-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMCV7300-CSUBPROD EQUAL (WS-CON-84 OR WS-CON-A4)
              IF AMCV7300-QPRAZO LESS WS-CON-N10
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-743      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF AMCV7300-MEXAMES NOT EQUAL ZEROS
              MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
              MOVE AMCK0001-CON-089      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
           IF ATCL0001-SEM-ERROS
      * C82065(I)
           AND AMCV7300-CBALSUB NOT EQUAL SPACES
      * C82065(F)
              PERFORM 2127-VALIDA-CNTSUB
                 THRU 2127-VALIDA-CNTSUB-EXIT
           END-IF.
      *
       2199-VALIDA-EXIT.
           EXIT.
      ******************************************************************
       2101-VALIDA-SOCIO.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2101-VALIDA-SOCIO' END-IF.

           MOVE AMCV7300-CTIPSOC       TO AMVT1004-CTIPSOC.
           MOVE AMCV7300-ZSOCIO        TO AMVT1004-ZSOCIO.
           MOVE AMCV7300-CDIGISOC      TO AMVT1004-CDIGISOC.

           EXEC SQL
                SELECT  A.ZCLIENTE
                     ,  A.DSAIDA
                     ,  A.CQUALSOC
                     ,  A.CENDALT
                     ,  A.ZCLIENV
                     ,  A.ZMORADA
                     ,  A.CORIGASS
                     ,  B.NOMER
                  INTO :AMVT1004-ZCLIENTE
                     , :AMVT1004-DSAIDA
                     , :AMVT1004-CQUALSOC
                     , :AMVT1004-CENDALT
                     , :AMVT1004-ZCLIENV
                     , :AMVT1004-ZMORADA
                     , :AMVT1004-CORIGASS
                     , :GMVT1000-NOMER
                  FROM  AMVT1004_COMPLASS A,
                        GMVT1000_BASICOS B
                 WHERE  A.ZCLIENTE = B.ZCLIENTE
                   AND  A.ZSOCIO   = :AMVT1004-ZSOCIO
                   AND  A.CTIPSOC  = :AMVT1004-CTIPSOC
                   AND  A.CDIGISOC = :AMVT1004-CDIGISOC
           END-EXEC.

           MOVE WS-CON-AMVT1004 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF DB2-OK
                 IF AMVT1004-DSAIDA NOT EQUAL WS-CON-0001-01-01
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-034      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 ELSE
                    IF AMVT1004-CQUALSOC NOT EQUAL WS-CON-S
                       PERFORM 9000-VALIDA-QA
                          THRU 9099-VALIDA-QA-EXIT
                    END-IF

                    IF ATCL0001-SEM-ERROS
                       MOVE GMVT1000-NOMER    TO AMCV7301-GTITULO
                       MOVE AMVT1004-ZCLIENTE TO AMCV7301-ZCLIENTE-SOC1
                    END-IF
                 END-IF
              ELSE
                 IF DB2-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-001      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-520      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-520      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2101-VALIDA-SOCIO-EXIT.
           EXIT.
      ******************************************************************
       2102-VALIDA-CLIENTE.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2102-VALIDA-CLIENTE' END-IF.

           MOVE AMCV7301-ZCLIENTE-SOC1 TO AMCWCL00-ZCLIENTE.

accdc      PERFORM AMCPGM00-VAL-CLI
accdc         THRU AMCPGM00-VAL-CLI-EXIT.

           MOVE AMCWCL00-NR-ERRO  TO AMCV7301-CTIPSOC-MSG.
           MOVE AMCWCL00-STATUS   TO AMCV7301-CTIPSOC-S.

           IF ATCL0001-SEM-ERROS
              IF GMVT1000-CCLITIPO EQUAL WS-CON-F
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-801      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF GMVT1000-CTIPCLI NOT EQUAL WS-CON-P
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-802      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              ELSE
                 MOVE GMVT1000-CNATJUR   TO WS-CNATJUR
              END-IF
           END-IF.
      *
       2102-VALIDA-CLIENTE-EXIT.
           EXIT.
      ******************************************************************
       2103-OBTEM-COMPLEMENTARES.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2103-OBTEM-COMPLEMENTARES' END-IF.

           MOVE AMCV7301-ZCLIENTE-SOC1 TO GMVT1100-ZCLIENTE.

           EXEC SQL
                SELECT  DNASCIME,
                        ISEXO
                  INTO  :GMVT1100-DNASCIME,
                        :GMVT1100-ISEXO
                  FROM  GMVT1100_COMPPART
                 WHERE  ZCLIENTE = :GMVT1100-ZCLIENTE
           END-EXEC.

           MOVE WS-CON-GMVT1100 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF GMVT1100-OK
                 IF GMVT1100-DNASCIME EQUAL WS-CON-0001-01-01
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-081    TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE GMVT1100-DNASCIME TO ATCW3000-DATA10
                    PERFORM ATCP3000-CONV-DATA108
                       THRU ATCP3000-CONV-DATA108-EXIT
                    MOVE ATCW3000-DATA8     TO AMCV7301-DNASCIM-SOC1
                 END-IF

                 MOVE GMVT1100-ISEXO    TO AMCV7301-ISEXO
              ELSE
                 IF GMVT1100-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-762      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-761      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-761      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2103-OBTEM-COMPLEMENTARES-EXIT.
           EXIT.
      * 2013-05-03 - VALIDAçãO ESPECIAL PARA BM45-73/93 - INICIO
      ******************************************************************
       2104-VERIFICA-BM45.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2104-VERIFICA-BM45' END-IF.

           MOVE AMCV7300-CPRODUTO       TO WS-AMT30-CPRODUTO.
           MOVE AMCV7300-CBALCAO        TO WS-AMT30-CBALCAO .
           MOVE AMCV7300-CNUMECTA       TO WS-AMT30-CNUMECTA.
           MOVE AMCV7300-CDIGICTA       TO WS-AMT30-CDIGICTA.

           EXEC SQL
                SELECT           GREFMOV
                  INTO :WS-AMT30-GREFMOV
                  FROM  AMVT3008_HISTOPER
                 WHERE  CPRODUTO = :WS-AMT30-CPRODUTO
                   AND  CBALCAO  = :WS-AMT30-CBALCAO
                   AND  CNUMECTA = :WS-AMT30-CNUMECTA
                   AND  CDIGICTA = :WS-AMT30-CDIGICTA
                   AND  ZMOVCTA  = 1
           END-EXEC.

           MOVE WS-CON-AMVT3008 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT3008-OK
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-556   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-556      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.

       2104-VERIFICA-BM45-EXIT.
           EXIT.
      ******************************************************************
       2104-VAL-CMT03-BM45-73-93.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2104-VAL-CMT03-BM45-73-93' END-IF.
      *
           MOVE AMCV7300-CPRODUTO TO CMVT0300-CPRODUTO.
           MOVE AMCV7300-CSUBPROD TO CMVT0300-CSUBPROD.
           MOVE AMCV7300-CMOEDA   TO CMVT0300-CMOEDA.

           IF  AMCV7300-DCONTD = WS-CON-00010101 OR SPACES
               MOVE ATCL0001-DDIAOP TO ATCW3000-DATA8
           ELSE
               MOVE AMCV7300-DCONTD TO ATCW3000-DATA8
           END-IF.

           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT.

           MOVE ATCW3000-DATA10 TO CMVT0300-DATAFIM.

           EXEC SQL
                SELECT CPRODUTO
                     , CSUBPROD
                     , CMOEDA
                     , DATAINI
                     , DATAFIM
                     , INDPRDAT
                     , CPLREM
                     , CPLPEN
                     , IREMUN
                     , CPRZMREM
                     , CTXREF
                     , PGMAXINV
                     , PGMININV
                     , MMULTSUB
                     , INDSUBMT
                     , MULTSUBC
                     , INDSUBTP
                     , CNUMVIDA
                     , PERINDPL
                     , INDAIDAD
                     , INDIPMED
                     , QUESTCLI
                     , CCOMP
                     , IBENPROP
                     , IBENTERC
                     , INDBENEF
                     , INDSUBEN
                     , INDDEBEN
                     , INDBENHE
                     , INDSUBHE
                     , INDDEBHE
                     , PRAZOMIN
                     , PRAZOMAX
                     , INDREVER
                     , CODBENEP
                     , CTIPOPEN
                     , CPRZMIPT
                     , CPERFRA
                     , INDPRPER
                     , PRAZPREM
                     , PPREM
                     , MPREM
                     , IMELHORI
                     , ISUCDOAC
                     , INDEDIMP
                     , PERCVLND
                     , ITEMGAR
                     , INDPMAPA
                     , DATEMISS
                     , CUTPDMAP
                     , CUTULMOD
                     , HTIMEST
                     , DCRIACAO
               INTO :CMVT0300-CPRODUTO
                     , :CMVT0300-CSUBPROD
                     , :CMVT0300-CMOEDA
                     , :CMVT0300-DATAINI
                     , :CMVT0300-DATAFIM
                     , :CMVT0300-INDPRDAT
                     , :CMVT0300-CPLREM
                     , :CMVT0300-CPLPEN
                     , :CMVT0300-IREMUN
                     , :CMVT0300-CPRZMREM
                     , :CMVT0300-CTXREF
                     , :CMVT0300-PGMAXINV
                     , :CMVT0300-PGMININV
                     , :CMVT0300-MMULTSUB
                     , :CMVT0300-INDSUBMT
                     , :CMVT0300-MULTSUBC
                     , :CMVT0300-INDSUBTP
                     , :CMVT0300-CNUMVIDA
                     , :CMVT0300-PERINDPL
                     , :CMVT0300-INDAIDAD
                     , :CMVT0300-INDIPMED
                     , :CMVT0300-QUESTCLI
                     , :CMVT0300-CCOMP
                     , :CMVT0300-IBENPROP
                     , :CMVT0300-IBENTERC
                     , :CMVT0300-INDBENEF
                     , :CMVT0300-INDSUBEN
                     , :CMVT0300-INDDEBEN
                     , :CMVT0300-INDBENHE
                     , :CMVT0300-INDSUBHE
                     , :CMVT0300-INDDEBHE
                     , :CMVT0300-PRAZOMIN
                     , :CMVT0300-PRAZOMAX
                     , :CMVT0300-INDREVER
                     , :CMVT0300-CODBENEP
                     , :CMVT0300-CTIPOPEN
                     , :CMVT0300-CPRZMIPT
                     , :CMVT0300-CPERFRA
                     , :CMVT0300-INDPRPER
                     , :CMVT0300-PRAZPREM
                     , :CMVT0300-PPREM
                     , :CMVT0300-MPREM
                     , :CMVT0300-IMELHORI
                     , :CMVT0300-ISUCDOAC
                     , :CMVT0300-INDEDIMP
                     , :CMVT0300-PERCVLND
                     , :CMVT0300-ITEMGAR
                     , :CMVT0300-INDPMAPA
                     , :CMVT0300-DATEMISS
                     , :CMVT0300-CUTPDMAP
                     , :CMVT0300-CUTULMOD
                     , :CMVT0300-HTIMEST
                     , :CMVT0300-DCRIACAO
                  FROM CMVT0300_DADGERAL
                 WHERE CPRODUTO  =  :CMVT0300-CPRODUTO
                   AND CSUBPROD  =  :CMVT0300-CSUBPROD
                   AND CMOEDA    =  :CMVT0300-CMOEDA
                   AND DATAFIM   >= :CMVT0300-DATAFIM
           END-EXEC.

           MOVE WS-CON-CMVT0300   TO ATCL0001-TABLE-NAME.

           PERFORM 9020-DB2CHECK
              THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF CMVT0300-OK
                 IF CMVT0300-INDPRDAT NOT EQUAL WS-CON-S
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-749      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 IF CMVT0300-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-712   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-616   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-616 TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-QAGRAVID NOT EQUAL ZEROS AND
                 CMVT0300-INDAIDAD EQUAL WS-CON-N
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-941   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE CMVT0300-MMULTSUB     TO WS-MMULTSUB-MAE
              MOVE CMVT0300-INDSUBMT     TO WS-INDSUBMT-MAE
              MOVE CMVT0300-MULTSUBC     TO WS-MULTSUBC-MAE
              MOVE CMVT0300-PRAZOMIN     TO WS-PRAZOMIN-MAE
              MOVE CMVT0300-PRAZOMAX     TO WS-PRAZOMAX-MAE
              MOVE CMVT0300-CPERFRA      TO WS-CPERFRA-MAE
              MOVE CMVT0300-CPLREM       TO WS-CPLREM-MAE
              SET  CONTROLA-AVISO        TO TRUE
           END-IF.

       2104-VAL-CMT03-BM45-73-93-EXIT.
           EXIT.
      * 2013-05-03 - VALIDAçãO ESPECIAL PARA BM45-73/93 - FIM
      ******************************************************************
       2104-VALIDA-CMT03.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2104-VALIDA-CMT03' END-IF.

           MOVE AMCV7300-CPRODUTO TO CMCW0100-CPRODUTO.
           MOVE AMCV7300-CSUBPROD TO CMCW0100-CSUBPROD.
           MOVE AMCV7300-CMOEDA   TO CMCW0100-CMOEDA.

           MOVE AMCV7300-DCONTD   TO CMCW0100-DATAINI.

           PERFORM 9999-VALIDA-PRODUTO
              THRU 9999-VALIDA-PRODUTO-EXIT.

           MOVE CMCW0100-SQLCODE  TO ATCW0005-SQLCODE.

           IF ATCL0001-SEM-ERROS
              IF CMVT0300-OK
                 IF CMVT0300-INDPRDAT NOT EQUAL WS-CON-S
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-749      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 IF CMVT0300-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-712   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-616   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-616 TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-QAGRAVID NOT EQUAL ZEROS AND
                 CMVT0300-INDAIDAD EQUAL WS-CON-N
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-941   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE CMVT0300-MMULTSUB           TO WS-MMULTSUB-MAE
              MOVE CMVT0300-INDSUBMT           TO WS-INDSUBMT-MAE
              MOVE CMVT0300-MULTSUBC           TO WS-MULTSUBC-MAE
              MOVE CMVT0300-PRAZOMIN           TO WS-PRAZOMIN-MAE
              MOVE CMVT0300-PRAZOMAX           TO WS-PRAZOMAX-MAE
              MOVE CMVT0300-CPERFRA            TO WS-CPERFRA-MAE
              MOVE CMVT0300-CPLREM             TO WS-CPLREM-MAE

              SET CONTROLA-AVISO   TO TRUE
           END-IF.
      *
       2104-VALIDA-CMT03-EXIT.
           EXIT.
      ******************************************************************
       2105-VALIDA-INSCRICOES.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2105-VALIDA-INSCRICOES' END-IF.

           MOVE AMCV7300-CTIPSOC       TO AMVT0115-CTIPSOC.
           MOVE AMCV7300-ZSOCIO        TO AMVT0115-ZSOCIO.
           MOVE AMCV7300-CDIGISOC      TO AMVT0115-CDIGISOC.
           MOVE ZEROS                  TO WS-CONTADOR.

           EXEC SQL
                SELECT  COUNT(*)
                  INTO :WS-CONTADOR
                  FROM  AMVT0115_BASIOPER
                 WHERE  CTIPSOC  = :AMVT0115-CTIPSOC
                   AND  ZSOCIO   = :AMVT0115-ZSOCIO
                   AND  CDIGISOC = :AMVT0115-CDIGISOC
                   AND (CESTADO  = '00'
                    OR  CESTADO  = '01'
                    OR  CESTADO  = '02')
           END-EXEC.

           MOVE WS-CON-AMVT0115 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF AMVT0115-OK
                 IF WS-CONTADOR LESS THAN 1
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-982    TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 IF NOT AMVT0115-NOTFND
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-500      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-500      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2105-VALIDA-INSCRICOES-EXIT.
           EXIT.
      ******************************************************************
       2106-VALIDA-DCONTD.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2106-VALIDA-DCONTD' END-IF.

           IF AMCV7300-DCONTD(7:2) NOT EQUAL WS-CON-01
              MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
              MOVE AMCK0001-CON-936      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
           IF  ((AMCV7300-DCONTD GREATER ATCL0001-DDIAOP)
           AND  (AMCV7300-CTRANS NOT = WS-CON-BM45))
              MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
              MOVE AMCK0001-CON-936      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2106-VALIDA-DCONTD-EXIT.
           EXIT.
      ******************************************************************
       2107-VAL-PERIODICIDADE.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2107-VAL-PERIODICIDADE' END-IF.

           MOVE AMCV7300-CPRODUTO  TO CMVT1300-CPRODUTO.
           MOVE AMCV7300-CSUBPROD  TO CMVT1300-CSUBPROD.
           MOVE AMCV7300-CMOEDA    TO CMVT1300-CMOEDA.
           MOVE AMCV7300-CODPER    TO CMVT1300-CODPER.
           MOVE AMCV7300-DCONTD    TO ATCW3000-DATA8.
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT.
           MOVE ATCW3000-DATA10    TO CMVT1300-DATAINI
                                      CMVT1300-DATAFIM.

           EXEC SQL
                SELECT  CODPER   ,
                        PERCAGQT
                  INTO :CMVT1300-CODPER   ,
                       :CMVT1300-PERCAGQT
                  FROM  CMVT1300_PERIOENT
                 WHERE  CPRODUTO = :CMVT1300-CPRODUTO
                   AND  CSUBPROD = :CMVT1300-CSUBPROD
                   AND  CMOEDA   = :CMVT1300-CMOEDA
                   AND  CODPER   = :CMVT1300-CODPER
                   AND  DATAINI <= :CMVT1300-DATAINI
                   AND  DATAFIM >= :CMVT1300-DATAFIM
           END-EXEC.

           MOVE WS-CON-CMVT1300 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT CMVT1300-OK
                 IF CMVT1300-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-036      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-656      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-656      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2107-VAL-PERIODICIDADE-EXIT.
           EXIT.
      ******************************************************************
       2108-VALIDA-CONTA-DO.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2108-VALIDA-CONTA-DO' END-IF.

           MOVE AMCV7300-CBALSAQ  TO AMCWDC00-CBALCAO.
           MOVE AMCV7300-CPRODSAQ TO AMCWDC00-CPRODUTO.
           MOVE AMCV7300-CCNTSAQ  TO AMCWDC00-CNUMECTA.
           MOVE AMCV7300-CDIGISAQ TO AMCWDC00-CDIGICTA.

           PERFORM AMCPDC00-VAL-CTA
              THRU AMCPDC00-VAL-CTA-EXIT.

           MOVE AMCWDC00-NR-ERRO  TO AMCV7301-CTIPSOC-MSG.
           MOVE AMCWDC00-STATUS   TO AMCV7301-CTIPSOC-S.

           IF ATCL0001-SEM-ERROS
              MOVE DCVT0100-CSITCTA   TO WS-CSITCTA
              MOVE DCVT0100-CTRATCTA  TO WS-CTRATCTA
              MOVE WS-CSITCTA         TO AMCWDC01-SITUCTA
              MOVE WS-CON-1           TO AMCWDC01-ACCAO

              PERFORM AMCPDC01-SITUCTA
                 THRU AMCPDC01-SITUCTA-EXIT

              MOVE AMCWDC01-NR-ERRO  TO AMCV7301-CTIPSOC-MSG
              MOVE AMCWDC01-STATUS   TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
      *C119891
      *       IF AMCV7300-CPRODSAQ         EQUAL WS-CON-19 AND
      *          ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
              IF AMCV7300-CPRODSAQ         EQUAL WS-CON-19
                 IF  ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
                 AND ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-510
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-161  TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1          TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.
      *
       2108-VALIDA-CONTA-DO-EXIT.
           EXIT.
      ******************************************************************
       2109-VAL-TITULAR-AUT.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2109-VAL-TITULAR-AUT' END-IF.

           MOVE AMCV7301-ZCLIENTE-SOC1   TO CLVT0803-ZCLIENTE.
           MOVE AMCV7300-CBALSAQ         TO CLVT0803-CBALCAO .
           MOVE AMCV7300-CPRODSAQ        TO CLVT0803-CPRODUTO.
           MOVE AMCV7300-CCNTSAQ         TO CLVT0803-CNUMECTA.
           MOVE AMCV7300-CDIGISAQ        TO CLVT0803-CDIGICTA.

           EXEC SQL
                SELECT  CTITULAR
                  INTO :CLVT0803-CTITULAR
                  FROM  CLVT0803_RELCON
                 WHERE  ZCLIENTE = :CLVT0803-ZCLIENTE
                   AND  CPRODUTO = :CLVT0803-CPRODUTO
                   AND  CBALCAO  = :CLVT0803-CBALCAO
                   AND  CNUMECTA = :CLVT0803-CNUMECTA
                   AND  CDIGICTA = :CLVT0803-CDIGICTA
                   AND  DCANCEL  = '9999-12-31'
           END-EXEC.

           MOVE WS-CON-CLVT0803   TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF CLVT0803-OK
                 IF CLVT0803-CTITULAR NOT EQUAL WS-CON-1 AND
                    CLVT0803-CTITULAR NOT EQUAL WS-CON-5
                    IF AMCV7300-CTITULAR-S NOT EQUAL
                                            AMCK0004-AUTORIZ-MAXIMA
                       MOVE ATCK0002-AUTORIZACAO TO ATCL0001-IND-ERROS
                       MOVE AMCK0001-CON-161  TO AMCV7301-CTITULAR-MSG
                       MOVE AMCK0004-AUTORIZ-MAXIMA  TO
                                                 AMCV7301-CTITULAR-S
                    END-IF
                 END-IF
              ELSE
                 IF CLVT0803-NOTFND
                    IF AMCV7300-CTITULAR-S NOT EQUAL
                                            AMCK0004-AUTORIZ-MAXIMA
                       MOVE ATCK0002-AUTORIZACAO TO ATCL0001-IND-ERROS
                       MOVE AMCK0001-CON-161  TO AMCV7301-CTITULAR-MSG
                       MOVE AMCK0004-AUTORIZ-MAXIMA  TO
                                                 AMCV7301-CTITULAR-S
                    END-IF
                 ELSE
                    MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-780    TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-780   TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2109-VAL-TITULAR-AUT-EXIT.
           EXIT.
      ******************************************************************
       2110-VALIDA-ZCLIEMP.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2110-VALIDA-ZCLIEMP' END-IF.

           MOVE AMCV7300-ZCLIEMP  TO WS-ZCLIEMP.
           MOVE WS-ZCLIEMP  TO AMCWCL00-ZCLIENTE.

           PERFORM AMCPCL00-VAL-CLI
              THRU AMCPCL00-VAL-CLI-EXIT.

           MOVE AMCWCL00-NR-ERRO  TO AMCV7301-CTIPSOC-MSG.
           MOVE AMCWCL00-STATUS   TO AMCV7301-CTIPSOC-S.

           IF ATCL0001-SEM-ERROS
              IF CLVT0104-CCLITIPO EQUAL WS-CON-F
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-801      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF CLVT0104-CTIPCLI NOT EQUAL WS-CON-E
      *C123517 - 2021JUN21
      *          MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
      *          MOVE AMCK0001-CON-805      TO AMCV7301-CTIPSOC-MSG
      *          MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 MOVE ZEROS                 TO AMCV7300-ZCLIEMP
                                               AMCV7301-ZCLIEMP
      *ALT04(I)
              ELSE

 ALT05*--        APENAS '777' OU '510' PODEM COLOCAR CONTA AM
 ALT05           IF  (ATCL0001-CBALCAO-OPER EQUAL '777'
   |                 OR
   |                  ATCL0001-CBALCAO-OPER EQUAL '510')
   |                 AND AMCV7300-ZCLIEMP = ZCLIENTE-AM-815837
   |
   |                 IF SW-DEBUG-SIM
   |                    DISPLAY 'ATCL0001-CBALCAO-OPER '
   |                             ATCL0001-CBALCAO-OPER
   |                    DISPLAY 'ZCLIEMP AM!BALCAO NAO VALIDA ACORDO'
   |                    DISPLAY 'AMCV7300-ZCLIEMP =  ' AMCV7300-ZCLIEMP
   |                 END-IF
   |  *
 ALT05           ELSE
      *--           valida se associado possui ACORDO para permitir
      *             pagamento com Conta Empresa
                    INITIALIZE GMCL0013-COMMAREA
                     REPLACING ALPHANUMERIC DATA BY SPACES
                                    NUMERIC DATA BY ZEROES

                    IF SW-DEBUG-SIM
                       SET GMCL0013-DEBUG-SIM
.                                            TO TRUE
                    END-IF

                    SET GMCL0013-CONF-ENTID-ACORDO
                                            TO TRUE
      *
                    MOVE AMCV7300-CPRODUTO  TO GMCL0013-CPRODUTO
                    MOVE AMCV7300-CSUBPROD  TO GMCL0013-CSUBPROD
                    MOVE AMCV7300-ZCLIEMP   TO GMCL0013-ZCLIEMP
      *
                    MOVE AMCV7300-CTIPSOC   TO GMCL0013-CTIPSOC
                    MOVE AMCV7300-ZSOCIO    TO GMCL0013-ZSOCIO
                    MOVE AMCV7300-CDIGISOC  TO GMCL0013-CDIGISOC

                    CALL WS-CON-ROT-GMR00013
                                            USING GMCL0013-COMMAREA

                    IF NOT GMCL0013-SEM-ERROS
                       MOVE GMCL0013-TABLE-NAME
                                            TO ATCL0001-TABLE-NAME
                       MOVE GMCL0013-IND-ERROS
                                            TO ATCL0001-IND-ERROS

                       EVALUATE GMCL0013-NR-ERRO
      *                   (DADOS INSUFICIENTES)
                          WHEN 436
                             MOVE AMCK0001-CON-374
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 1'
      *
      *                   (ERRO NO SELECT DA TABELA AMT10)
                          WHEN 520
                             MOVE AMCK0001-CON-066
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 2'
      *
      *                   (NÃO EXISTE O ASSOCIADO)
                          WHEN 001
                             MOVE AMCK0001-CON-001
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 3'
      *
      *                   (ERRO NO SELECT DE DADOS BASICOS DO CLIENTE)
                          WHEN 086
      *                           AM 211   -  NÃO EXISTE O CLIENTE
                             MOVE AMCK0001-CON-211
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 4'
      *
      *                   (NÃO EXISTE O CLIENTE)
                          WHEN 211
                             MOVE AMCK0001-CON-211
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 5'
      *
      *                   (ENTIDADE PARTICULAR S/ ACORDO)
                          WHEN 437
                             MOVE AMCK0001-CON-375
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 6'
      *
      *                   (ERRO SELECT CMT26)
                          WHEN 424
                             MOVE AMCK0001-CON-362
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 7'
      *
      *                   (ACORDO NÃO EXISTE)
                          WHEN 434
                             MOVE AMCK0001-CON-372
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 8'
      *
      *                   (ACORDO NÃO PERMITIDO)
                          WHEN 433
                             MOVE AMCK0001-CON-371
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 9'
      *
      *                   (ERRO NAO PREVISTO)
                          WHEN OTHER
      *                           AM 320   -  ERRO ACESSO BASE DE DADOS
                             MOVE AMCK0001-CON-320
                                            TO AMCV7301-CTIPSOC-MSG
                             DISPLAY 'ACORDO 10'

                       END-EVALUATE

                       MOVE WS-CON-1        TO AMCV7301-CTIPSOC-S
                    END-IF
 ALT05           END-IF
      *ALT04(F)
              END-IF
           END-IF.
           MOVE CLVT0104-CTIPCLI TO WS-CTIPCLI-ZCLIEMP.
      *
       2110-VALIDA-ZCLIEMP-EXIT.
           EXIT.
      ******************************************************************
       2111-VALIDA-CMT16.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2111-VALIDA-CMT16' END-IF.

           MOVE AMCV7300-CPRODUTO    TO CMVT1600-CPRODUTO.
           MOVE AMCV7300-CSUBPROD    TO CMVT1600-CSUBPROD.
           MOVE AMCV7300-CMOEDA      TO CMVT1600-CMOEDA.
           MOVE AMCV7300-CPLSUBS     TO CMVT1600-CPLSUBS.
           MOVE AMCV7300-TXPROG      TO CMVT1600-TXPROG .
           MOVE SPACES               TO CMVT1600-CPLNENTR.

           IF AMCV7300-CSUBPROD EQUAL ('81' OR '96' OR
                                       'A1' OR 'A6')
              MOVE ZEROS             TO CMVT1600-QPRAZO
           ELSE
              MOVE AMCV7300-QPRAZO   TO CMVT1600-QPRAZO
           END-IF.

           IF AMCV7300-CSUBPROD EQUAL ('93' OR '84' OR '81' OR
                                       'A3' OR 'A4' OR 'A1')
              MOVE ZEROS             TO CMVT1600-IDADRECB
           ELSE
      * ALT02 (I)
      *       MOVE AMCV7300-IDADRECB TO CMVT1600-IDADRECB
              MOVE AMCV7300-QIDRFSOL TO CMVT1600-IDADRECB
      * ALT02 (F)
           END-IF

           MOVE WS-IDADEACT-SOCIO    TO CMVT1600-IDADEACT.

           MOVE ATCL0001-DDIAOP   TO ATCW3000-DATA8
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT.
           MOVE ATCW3000-DATA10   TO  CMVT1600-DATAINI
                                      CMVT1600-DATAFIM.

           MOVE ZEROS TO WS-CONTADOR.
           IF SW-DEBUG-SIM
              DISPLAY 'CPRODUTO ' CMVT1600-CPRODUTO
              DISPLAY 'CSUBPROD ' CMVT1600-CSUBPROD
              DISPLAY 'CMOEDA   ' CMVT1600-CMOEDA
              DISPLAY 'CPLSUBS  ' CMVT1600-CPLSUBS
              DISPLAY 'TXPROG   ' CMVT1600-TXPROG
              DISPLAY 'CPLNENTR ' CMVT1600-CPLNENTR
              DISPLAY 'QPRAZO   ' CMVT1600-QPRAZO
              DISPLAY 'CCOBADIC ' 0
              DISPLAY 'IDADRECB ' CMVT1600-IDADRECB
              DISPLAY 'IDADEACT ' CMVT1600-IDADEACT
              DISPLAY 'QGRAVID  ' 0
              DISPLAY 'DATAINI  ' CMVT1600-DATAINI
              DISPLAY 'DATAFIM  ' CMVT1600-DATAFIM
           END-IF

           EXEC SQL
                SELECT  MINSUB1A
                  INTO :CMVT1600-MINSUB1A
                  FROM  CMVT1600_PLANOSUB
                 WHERE  CPRODUTO = :CMVT1600-CPRODUTO
                   AND  CSUBPROD = :CMVT1600-CSUBPROD
                   AND  CMOEDA   = :CMVT1600-CMOEDA
                   AND  CPLSUBS  = :CMVT1600-CPLSUBS
                   AND  TXPROG   = :CMVT1600-TXPROG
                   AND  CPLNENTR = :CMVT1600-CPLNENTR
                   AND  QPRAZO   = :CMVT1600-QPRAZO
                   AND  CCOBADIC = 0
                   AND  IDADRECB = :CMVT1600-IDADRECB
                   AND  IDADEACT = :CMVT1600-IDADEACT
                   AND  QGRAVID  = 0
                   AND  DATAINI <= :CMVT1600-DATAINI
                   AND  DATAFIM >= :CMVT1600-DATAFIM
           END-EXEC.

           MOVE WS-CON-CMVT1600 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF CMVT1600-OK
                 CONTINUE
              ELSE
                 IF CMVT1600-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-733      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 ELSE
                    IF NOT CMVT1600-NOTFND
                       MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                       MOVE AMCK0001-CON-668    TO AMCV7301-CTIPSOC-MSG
                       MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
                    END-IF
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-668      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2111-VALIDA-CMT16-EXIT.
           EXIT.
      ******************************************************************
       2112-VAL-QPRAZO-IDADRECB.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2112-VAL-QPRAZO-IDADRECB' END-IF.

           MOVE AMCV7300-CPRODUTO  TO CMVT1500-CPRODUTO.
           MOVE AMCV7300-CSUBPROD  TO CMVT1500-CSUBPROD.
           MOVE AMCV7300-CMOEDA    TO CMVT1500-CMOEDA.

           EXEC SQL
                SELECT  IDADEREC,
                        PRZRECEB
                  INTO :CMVT1500-IDADEREC,
                       :CMVT1500-PRZRECEB
                  FROM  CMVT1500_IDADES
                 WHERE  CPRODUTO = :CMVT1500-CPRODUTO
                   AND  CSUBPROD = :CMVT1500-CSUBPROD
                   AND  CMOEDA   = :CMVT1500-CMOEDA
                   AND  IDADEREC = :CMVT1500-IDADEREC
                   AND  PRZRECEB = :CMVT1500-PRZRECEB
           END-EXEC.

           MOVE WS-CON-CMVT1500 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT CMVT1500-OK
                 IF CMVT1500-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-743      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-664      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-664      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2112-VAL-QPRAZO-IDADRECB-EXIT.
           EXIT.
      ******************************************************************
       2113-VALIDA-CLIENTE-BEN.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2113-VALIDA-CLIENTE-BEN' END-IF.

           MOVE AMCV7300-ZCLIENTE-BEN TO AMCWCL00-ZCLIENTE.

accdc      PERFORM AMCPGM00-VAL-CLI
accdc         THRU AMCPGM00-VAL-CLI-EXIT.

           MOVE AMCWCL00-NR-ERRO  TO AMCV7301-CTIPSOC-MSG.
           MOVE AMCWCL00-STATUS   TO AMCV7301-CTIPSOC-S.

           IF ATCL0001-SEM-ERROS
              IF GMVT1000-CCLITIPO EQUAL WS-CON-F
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-801      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF GMVT1000-CTIPCLI NOT EQUAL WS-CON-P
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-802      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE GMVT1000-NOMER           TO AMCV7301-GTITULO-BEN
           END-IF.
      *
       2113-VALIDA-CLIENTE-BEN-EXIT.
           EXIT.
      ******************************************************************
       2114-OBTEM-COMPLEM-BEN.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2114-OBTEM-COMPLEM-BEN' END-IF.

           MOVE AMCV7300-ZCLIENTE-BEN TO GMVT1100-ZCLIENTE.

           EXEC SQL
                SELECT  DNASCIME
                  INTO :GMVT1100-DNASCIME
                  FROM  GMVT1100_COMPPART
                 WHERE  ZCLIENTE = :GMVT1100-ZCLIENTE
           END-EXEC.

           MOVE WS-CON-GMVT1100 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF GMVT1100-OK
                 IF GMVT1100-DNASCIME EQUAL WS-CON-0001-01-01
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-081    TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE GMVT1100-DNASCIME TO ATCW3000-DATA10
                    PERFORM ATCP3000-CONV-DATA108
                       THRU ATCP3000-CONV-DATA108-EXIT
                    MOVE ATCW3000-DATA8    TO AMCV7301-DNASCIM-BEN
                 END-IF
              ELSE
                 IF GMVT1100-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-762   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-761   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-761      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2114-OBTEM-COMPLEM-BEN-EXIT.
           EXIT.
      ******************************************************************
       2115-CALCULA-IDADES-1.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2115-CALCULA-IDADES-1' END-IF.

           MOVE AMCV7300-QAGRAVID     TO AMCW1000-QAGRAVID.

           MOVE AMCV7301-DNASCIM-SOC1 TO AMCW1000-DINICIO.
           MOVE AMCV7300-DCONTD       TO AMCW1000-DCONTD.
           MOVE AMCV7300-DCONTD       TO AMCW1000-DCALC.
           MOVE WS-CON-N              TO AMCW1000-CTPDATA.

           PERFORM AMCP1000
              THRU AMCP1000-EXIT.

           MOVE AMCW1000-IDADEACT     TO WS-IDADEACT-SOCIO.
           MOVE AMCW1000-IDADETET     TO WS-IDADETET-SOCIO.
           MOVE AMCW1000-IDADETET     TO AMCV7301-IDADESOC.

           IF ATCL0001-SEM-ERROS
              PERFORM 21155-CALCUL-IDADE-NO-DIA
                 THRU 21155-CALCUL-IDADE-NO-DIA-EXIT
           END-IF.

       2115-CALCULA-IDADES-1-EXIT.
           EXIT.

      *----------------------------------------------------------------*
       21155-CALCUL-IDADE-NO-DIA.
      *----------------------------------------------------------------*
           IF SW-DEBUG-SIM
              DISPLAY '21155-CALCUL-IDADE-NO-DIA'
           END-IF.

           MOVE AMCV7300-QAGRAVID     TO AMCW1000-QAGRAVID.
           MOVE AMCV7301-DNASCIM-SOC1 TO AMCW1000-DINICIO.
           MOVE ATCL0001-DDIAOP       TO AMCW1000-DCONTD.
           MOVE ATCL0001-DDIAOP       TO AMCW1000-DCALC.
           MOVE WS-CON-N              TO AMCW1000-CTPDATA.

           PERFORM AMCP1000
              THRU AMCP1000-EXIT.

           MOVE AMCW1000-IDADEACT     TO WS-IDADEACT-SOCIO-DIA.
           MOVE AMCW1000-IDADETET     TO WS-IDADETET-SOCIO-DIA.

       21155-CALCUL-IDADE-NO-DIA-EXIT.
           EXIT.

      * ALT02 (I)
      ******************************************************************
       2115-CALC-IACT-DTVENCIM.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2115-CALC-IACT-DTVENCIM' END-IF.
      *
           IF AMCV7301-CSUBPROD EQUAL (WS-CON-96 OR WS-CON-A6)
              MOVE ZEROS              TO AMCW1000-QAGRAVID
           ELSE
              MOVE AMCV7300-QAGRAVID  TO AMCW1000-QAGRAVID
           END-IF.
           MOVE WS-DATA8-DTVENCIM     TO AMCW1000-DCONTD.
           MOVE WS-DATA8-DTVENCIM     TO AMCW1000-DCALC.
           MOVE WS-CON-N              TO AMCW1000-CTPDATA.

           PERFORM AMCP1000
              THRU AMCP1000-EXIT.

           MOVE AMCW1000-IDADEACT     TO WS-IDADEACT-DTVENCIM.
      *
       2115-CALC-IACT-DTVENCIM-EXIT.
           EXIT.
      * ALT02 (F)
      ******************************************************************
       2116-CALCULA-IDADES-BEN.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2116-CALCULA-IDADES-BEN' END-IF.

      * ALT01 (I)
      *    MOVE AMCV7300-QAGRAVID     TO AMCW1000-QAGRAVID.
           MOVE ZEROS                 TO AMCW1000-QAGRAVID.
      * ALT01 (F)

           MOVE AMCV7301-DNASCIM-BEN  TO AMCW1000-DINICIO.
           MOVE AMCV7300-DCONTD       TO AMCW1000-DCONTD.
           MOVE AMCV7300-DCONTD       TO AMCW1000-DCALC.
           MOVE WS-CON-N              TO AMCW1000-CTPDATA.

           PERFORM AMCP1000
              THRU AMCP1000-EXIT.

           MOVE AMCW1000-IDADEACT     TO WS-IDADEACT-BEN.
      *
       2116-CALCULA-IDADES-BEN-EXIT.
           EXIT.
      ******************************************************************
       2117-VALIDA-CMT03-CTI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2117-VALIDA-CMT03-CTI' END-IF.

           MOVE WS-CON-74         TO CMCW0100-CPRODUTO.
      *    MOVE WS-CON-89         TO CMCW0100-CSUBPROD.
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9    TO CMCW0100-CSUBPROD
           ELSE
              MOVE WS-CON-89    TO CMCW0100-CSUBPROD
           END-IF

           MOVE AMCV7300-CMOEDA   TO CMCW0100-CMOEDA.

           MOVE AMCV7300-DCONTD   TO CMCW0100-DATAINI.

           PERFORM 9999-VALIDA-PRODUTO
              THRU 9999-VALIDA-PRODUTO-EXIT.

           MOVE CMCW0100-SQLCODE  TO ATCW0005-SQLCODE.

           IF ATCL0001-SEM-ERROS
              IF CMVT0300-OK
                 IF CMVT0300-INDPRDAT NOT EQUAL WS-CON-S
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-749      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 IF CMVT0300-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-712   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-616   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-616 TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCV7300-QAGRAVID NOT EQUAL ZEROS AND
                 CMVT0300-INDAIDAD EQUAL WS-CON-N
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-941   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE CMVT0300-MMULTSUB           TO WS-MMULTSUB-CTI
              MOVE CMVT0300-INDSUBMT           TO WS-INDSUBMT-CTI
              MOVE CMVT0300-MULTSUBC           TO WS-MULTSUBC-CTI
              MOVE CMVT0300-PRAZOMIN           TO WS-PRAZOMIN-CTI
              MOVE CMVT0300-PRAZOMAX           TO WS-PRAZOMAX-CTI
              MOVE CMVT0300-CPLREM             TO WS-CPLREM-CTI
           END-IF.
      *
       2117-VALIDA-CMT03-CTI-EXIT.
           EXIT.
      ******************************************************************
       2118-PRAZO-RECEB.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2118-PRAZO-RECEB' END-IF.

           IF AMCV7300-CSUBPROD EQUAL (WS-CON-81 OR WS-CON-A1)
              MOVE WS-CON-N999       TO WS-QPRAZO-MAE
                                        WS-IDADRECB-MAE
              MOVE WS-CON-9999-12-31 TO WS-DFIMCOBQ-MAE
                                        WS-DTVENCIM-MAE

              IF AMCV7300-ICTI EQUAL WS-CON-1
                 IF AMCV7300-QPRAZO-CTI NOT EQUAL ZEROS
                    MOVE AMCV7300-DCONTD     TO WS-DATA8-CTI
                    ADD  AMCV7300-QPRAZO-CTI TO WS-DATA8-CTI-ANO
                 ELSE
                    MOVE WS-CON-99991231     TO WS-DATA8-CTI
                 END-IF

                 IF AMCV7300-INDSBPRO-CTI EQUAL WS-CON-1
                    COMPUTE WS-QPRAZO-CTI =
                            WS-CON-N65 - WS-IDADEACT-SOCIO
                    MOVE AMCV7301-DNASCIM-SOC1 TO WS-DTLIMITE-CTI
                    ADD  WS-CON-N65            TO WS-DTLIMITE-CTI-ANO
                 ELSE
                    COMPUTE WS-QPRAZO-CTI =
                            WS-CON-N65 - WS-IDADEACT-SOCIO
                    MOVE AMCV7301-DNASCIM-SOC1 TO WS-DTLIMITE-CTI
                    ADD  WS-CON-N65            TO WS-DTLIMITE-CTI-ANO
                 END-IF

                 IF WS-DTLIMITE-CTI LESS WS-DATA8-CTI
                    MOVE WS-DTLIMITE-CTI     TO WS-DATA8-CTI
                 ELSE
                    MOVE AMCV7300-QPRAZO-CTI TO WS-QPRAZO-CTI
                 END-IF

                 MOVE WS-DATA8-CTI        TO ATCW3000-DATA8
                 PERFORM ATCP6000-CONV-DATA810
                    THRU ATCP6000-CONV-DATA810-EXIT
                 MOVE ATCW3000-DATA10     TO WS-DTVENCIM-CTI
                                             WS-DFIMCOBQ-CTI
                 MOVE WS-DATA8-CTI        TO WS-DATA-AAAAMMDD
                 PERFORM 9100-OBTEM-ULTDIA-MES
                    THRU 9199-OBTEM-ULTDIA-MES-EXIT
                 MOVE SYCL0200-DAT-RES-ED TO WS-DFIMCOBQ-CTI
              END-IF
           END-IF.

           IF AMCV7300-CSUBPROD EQUAL (WS-CON-84 OR WS-CON-A4)
              MOVE AMCV7300-QPRAZO     TO WS-QPRAZO-MAE

              MOVE WS-CON-N999         TO WS-IDADRECB-MAE

              MOVE AMCV7300-DCONTD     TO WS-DATA8-MAE
              ADD  AMCV7300-QPRAZO     TO WS-DATA8-MAE-ANO

              MOVE WS-DATA8-MAE        TO ATCW3000-DATA8
              PERFORM ATCP6000-CONV-DATA810
                 THRU ATCP6000-CONV-DATA810-EXIT
              MOVE ATCW3000-DATA10     TO WS-DFIMCOBQ-MAE
                                          WS-DTVENCIM-MAE
              MOVE WS-DATA8-MAE        TO WS-DATA-AAAAMMDD
              PERFORM 9200-OBTEM-ULTDIA-MESANT
                 THRU 9299-OBTEM-ULTDIA-MESANT-EXIT
              MOVE SYCL0200-DAT-RES-ED TO WS-DFIMCOBQ-MAE

              IF AMCV7300-ICTI EQUAL WS-CON-1
                 IF AMCV7300-QPRAZO-CTI NOT EQUAL ZEROS
                    MOVE AMCV7300-DCONTD     TO WS-DATA8-CTI
                    ADD  AMCV7300-QPRAZO-CTI TO WS-DATA8-CTI-ANO
                 ELSE
                    MOVE WS-CON-99991231     TO WS-DATA8-CTI
                 END-IF

                 IF AMCV7300-INDSBPRO-CTI EQUAL WS-CON-1
                    COMPUTE WS-QPRAZO-CTI =
                            WS-CON-N65 - WS-IDADEACT-SOCIO
                    MOVE AMCV7301-DNASCIM-SOC1 TO WS-DTLIMITE-CTI
                    ADD  WS-CON-N65            TO WS-DTLIMITE-CTI-ANO
                 ELSE
                    COMPUTE WS-QPRAZO-CTI =
                            WS-CON-N65 - WS-IDADEACT-SOCIO
                    MOVE AMCV7301-DNASCIM-SOC1 TO WS-DTLIMITE-CTI
                    ADD  WS-CON-N65            TO WS-DTLIMITE-CTI-ANO
                 END-IF

                 IF WS-DTLIMITE-CTI LESS WS-DATA8-CTI
                    MOVE WS-DTLIMITE-CTI     TO WS-DATA8-CTI
                 ELSE
                    MOVE AMCV7300-QPRAZO-CTI TO WS-QPRAZO-CTI
                 END-IF

                 IF WS-DATA8-CTI LESS WS-DATA8-MAE
                    MOVE WS-DATA8-CTI        TO ATCW3000-DATA8
                    PERFORM ATCP6000-CONV-DATA810
                       THRU ATCP6000-CONV-DATA810-EXIT
                    MOVE ATCW3000-DATA10     TO WS-DTVENCIM-CTI
                                                WS-DFIMCOBQ-CTI
                    MOVE WS-DATA8-CTI        TO WS-DATA-AAAAMMDD
                    PERFORM 9100-OBTEM-ULTDIA-MES
                       THRU 9199-OBTEM-ULTDIA-MES-EXIT
                    MOVE SYCL0200-DAT-RES-ED TO WS-DFIMCOBQ-CTI
                 ELSE
                    MOVE WS-QPRAZO-MAE       TO WS-QPRAZO-CTI
                    MOVE WS-DTVENCIM-MAE     TO WS-DTVENCIM-CTI
                    MOVE WS-DFIMCOBQ-MAE     TO WS-DFIMCOBQ-CTI
                 END-IF
              END-IF
           END-IF.

           IF AMCV7300-CSUBPROD EQUAL WS-CON-83
           OR AMCV7300-CSUBPROD EQUAL WS-CON-93
           OR AMCV7300-CSUBPROD EQUAL WS-CON-A3
              MOVE AMCV7301-DNASCIM-SOC1  TO WS-DATA8-MAE

      * ALT02 (I)
      *       MOVE AMCV7300-IDADRECB   TO WS-IDADRECB-MAE
      *                                   WS-IDADRECB-CS
      *
      *       MOVE AMCV7300-IDADRECB   TO WS-NUM-PRAZO
              MOVE AMCV7300-QIDRFSOL   TO WS-IDADRECB-MAE
                                          WS-IDADRECB-CS
                                          WS-NUM-PRAZO
      * ALT02 (F)
              MOVE WS-DATA8-MAE        TO WS-DATA-AAAAMMDD
              PERFORM 6300-OBTEM-IDADRECB
                 THRU 6399-OBTEM-IDADRECB-EXIT
              MOVE SYCL0200-DAT-RES    TO WS-DATA8-RECB
      *
              MOVE WS-DATA8-RECB       TO WS-DATA-AAAAMMDD
              PERFORM 6400-OBTEM-IDADRECB
                 THRU 6499-OBTEM-IDADRECB-EXIT
              MOVE SYCL0200-DAT-RES    TO WS-DATA8-ACTU
      *
              MOVE AMCV7300-DCONTD     TO WS-DATA-AAAAMMDD
              COMPUTE WS-QPRAZO-MAE = WS-DATA8-ACTU-ANO
                                    - WS-DATA-AAAAMMDD-ANO
              MOVE WS-QPRAZO-MAE       TO WS-QPRAZO-CS
      *
              MOVE WS-QPRAZO-MAE         TO WS-NUM-PRAZO
              MOVE AMCV7300-DCONTD       TO WS-DATA-AAAAMMDD
              PERFORM 6300-OBTEM-IDADRECB
                 THRU 6399-OBTEM-IDADRECB-EXIT
              MOVE SYCL0200-DAT-RES      TO WS-DATA8-DTVENCIM
      *
              MOVE WS-DATA8-DTVENCIM     TO WS-DATA8-MAE
                                            ATCW3000-DATA8
              PERFORM ATCP6000-CONV-DATA810
                 THRU ATCP6000-CONV-DATA810-EXIT
              MOVE ATCW3000-DATA10       TO WS-DTVENCIM-MAE
                                            WS-DTVENCIM-CS
      * ALT02 (I)
              PERFORM 2115-CALC-IACT-DTVENCIM
                 THRU 2115-CALC-IACT-DTVENCIM-EXIT
              MOVE WS-IDADEACT-DTVENCIM TO CMVT1500-IDADEREC
              MOVE WS-CON-000           TO CMVT1500-PRZRECEB
              PERFORM 2112-VAL-QPRAZO-IDADRECB
                 THRU 2112-VAL-QPRAZO-IDADRECB-EXIT
      * ALT02 (F)
              IF ATCL0001-SEM-ERROS
                 MOVE WS-DATA8-MAE          TO WS-DATA-AAAAMMDD
                 PERFORM 6200-OBTEM-ULTDIA-MESANT
                    THRU 6299-OBTEM-ULTDIA-MESANT-EXIT
                 MOVE SYCL0200-DAT-RES-ED   TO WS-DFIMCOBQ-MAE
                                               WS-DFIMCOBQ-CS
                 IF SW-DEBUG-SIM
                    DISPLAY 'WS-QPRAZO-MAE   ' WS-QPRAZO-MAE
                    DISPLAY 'WS-QPRAZO-CS    ' WS-QPRAZO-CS
                 END-IF

                 IF AMCV7300-ICTI EQUAL WS-CON-1
                    IF AMCV7300-QPRAZO-CTI NOT EQUAL ZEROS
                       MOVE AMCV7300-DCONTD     TO WS-DATA8-CTI
                       ADD  AMCV7300-QPRAZO-CTI TO WS-DATA8-CTI-ANO
                    ELSE
                       MOVE WS-CON-99991231     TO WS-DATA8-CTI
                    END-IF

                    IF AMCV7300-INDSBPRO-CTI EQUAL WS-CON-1
                       COMPUTE WS-QPRAZO-CTI =
                               WS-CON-N65 - WS-IDADEACT-SOCIO
                       MOVE AMCV7301-DNASCIM-SOC1 TO WS-DTLIMITE-CTI
                       ADD  WS-CON-N65            TO WS-DTLIMITE-CTI-ANO
                    ELSE
                       COMPUTE WS-QPRAZO-CTI =
                               WS-CON-N65 - WS-IDADEACT-SOCIO
                       MOVE AMCV7301-DNASCIM-SOC1 TO WS-DTLIMITE-CTI
                       ADD  WS-CON-N65            TO WS-DTLIMITE-CTI-ANO
                    END-IF

                    IF WS-DTLIMITE-CTI LESS WS-DATA8-CTI
                       MOVE WS-DTLIMITE-CTI     TO WS-DATA8-CTI
                    ELSE
                       MOVE AMCV7300-QPRAZO-CTI TO WS-QPRAZO-CTI
                    END-IF

                    IF WS-DATA8-CTI LESS WS-DATA8-MAE
                       MOVE WS-DATA8-CTI        TO ATCW3000-DATA8
                       PERFORM ATCP6000-CONV-DATA810
                          THRU ATCP6000-CONV-DATA810-EXIT
                       MOVE ATCW3000-DATA10     TO WS-DTVENCIM-CTI
                                                   WS-DFIMCOBQ-CTI
                       MOVE WS-DATA8-CTI        TO WS-DATA-AAAAMMDD
                       PERFORM 9100-OBTEM-ULTDIA-MES
                          THRU 9199-OBTEM-ULTDIA-MES-EXIT
                       MOVE SYCL0200-DAT-RES-ED TO WS-DFIMCOBQ-CTI
                    ELSE
                       MOVE WS-QPRAZO-MAE       TO WS-QPRAZO-CTI
                       MOVE WS-DTVENCIM-MAE     TO WS-DTVENCIM-CTI
                       MOVE WS-DFIMCOBQ-MAE     TO WS-DFIMCOBQ-CTI
                    END-IF
                 END-IF

                 IF AMCV7300-ICS      EQUAL WS-CON-1 AND
                   (AMCV7300-CSUBPROD EQUAL WS-CON-83 OR
                    AMCV7300-CSUBPROD EQUAL WS-CON-93 OR
                    AMCV7300-CSUBPROD EQUAL WS-CON-A3)
                    ADD WS-CON-N5          TO WS-DATA8-MAE-ANO
                                              WS-QPRAZO-CS
                    MOVE WS-DATA8-MAE      TO ATCW3000-DATA8
                    PERFORM ATCP6000-CONV-DATA810
                       THRU ATCP6000-CONV-DATA810-EXIT
                    MOVE ATCW3000-DATA10   TO WS-DTVENCIM-CS
                 END-IF
              END-IF
           END-IF.

           IF AMCV7300-CSUBPROD EQUAL (WS-CON-96 OR WS-CON-A6)
              MOVE AMCV7301-DNASCIM-BEN   TO WS-DATA8-MAE
      * ALT02 (I)
      *       MOVE AMCV7300-IDADRECB   TO WS-IDADRECB-MAE
      *
      *       MOVE AMCV7300-IDADRECB   TO WS-NUM-PRAZO
              MOVE AMCV7300-QIDRFSOL   TO WS-IDADRECB-MAE
                                          WS-NUM-PRAZO
      * ALT02 (F)
              MOVE WS-DATA8-MAE        TO WS-DATA-AAAAMMDD
              PERFORM 6300-OBTEM-IDADRECB
                 THRU 6399-OBTEM-IDADRECB-EXIT
              MOVE SYCL0200-DAT-RES    TO WS-DATA8-RECB
      *
              MOVE WS-DATA8-RECB       TO WS-DATA-AAAAMMDD
              PERFORM 6400-OBTEM-IDADRECB
                 THRU 6499-OBTEM-IDADRECB-EXIT
              MOVE SYCL0200-DAT-RES    TO WS-DATA8-ACTU
      *
              MOVE AMCV7300-DCONTD     TO WS-DATA-AAAAMMDD
              COMPUTE WS-QPRAZO-MAE = WS-DATA8-ACTU-ANO
                                    - WS-DATA-AAAAMMDD-ANO
              IF SW-DEBUG-SIM
                 DISPLAY 'WS-QPRAZO-MAE 1 ' WS-QPRAZO-MAE
              END-IF
      *
              MOVE WS-QPRAZO-MAE         TO WS-NUM-PRAZO
              MOVE AMCV7300-DCONTD       TO WS-DATA-AAAAMMDD
              PERFORM 6300-OBTEM-IDADRECB
                 THRU 6399-OBTEM-IDADRECB-EXIT
              MOVE SYCL0200-DAT-RES      TO WS-DATA8-DTVENCIM
      *
              MOVE WS-DATA8-DTVENCIM     TO WS-DATA8-MAE
                                            ATCW3000-DATA8
              PERFORM ATCP6000-CONV-DATA810
                 THRU ATCP6000-CONV-DATA810-EXIT
              MOVE ATCW3000-DATA10       TO WS-DTVENCIM-MAE
      * ALT02 (I)
              PERFORM 2115-CALC-IACT-DTVENCIM
                 THRU 2115-CALC-IACT-DTVENCIM-EXIT
      * ALT02 (F)
              MOVE WS-DATA8-MAE          TO WS-DATA-AAAAMMDD
              PERFORM 6200-OBTEM-ULTDIA-MESANT
                 THRU 6299-OBTEM-ULTDIA-MESANT-EXIT
              MOVE SYCL0200-DAT-RES-ED   TO WS-DFIMCOBQ-MAE
              IF SW-DEBUG-SIM
                 DISPLAY 'WS-QPRAZO-MAE 2 ' WS-QPRAZO-MAE
              END-IF

              IF AMCV7300-ICTI EQUAL WS-CON-1
                 IF AMCV7300-QPRAZO-CTI NOT EQUAL ZEROS
                    MOVE AMCV7300-DCONTD     TO WS-DATA8-CTI
                    ADD  AMCV7300-QPRAZO-CTI TO WS-DATA8-CTI-ANO
                 ELSE
                    MOVE WS-CON-99991231     TO WS-DATA8-CTI
                 END-IF

                 IF AMCV7300-INDSBPRO-CTI EQUAL WS-CON-1
                    COMPUTE WS-QPRAZO-CTI =
                            WS-CON-N65 - WS-IDADEACT-SOCIO
                    MOVE AMCV7301-DNASCIM-SOC1 TO WS-DTLIMITE-CTI
                    ADD  WS-CON-N65            TO WS-DTLIMITE-CTI-ANO
                 ELSE
                    COMPUTE WS-QPRAZO-CTI =
                            WS-CON-N65 - WS-IDADEACT-SOCIO
                    MOVE AMCV7301-DNASCIM-SOC1 TO WS-DTLIMITE-CTI
                    ADD  WS-CON-N65            TO WS-DTLIMITE-CTI-ANO
                 END-IF

                 IF WS-DTLIMITE-CTI LESS WS-DATA8-CTI
                    MOVE WS-DTLIMITE-CTI     TO WS-DATA8-CTI
                 ELSE
                    MOVE AMCV7300-QPRAZO-CTI TO WS-QPRAZO-CTI
                 END-IF

                 IF WS-DATA8-CTI LESS WS-DATA8-MAE
                    MOVE WS-DATA8-CTI        TO ATCW3000-DATA8
                    PERFORM ATCP6000-CONV-DATA810
                       THRU ATCP6000-CONV-DATA810-EXIT
                    MOVE ATCW3000-DATA10     TO WS-DTVENCIM-CTI
                                                WS-DFIMCOBQ-CTI
                    MOVE WS-DATA8-CTI        TO WS-DATA-AAAAMMDD
                    PERFORM 9100-OBTEM-ULTDIA-MES
                       THRU 9199-OBTEM-ULTDIA-MES-EXIT
                    MOVE SYCL0200-DAT-RES-ED TO WS-DFIMCOBQ-CTI
                 ELSE
                    MOVE WS-QPRAZO-MAE       TO WS-QPRAZO-CTI
                    MOVE WS-DTVENCIM-MAE     TO WS-DTVENCIM-CTI
                    MOVE WS-DFIMCOBQ-MAE     TO WS-DFIMCOBQ-CTI
                 END-IF
              END-IF
           END-IF.
      *
       2118-PRAZO-RECEB-EXIT.
           EXIT.
      ******************************************************************
       2119-VALIDA-CMT03-CS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2119-VALIDA-CMT03-CS' END-IF.

           MOVE WS-CON-74         TO CMCW0100-CPRODUTO.
      *    MOVE WS-CON-91         TO CMCW0100-CSUBPROD.
           IF AMCV7301-CSUBPROD = 'A3'
              MOVE WS-CON-A0    TO CMCW0100-CSUBPROD
           ELSE
              MOVE WS-CON-91    TO CMCW0100-CSUBPROD
           END-IF

           MOVE AMCV7300-CMOEDA   TO CMCW0100-CMOEDA.

           MOVE AMCV7300-DCONTD   TO CMCW0100-DATAINI.

           PERFORM 9999-VALIDA-PRODUTO
              THRU 9999-VALIDA-PRODUTO-EXIT.

           MOVE CMCW0100-SQLCODE  TO ATCW0005-SQLCODE.

           IF ATCL0001-SEM-ERROS
              IF CMVT0300-OK
                 IF CMVT0300-INDPRDAT NOT EQUAL WS-CON-S
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-749      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 IF CMVT0300-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-712   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-616   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-616 TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE CMVT0300-MMULTSUB           TO WS-MMULTSUB-CS
              MOVE CMVT0300-INDSUBMT           TO WS-INDSUBMT-CS
              MOVE CMVT0300-MULTSUBC           TO WS-MULTSUBC-CS
              MOVE CMVT0300-PRAZOMIN           TO WS-PRAZOMIN-CS
              MOVE CMVT0300-PRAZOMAX           TO WS-PRAZOMAX-CS
              MOVE CMVT0300-CPLREM             TO WS-CPLREM-CS

              SET CONTROLA-AVISO   TO TRUE
           END-IF.
      *
       2119-VALIDA-CMT03-CS-EXIT.
           EXIT.
      ******************************************************************
       2120-VAL-LIMIDADES.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2120-VAL-LIMIDADES' END-IF.

           MOVE AMCV7300-CPRODUTO              TO CMVT1400-CPRODUTO.
           MOVE AMCV7300-CSUBPROD              TO CMVT1400-CSUBPROD.
           MOVE AMCV7300-CMOEDA                TO CMVT1400-CMOEDA.
           MOVE WS-CON-I                       TO CMVT1400-INDOPER.
           MOVE WS-CON-A                       TO CMVT1400-TPIDADE.
           MOVE WS-CON-A                       TO CMVT1400-TPINTERV.
           MOVE WS-QPRAZO-MAE                  TO WS-QPRAZO-N.
           MOVE WS-QPRAZO-N                    TO CMVT1400-CPRAZMIN.
           MOVE WS-QPRAZO-N                    TO CMVT1400-CPRAZMAX.

           EXEC SQL
                SELECT  IDADEMAX    ,
                        IDADEMIN    ,
                        IDADPRAZ    ,
                        DIFMAXSB
                  INTO :CMVT1400-IDADEMAX   ,
                       :CMVT1400-IDADEMIN   ,
                       :CMVT1400-IDADPRAZ   ,
                       :CMVT1400-DIFMAXSB
                  FROM  CMVT1400_LIMIDADE
                 WHERE  CPRODUTO  = :CMVT1400-CPRODUTO
                   AND  CSUBPROD  = :CMVT1400-CSUBPROD
                   AND  CMOEDA    = :CMVT1400-CMOEDA
                   AND  INDOPER   = :CMVT1400-INDOPER
                   AND  TPIDADE   = :CMVT1400-TPIDADE
                   AND  TPINTERV  = :CMVT1400-TPINTERV
                   AND  CPRAZMIN <= :CMVT1400-CPRAZMIN
                   AND  CPRAZMAX >= :CMVT1400-CPRAZMAX
           END-EXEC.

           MOVE WS-CON-CMVT1400 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF CMVT1400-OK
                 PERFORM 2120-VAL-PARAMETROS
                    THRU 2120-VAL-PARAMETROS-EXIT
              ELSE
                IF CMVT1400-NOTFND
                   MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-998      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                ELSE
                   MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-660      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-660      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2120-VAL-LIMIDADES-EXIT.
           EXIT.
      ******************************************************************
       2120-VAL-PARAMETROS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2120-VAL-PARAMETROS' END-IF.

           IF WS-IDADEACT-SOCIO > CMVT1400-IDADEMAX
              IF AMCV7300-CLIBERAC EQUAL WS-CON-1  AND
                (AMCV7300-CSUBPROD EQUAL WS-CON-84 OR
                 AMCV7300-CSUBPROD EQUAL WS-CON-A4 OR
                 AMCV7300-CSUBPROD EQUAL WS-CON-96 OR
                 AMCV7300-CSUBPROD EQUAL WS-CON-A6)
                 CONTINUE
              ELSE
                 IF ATCL0001-CBALCAO-OPER EQUAL WS-CON-777 AND
      *          NÃO VALIDAR P '510'
                    AMCV7300-CLIBERAC EQUAL WS-CON-1
                    IF AMCV7300-IDADEACT-S NOT EQUAL
                                           AMCK0004-AUTORIZ-NIVEL-4
                       MOVE ATCK0002-AUTORIZACAO   TO
                                                   ATCL0001-IND-ERROS
                       MOVE AMCK0001-CON-999       TO
                                                   AMCV7301-IDADEACT-MSG
                       MOVE AMCK0004-AUTORIZ-NIVEL-4 TO
                                                     AMCV7301-IDADEACT-S
                    END-IF
                 ELSE
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-999      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.

           IF WS-IDADEACT-SOCIO < CMVT1400-IDADEMIN
              IF AMCV7300-CLIBERAC EQUAL WS-CON-1  AND
                 AMCV7300-CSUBPROD EQUAL (WS-CON-84 OR WS-CON-A4)
                 CONTINUE
              ELSE
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-030      TO AMCV7301-ZSOCIO-MSG
                 MOVE WS-CON-1              TO AMCV7301-ZSOCIO-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              WS-QPRAZO-N NOT EQUAL WS-CON-N999
              COMPUTE WS-VAR-AUX = WS-IDADEACT-SOCIO + WS-QPRAZO-N
              IF WS-VAR-AUX > CMVT1400-IDADPRAZ
                 IF ATCL0001-CBALCAO-OPER EQUAL WS-CON-777 AND
      *          NÃO VALIDAR P '510'
                    AMCV7300-CLIBERAC  EQUAL WS-CON-1 AND
                    (AMCV7300-CSUBPROD EQUAL WS-CON-84 OR
                     AMCV7300-CSUBPROD EQUAL WS-CON-A4 OR
                     AMCV7300-CSUBPROD EQUAL WS-CON-96 OR
                     AMCV7300-CSUBPROD EQUAL WS-CON-A6)
                    IF AMCV7300-IDADPRAZ-S NOT EQUAL
                                              AMCK0004-AUTORIZ-NIVEL-4
                       MOVE ATCK0002-AUTORIZACAO TO ATCL0001-IND-ERROS
                       MOVE AMCK0001-CON-999  TO AMCV7301-IDADPRAZ-MSG
                       MOVE AMCK0004-AUTORIZ-NIVEL-4
                                              TO AMCV7301-IDADPRAZ-S
                    END-IF
                 ELSE
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-999      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.
      *
       2120-VAL-PARAMETROS-EXIT.
           EXIT.
      ******************************************************************
       2121-VAL-LIMIDADES-BEN.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2121-VAL-LIMIDADES-BEN' END-IF.

           MOVE AMCV7300-CPRODUTO              TO CMVT1400-CPRODUTO.
           MOVE AMCV7300-CSUBPROD              TO CMVT1400-CSUBPROD.
           MOVE AMCV7300-CMOEDA                TO CMVT1400-CMOEDA.
           MOVE WS-CON-I                       TO CMVT1400-INDOPER.
           MOVE WS-CON-A                       TO CMVT1400-TPIDADE.
           IF AMCV7300-CSUBPROD EQUAL (WS-CON-96 OR WS-CON-A6)
              MOVE WS-CON-C                    TO CMVT1400-TPIDADE
           END-IF.
           MOVE WS-CON-B                       TO CMVT1400-TPINTERV.
           MOVE WS-QPRAZO-MAE                  TO WS-QPRAZO-N.
           MOVE WS-QPRAZO-N                    TO CMVT1400-CPRAZMIN.
           MOVE WS-QPRAZO-N                    TO CMVT1400-CPRAZMAX.

           EXEC SQL
                SELECT  IDADEMAX    ,
                        IDADEMIN    ,
                        IDADPRAZ    ,
                        DIFMAXSB
                  INTO :CMVT1400-IDADEMAX   ,
                       :CMVT1400-IDADEMIN   ,
                       :CMVT1400-IDADPRAZ   ,
                       :CMVT1400-DIFMAXSB
                  FROM  CMVT1400_LIMIDADE
                 WHERE  CPRODUTO  = :CMVT1400-CPRODUTO
                   AND  CSUBPROD  = :CMVT1400-CSUBPROD
                   AND  CMOEDA    = :CMVT1400-CMOEDA
                   AND  INDOPER   = :CMVT1400-INDOPER
                   AND  TPIDADE   = :CMVT1400-TPIDADE
                   AND  TPINTERV  = :CMVT1400-TPINTERV
                   AND  CPRAZMIN <= :CMVT1400-CPRAZMIN
                   AND  CPRAZMAX >= :CMVT1400-CPRAZMAX
           END-EXEC.

           MOVE WS-CON-CMVT1400 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF CMVT1400-OK
                 PERFORM 2121-VAL-PARAMETROS-BEN
                    THRU 2121-VAL-PARAMETROS-BEN-EXIT
              ELSE
                IF CMVT1400-NOTFND
                   MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-998      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                ELSE
                   MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-660      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-660      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2121-VAL-LIMIDADES-BEN-EXIT.
           EXIT.
      ******************************************************************
       2121-VAL-PARAMETROS-BEN.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2121-VAL-PARAMETROS-BEN' END-IF.

           IF WS-IDADEACT-BEN > CMVT1400-IDADEMAX
              MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
              MOVE AMCK0001-CON-999      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.

           IF WS-IDADEACT-BEN < CMVT1400-IDADEMIN
              MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
              MOVE AMCK0001-CON-030      TO AMCV7301-ZSOCIO-MSG
              MOVE WS-CON-1              TO AMCV7301-ZSOCIO-S
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              WS-QPRAZO-N NOT EQUAL WS-CON-N999
              COMPUTE WS-VAR-AUX = WS-IDADEACT-BEN + WS-QPRAZO-N
              IF WS-VAR-AUX > CMVT1400-IDADPRAZ
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-999      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              COMPUTE WS-VAR-AUX = WS-IDADEACT-SOCIO - WS-IDADEACT-BEN
              IF WS-VAR-AUX > CMVT1400-DIFMAXSB
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-999      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.
      *
       2121-VAL-PARAMETROS-BEN-EXIT.
           EXIT.
      ******************************************************************
       2122-VAL-LIMIDADES-CTI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2122-VAL-LIMIDADES-CTI' END-IF.

           MOVE WS-CON-74                      TO CMVT1400-CPRODUTO.
      *    MOVE WS-CON-89                      TO CMVT1400-CSUBPROD.
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9    TO CMVT1400-CSUBPROD
           ELSE
              MOVE WS-CON-89    TO CMVT1400-CSUBPROD
           END-IF
           MOVE AMCV7300-CMOEDA                TO CMVT1400-CMOEDA.
           MOVE WS-CON-I                       TO CMVT1400-INDOPER.
           MOVE WS-CON-A                       TO CMVT1400-TPIDADE.
           MOVE WS-CON-A                       TO CMVT1400-TPINTERV.
           MOVE WS-QPRAZO-CTI                  TO WS-QPRAZO-N.
           MOVE WS-QPRAZO-N                    TO CMVT1400-CPRAZMIN.
           MOVE WS-QPRAZO-N                    TO CMVT1400-CPRAZMAX.

           EXEC SQL
                SELECT  IDADEMAX    ,
                        IDADEMIN    ,
                        IDADPRAZ    ,
                        DIFMAXSB
                  INTO :CMVT1400-IDADEMAX   ,
                       :CMVT1400-IDADEMIN   ,
                       :CMVT1400-IDADPRAZ   ,
                       :CMVT1400-DIFMAXSB
                  FROM  CMVT1400_LIMIDADE
                 WHERE  CPRODUTO  = :CMVT1400-CPRODUTO
                   AND  CSUBPROD  = :CMVT1400-CSUBPROD
                   AND  CMOEDA    = :CMVT1400-CMOEDA
                   AND  INDOPER   = :CMVT1400-INDOPER
                   AND  TPIDADE   = :CMVT1400-TPIDADE
                   AND  TPINTERV  = :CMVT1400-TPINTERV
                   AND  CPRAZMIN <= :CMVT1400-CPRAZMIN
                   AND  CPRAZMAX >= :CMVT1400-CPRAZMAX
           END-EXEC.

           MOVE WS-CON-CMVT1400 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF CMVT1400-OK
                 PERFORM 2122-VAL-PARAMETROS-CTI
                    THRU 2122-VAL-PARAMETROS-CTI-EXIT
              ELSE
                IF CMVT1400-NOTFND
                   MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-998      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                ELSE
                   MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-660      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-660      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2122-VAL-LIMIDADES-CTI-EXIT.
           EXIT.
      ******************************************************************
       2122-VAL-PARAMETROS-CTI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2122-VAL-PARAMETROS-CTI' END-IF.

           IF WS-IDADEACT-SOCIO > CMVT1400-IDADEMAX
              MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
              MOVE AMCK0001-CON-999      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.

           IF WS-IDADEACT-SOCIO < CMVT1400-IDADEMIN
              MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
              MOVE AMCK0001-CON-030      TO AMCV7301-ZSOCIO-MSG
              MOVE WS-CON-1              TO AMCV7301-ZSOCIO-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              COMPUTE WS-VAR-AUX = WS-IDADEACT-SOCIO +
                                   WS-QPRAZO-CTI
              IF WS-VAR-AUX > CMVT1400-IDADPRAZ
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-999      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.
      *
       2122-VAL-PARAMETROS-CTI-EXIT.
           EXIT.
      ******************************************************************
       2123-OBTEM-ZINSCRIC.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2123-OBTEM-ZINSCRIC' END-IF.

           MOVE AMCV7300-CTIPSOC        TO AMVT0115-CTIPSOC.
           MOVE AMCV7300-ZSOCIO         TO AMVT0115-ZSOCIO.
           MOVE AMCV7300-CDIGISOC       TO AMVT0115-CDIGISOC.

           EXEC SQL
               SELECT  MAX(ZINSCRIC)
                 INTO :WS-MAX-ZINSCRIC   :WS-INDICADOR
                 FROM  AMVT0115_BASIOPER
                WHERE  CTIPSOC  = :AMVT0115-CTIPSOC
                  AND  ZSOCIO   = :AMVT0115-ZSOCIO
                  AND  CDIGISOC = :AMVT0115-CDIGISOC
           END-EXEC.

           MOVE WS-CON-AMVT0115 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF AMVT0115-OK
                 IF WS-INDICADOR LESS THAN ZERO
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-271      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 MOVE ATCK0002-ABEND-DB2     TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-271       TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1               TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-271          TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1                  TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2123-VALIDA-DCONTD
                 THRU 2123-VALIDA-DCONTD-EXIT
           END-IF.
      *
       2123-OBTEM-ZINSCRIC-EXIT.
           EXIT.
      ******************************************************************
       2123-VALIDA-DCONTD.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2123-VALIDA-DCONTD' END-IF.

           MOVE AMCV7300-CTIPSOC        TO AMVT0115-CTIPSOC.
           MOVE AMCV7300-ZSOCIO         TO AMVT0115-ZSOCIO.
           MOVE AMCV7300-CDIGISOC       TO AMVT0115-CDIGISOC.

           EXEC SQL
               SELECT  MIN(DCONTD)
                 INTO :WS-MIN-DCONTD   :WS-INDICADOR
                 FROM  AMVT0115_BASIOPER
                WHERE  CTIPSOC  = :AMVT0115-CTIPSOC
                  AND  ZSOCIO   = :AMVT0115-ZSOCIO
                  AND  CDIGISOC = :AMVT0115-CDIGISOC
           END-EXEC.

           MOVE WS-CON-AMVT0115 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF AMVT0115-OK
                 IF WS-INDICADOR LESS THAN ZERO
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-272      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 IF NOT AMVT0115-OK
                    MOVE ATCK0002-ABEND-DB2   TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-272     TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1             TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-272          TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1                  TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE WS-MIN-DCONTD     TO ATCW3000-DATA10
              PERFORM ATCP3000-CONV-DATA108
                 THRU ATCP3000-CONV-DATA108-EXIT
              MOVE ATCW3000-DATA8     TO WS-MIN-DCONTD8
              IF AMCV7301-CTIPSOC EQUAL WS-CON-C  AND
                 WS-MAX-ZINSCRIC  EQUAL WS-CON-N3
                 IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
      *          NÃO VALIDAR P '510'
                   IF AMCV7300-DCONTD(1:6) NOT EQUAL
                      WS-MIN-DCONTD8(1:6)  AND
                      AMCV7300-ZSOCIO-S    NOT EQUAL
                      AMCK0004-AUTORIZ-MAXIMA
                      MOVE AMCK0004-AUTORIZ-MAXIMA TO AMCV7301-ZSOCIO-S
                      MOVE AMCK0001-CON-936      TO AMCV7301-ZSOCIO-MSG
                      MOVE ATCK0002-AUTORIZACAO  TO ATCL0001-IND-ERROS
                   END-IF
                 ELSE
                   IF AMCV7300-DCONTD(1:6) NOT EQUAL
                      WS-MIN-DCONTD8(1:6)  AND
                      AMCV7300-ZSOCIO-S    NOT EQUAL
                      AMCK0004-AUTORIZ-MAXIMA-2
                      MOVE AMCK0004-AUTORIZ-MAXIMA-2
                        TO AMCV7301-ZSOCIO-S
                      MOVE AMCK0001-CON-936      TO AMCV7301-ZSOCIO-MSG
                      MOVE ATCK0002-AUTORIZACAO  TO ATCL0001-IND-ERROS
                    END-IF
                 END-IF
              ELSE
                 IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
      *          NÃO VALIDAR P '510'
                   IF AMCV7300-DCONTD(1:6) LESS THAN
                      WS-MIN-DCONTD8(1:6) AND
                      AMCV7300-ZSOCIO-S    NOT EQUAL
                      AMCK0004-AUTORIZ-MAXIMA
                      MOVE AMCK0004-AUTORIZ-MAXIMA TO AMCV7301-ZSOCIO-S
                      MOVE AMCK0001-CON-936      TO AMCV7301-ZSOCIO-MSG
                      MOVE ATCK0002-AUTORIZACAO  TO ATCL0001-IND-ERROS
                   END-IF
                 ELSE
                   IF AMCV7300-DCONTD(1:6) LESS THAN
                      WS-MIN-DCONTD8(1:6) AND
                      AMCV7300-ZSOCIO-S    NOT EQUAL
                      AMCK0004-AUTORIZ-MAXIMA-2
                      MOVE AMCK0004-AUTORIZ-MAXIMA-2
                        TO AMCV7301-ZSOCIO-S
                      MOVE AMCK0001-CON-936      TO AMCV7301-ZSOCIO-MSG
                      MOVE ATCK0002-AUTORIZACAO  TO ATCL0001-IND-ERROS
                   END-IF
                 END-IF
              END-IF
           END-IF.
      *
       2123-VALIDA-DCONTD-EXIT.
           EXIT.
      ******************************************************************
       2124-VAL-CONVERSAO.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2124-VAL-CONVERSAO' END-IF.

           MOVE AMCV7300-CTIPSOC  TO AMVT0115-CTIPSOC.
           MOVE AMCV7300-ZSOCIO   TO AMVT0115-ZSOCIO.
           MOVE AMCV7300-CDIGISOC TO AMVT0115-CDIGISOC.
           MOVE AMCV7300-CPRODUTO TO AMVT0115-CPRODUTO.
           MOVE AMCV7300-CSUBPROD TO AMVT0115-CSUBPROD.

           EXEC SQL
               OPEN CRS-AMT01-1
           END-EXEC.

           MOVE WS-CON-AMVT0115   TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF NOT AMVT0115-OK
              MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-771 TO AMCV7301-CTIPSOC-MSG
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2124-FETCH-AMT01-1
                 THRU 2124-FETCH-AMT01-1-EXIT
                UNTIL NOT ATCL0001-SEM-ERROS
                   OR AMVT0115-NOTFND
           END-IF.

           IF ATCL0001-ERROS-VALIDOS
              EXEC SQL
                  CLOSE CRS-AMT01-1
              END-EXEC

              MOVE WS-CON-AMVT0115  TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF NOT AMVT0115-OK
                 MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
                 MOVE AMCK0001-CON-773 TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.
      *
       2124-VAL-CONVERSAO-EXIT.
           EXIT.
      ******************************************************************
       2124-FETCH-AMT01-1.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2124-FETCH-AMT01-1' END-IF.

           EXEC SQL
               FETCH CRS-AMT01-1
                INTO :AMVT0115-CPRODUTO,
                     :AMVT0115-CBALCAO,
                     :AMVT0115-CNUMECTA,
                     :AMVT0115-CDIGICTA
           END-EXEC.

           MOVE WS-CON-AMVT0115   TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF AMVT0115-OK
                 PERFORM 2124-VERIFICA-AMT30
                    THRU 2124-VERIFICA-AMT30-EXIT
              ELSE
                 IF NOT AMVT0115-NOTFND
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                    MOVE AMCK0001-CON-772   TO AMCV7301-CTIPSOC-MSG
                 END-IF
              END-IF
           ELSE
              MOVE WS-CON-1                   TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-772           TO AMCV7301-CTIPSOC-MSG
           END-IF.
      *
       2124-FETCH-AMT01-1-EXIT.
           EXIT.
      ******************************************************************
       2124-VERIFICA-AMT30.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2124-VERIFICA-AMT30' END-IF.

           MOVE ZEROS TO WS-CONTADOR.

           EXEC SQL
                SELECT  COUNT(*)
                  INTO :WS-CONTADOR
                  FROM  AMVT3008_HISTOPER
                 WHERE  CBALCAO  = :AMVT0115-CBALCAO
                   AND  CPRODUTO = :AMVT0115-CPRODUTO
                   AND  CNUMECTA = :AMVT0115-CNUMECTA
                   AND  CDIGICTA = :AMVT0115-CDIGICTA
                   AND (CSITMOV  = '0'
                   OR   CSITMOV  = '1')
                   AND  CAPLIC   = 'AM'
                   AND  COPCAO   = '21'
           END-EXEC.

           MOVE WS-CON-AMVT3008 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF AMVT3008-OK
                 IF WS-CONTADOR GREATER THAN 0
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-023      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 IF NOT AMVT3008-NOTFND
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-556      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-556      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2124-VERIFICA-AMT30-EXIT.
           EXIT.
      ******************************************************************
       2126-VALIDA-INAPTO.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2126-VALIDA-INAPTO' END-IF.

           PERFORM 2126-VALIDA-RESPOSTA-1
              THRU 2126-VALIDA-RESPOSTA-1-EXIT.

           IF ATCL0001-SEM-ERROS OR
              ATCL0001-AUTORIZACAO
              IF AMCV7300-ZCLIENTE-BEN NOT EQUAL ZEROS
                 PERFORM 2126-VALIDA-RESPOSTA-2
                    THRU 2126-VALIDA-RESPOSTA-2-EXIT
              END-IF
           END-IF.

       2126-VALIDA-INAPTO-EXIT.
           EXIT.
      ******************************************************************
       2126-VALIDA-RESPOSTA-1.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2126-VALIDA-RESPOSTA-1' END-IF.

           INITIALIZE AMCL1062-AREA
            REPLACING ALPHANUMERIC DATA BY SPACES
                           NUMERIC DATA BY ZEROES.

           MOVE AMCV7301-ZCLIENTE-SOC1 TO AMCL1062-ZCLIENTE.

           PERFORM AMCI1062-ROTINA
              THRU AMCI1062-EXIT.

           MOVE AMCL1062-NR-ERRO        TO ATCL0001-SQLCODE.
           MOVE AMCL1062-TABLE-NAME     TO ATCL0001-TABLE-NAME.
           MOVE AMCL1062-IND-ERROS      TO ATCL0001-IND-ERROS.
           MOVE AMCL1062-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG.
           MOVE AMCL1062-STATUS         TO AMCV7301-CTIPSOC-S.

           IF ATCL0001-SEM-ERROS
              IF AMCL1062-CRETORNO NOT EQUAL WS-CON-N
                IF AMCV7300-CPRODUTO-S NOT EQUAL AMCK0004-AUTORIZ-INAPTO
                   MOVE ATCK0002-AUTORIZACAO    TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-165        TO AMCV7301-CPRODUTO-MSG
                   MOVE AMCK0004-AUTORIZ-INAPTO TO AMCV7301-CPRODUTO-S
                END-IF
              END-IF
           END-IF.

       2126-VALIDA-RESPOSTA-1-EXIT.
           EXIT.
      ******************************************************************
       2126-VALIDA-RESPOSTA-2.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2126-VALIDA-RESPOSTA-2' END-IF.

           INITIALIZE AMCL1062-AREA
            REPLACING ALPHANUMERIC DATA BY SPACES
                           NUMERIC DATA BY ZEROES.

           MOVE AMCV7300-ZCLIENTE-BEN  TO AMCL1062-ZCLIENTE.

           PERFORM AMCI1062-ROTINA
              THRU AMCI1062-EXIT.

           MOVE AMCL1062-NR-ERRO        TO ATCL0001-SQLCODE.
           MOVE AMCL1062-TABLE-NAME     TO ATCL0001-TABLE-NAME.
           MOVE AMCL1062-IND-ERROS      TO ATCL0001-IND-ERROS.
           MOVE AMCL1062-COD-ERRO-GRAVE TO AMCV7301-ZSOCIO-MSG.
           MOVE AMCL1062-STATUS         TO AMCV7301-ZSOCIO-S.

           IF ATCL0001-SEM-ERROS
              IF AMCL1062-CRETORNO NOT EQUAL WS-CON-N
                IF AMCV7300-CPRODUTO-S NOT EQUAL AMCK0004-AUTORIZ-INAPTO
                   MOVE ATCK0002-AUTORIZACAO    TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-165        TO AMCV7301-CPRODUTO-MSG
                   MOVE AMCK0004-AUTORIZ-INAPTO TO AMCV7301-CPRODUTO-S
                END-IF
              END-IF
           END-IF.

       2126-VALIDA-RESPOSTA-2-EXIT.
           EXIT.
      ******************************************************************
       2127-VALIDA-CNTSUB.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2127-VALIDA-CNTSUB' END-IF.

           IF AMCV7300-CBALSUB NOT = AMCV7300-CBALSAQ  OR
              AMCV7300-CPRDSUB NOT = AMCV7300-CPRODSAQ OR
              AMCV7300-CCTASUB NOT = AMCV7300-CCNTSAQ
           THEN
              MOVE AMCV7300-CBALSUB     TO AMCWDC00-CBALCAO
              MOVE AMCV7300-CPRDSUB     TO AMCWDC00-CPRODUTO
              MOVE AMCV7300-CCTASUB     TO AMCWDC00-CNUMECTA
              MOVE AMCV7300-CDIGSUB     TO AMCWDC00-CDIGICTA
              PERFORM AMCPDC00-VAL-CTA
                 THRU AMCPDC00-VAL-CTA-EXIT
              MOVE AMCWDC00-NR-ERRO     TO AMCV7301-CTIPSOC-MSG
              MOVE AMCWDC00-STATUS      TO AMCV7301-CTIPSOC-S
              IF ATCL0001-SEM-ERROS
                 MOVE DCVT0100-CTRATCTA TO WS-CTRATCTA-SUB
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE AMCV7300-CBALSUB        TO AMCW0004-CBALSUB
              MOVE AMCV7300-CPRDSUB        TO AMCW0004-CPRDSUB
              MOVE AMCV7300-CCTASUB        TO AMCW0004-CCTASUB
              MOVE AMCV7300-CDIGSUB        TO AMCW0004-CDIGSUB
              MOVE AMCV7301-ZCLIENTE-SOC1  TO AMCW0004-ZCLIENTE
              MOVE AMCV7301-DNASCIM-SOC1   TO ATCW3000-DATA8
              PERFORM ATCP6000-CONV-DATA810
                 THRU ATCP6000-CONV-DATA810-EXIT
              MOVE ATCW3000-DATA10         TO AMCW0004-DNASCIM
              MOVE WS-DDIAOP               TO AMCW0004-DDIAOP
              PERFORM AMCP0004-VAL-CNT-SUBSCRIC
                 THRU AMCP0004-VAL-CNT-SUBSCRIC-EXIT
              IF NOT AMCW0004-CONTA-VALIDA
      *C119891
                 IF ATCL0001-CBALCAO-OPER EQUAL WS-CON-777
                 OR ATCL0001-CBALCAO-OPER EQUAL WS-CON-510
                    IF AMCV7301-CCONTA-S NOT EQUAL
                                         AMCK0004-AUTORIZ-NIVEL-4
                       MOVE AMCK0004-AUTORIZ-NIVEL-4
                                                 TO AMCV7301-CCONTA-S
                       MOVE AMCK0001-CON-315     TO AMCV7301-CCONTA-MSG
                       MOVE ATCK0002-AUTORIZACAO TO ATCL0001-IND-ERROS
                    END-IF
                 ELSE
                    MOVE ATCK0002-ERROS-FUNCAO   TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-135        TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1                TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.
      *
       2127-VALIDA-CNTSUB-EXIT.
           EXIT.
      ******************************************************************
       2128-CAL-IDADE-REC-BEN.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2128-CAL-IDADE-REC-BEN' END-IF.
      *
           MOVE ZEROS                    TO AMCW1000-QAGRAVID.
           MOVE AMCV7301-DNASCIM-BEN     TO AMCW1000-DINICIO.
           MOVE WS-DTVENCIM-MAE          TO ATCW3000-DATA10.
           PERFORM ATCP3000-CONV-DATA108
              THRU ATCP3000-CONV-DATA108-EXIT
           MOVE ATCW3000-DATA8           TO AMCW1000-DCONTD
                                            AMCW1000-DCALC.
           MOVE WS-CON-N                 TO AMCW1000-CTPDATA.
      *
           PERFORM AMCP1000
              THRU AMCP1000-EXIT.
      *
      *    MOVE AMCW1000-IDADEACT        TO WS-IDADEACT-REC-BEN.
           MOVE AMCW1000-IDADETET        TO WS-IDADETET-REC-BEN.
      *
       2128-CAL-IDADE-REC-BEN-EXIT.
           EXIT.
      ******************************************************************
       2200-CALCULA-FORMATA.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2200-CALCULA-FORMATA' END-IF.

           IF AMCV7300-ICS      EQUAL WS-CON-1 AND
             (AMCV7300-CSUBPROD EQUAL WS-CON-83 OR
              AMCV7300-CSUBPROD EQUAL WS-CON-93 OR
              AMCV7300-CSUBPROD EQUAL WS-CON-A3)
              MOVE WS-CON-3            TO WS-ICNTSEG-MAE
           ELSE
              MOVE WS-CON-0            TO WS-ICNTSEG-MAE
           END-IF.

           PERFORM 2210-OBTEM-QUOTA
              THRU 2219-OBTEM-QUOTA-EXIT

           IF ATCL0001-SEM-ERROS AND
             (AMCV7300-CSUBPROD EQUAL WS-CON-83 OR
              AMCV7300-CSUBPROD EQUAL WS-CON-93 OR
              AMCV7300-CSUBPROD EQUAL WS-CON-A3)
      * ALT02 (I)
      *       COMPUTE WS-DIF-IDADES = AMCV7300-IDADRECB -
              COMPUTE WS-DIF-IDADES = WS-IDADEACT-DTVENCIM -
      * ALT02 (F)
                                      WS-IDADEACT-SOCIO
              IF WS-DIF-IDADES < WS-CON-N10 OR
                 WS-DIF-IDADES > WS-CON-N20
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-052      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2230-LIMITES-MAE
                 THRU 2239-LIMITES-MAE-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMCV7300-ICTI EQUAL WS-CON-1
              PERFORM 2240-LIMITES-CTI
                 THRU 2249-LIMITES-CTI-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE AMCV7300-CPRODUTO       TO WS-AMVT0115-CPRODUTO
              MOVE AMCV7300-CSUBPROD       TO WS-AMVT0115-CSUBPROD
              PERFORM 9400-OBTER-MCAPITAL
                 THRU 9499-OBTER-MCAPITAL-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE AMCV7301-ZCLIENTE-SOC1  TO AMCL0100-ZCLIENTE
              PERFORM 2250-LIM-CONJUNTOS
                 THRU 2259-LIM-CONJUNTOS-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMCV7300-ICTI EQUAL WS-CON-1

              MOVE WS-CON-74               TO WS-AMVT0115-CPRODUTO
      *       MOVE WS-CON-89               TO WS-AMVT0115-CSUBPROD
              IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
                 MOVE WS-CON-A9    TO WS-AMVT0115-CSUBPROD
              ELSE
                 MOVE WS-CON-89    TO WS-AMVT0115-CSUBPROD
              END-IF
              PERFORM 9400-OBTER-MCAPITAL
                 THRU 9499-OBTER-MCAPITAL-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2260-LIM-CONJUNTOS-CTI
                 THRU 2269-LIM-CONJUNTOS-CTI-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2270-SOMA-CAPITAL-INSP
                 THRU 2279-SOMA-CAPITAL-INSP-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2270-INSP-MEDICA
                 THRU 2279-INSP-MEDICA-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMCV7300-ICTI EQUAL WS-CON-1
              PERFORM 2280-INSP-MEDICA-CTI
                 THRU 2289-INSP-MEDICA-CTI-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              COMPUTE AMCV7301-MQUOTAIN-TOT =
                      AMCV7301-MQUOTAIN     +
                      AMCV7301-MQUOTAIN-CTI +
                      AMCV7301-MQUOTAIN-CS
              COMPUTE AMCV7301-MMOVIM-TOT   =
                      AMCV7301-MMOVIM       +
                      AMCV7301-MMOVIM-CTI   +
                      AMCV7301-MMOVIM-CS
           END-IF.
      *
       2299-CALCULA-FORMATA-EXIT.
           EXIT.
      ******************************************************************
       2210-OBTEM-QUOTA.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2210-OBTEM-QUOTA' END-IF.

           IF AMCV7300-CLIBERAC EQUAL WS-CON-1
              PERFORM 5000-CALCULA-LIB-MAE
                 THRU 5999-CALCULA-LIB-MAE-EXIT

              IF ATCL0001-SEM-ERROS
                 PERFORM 5000-CALCULA-LIB-FILHA
                    THRU 5999-CALCULA-LIB-FILHA-EXIT
              END-IF
           ELSE
              IF (AMCV7300-CSUBPROD     EQUAL WS-CON-83  OR
                  AMCV7300-CSUBPROD     EQUAL WS-CON-93  OR
                  AMCV7300-CSUBPROD     EQUAL WS-CON-A3) AND
                 AMCV7300-MQUOTAIN NOT EQUAL ZEROS
                 IF NOT ATCL0001-SIMULACAO-SIM
                    ADD AMCV7300-MQUOTAIN-CS   TO AMCV7300-MQUOTAIN
                 END-IF

                 MOVE ZEROS                 TO AMCV7300-MQUOTAIN-CS
              END-IF

              PERFORM 2211-OBTEM-QUOTA-MAE
                 THRU 2211-OBTEM-QUOTA-MAE-EXIT

              IF ATCL0001-SEM-ERROS AND
                 AMCV7300-ICTI EQUAL WS-CON-1
                 PERFORM 2212-OBTEM-QUOTA-CTI
                    THRU 2212-OBTEM-QUOTA-CTI-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS               AND
                 AMCV7300-ICS      EQUAL WS-CON-1 AND
                (AMCV7300-CSUBPROD EQUAL WS-CON-83 OR
                 AMCV7300-CSUBPROD EQUAL WS-CON-93 OR
                 AMCV7300-CSUBPROD EQUAL WS-CON-A3)
                 PERFORM 2213-OBTEM-QUOTA-CS
                    THRU 2213-OBTEM-QUOTA-CS-EXIT
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS                  AND
             (AMCV7300-CSUBPROD   EQUAL WS-CON-83  OR
              AMCV7300-CSUBPROD   EQUAL WS-CON-93  OR
              AMCV7300-CSUBPROD   EQUAL WS-CON-A3) AND
              WS-MVALORQT-MAE NOT EQUAL ZEROS
              PERFORM 2214-RECALCULA-PREF
                 THRU 2214-RECALCULA-PREF-EXIT
           END-IF.
      *
       2219-OBTEM-QUOTA-EXIT.
           EXIT.
      ******************************************************************
       2211-OBTEM-QUOTA-MAE.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2211-OBTEM-QUOTA-MAE' END-IF.

           MOVE AMCV7300-CPRODUTO              TO CMVT3000-CPRODUTO.
           MOVE AMCV7300-CSUBPROD              TO CMVT3000-CSUBPROD.
           MOVE AMCV7300-CMOEDA                TO CMVT3000-CMOEDA.
           MOVE AMCV7300-CPLSUBS               TO CMVT3000-CPLSUBS.
           MOVE AMCV7300-TXPROG                TO CMVT3000-TXPROG.
           MOVE AMCV7300-DCONTD                TO ATCW3000-DATA8.
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT.
           MOVE ATCW3000-DATA10                TO CMVT3000-DATAINI
                                                  CMVT3000-DATAFIM.
           MOVE WS-IDADEACT-SOCIO              TO CMVT3000-IDADE1.

           MOVE ZEROS                          TO CMVT3000-IDADE2.
           MOVE ZEROS                          TO CMVT3000-IDADE3.
           MOVE ZEROS                          TO CMVT3000-CCOBADIC.
           MOVE ZEROS                          TO CMVT3000-ICNTSEG.

           IF AMCV7300-CSUBPROD EQUAL (WS-CON-84 OR WS-CON-A4)
              MOVE AMCV7300-QPRAZO             TO CMVT3000-QPRAZO
           ELSE
              MOVE ZEROS                       TO CMVT3000-QPRAZO
           END-IF.

           IF AMCV7300-CSUBPROD EQUAL WS-CON-83
           OR AMCV7300-CSUBPROD EQUAL WS-CON-93
           OR AMCV7300-CSUBPROD EQUAL WS-CON-A3
      * ALT02 (I)
      *       MOVE AMCV7300-IDADRECB           TO CMVT3000-IDADE2
              MOVE WS-IDADEACT-DTVENCIM        TO CMVT3000-IDADE2
      * ALT02 (F)
           END-IF.

           IF AMCV7300-CSUBPROD EQUAL (WS-CON-96 OR WS-CON-A6)
              MOVE WS-IDADEACT-BEN             TO CMVT3000-IDADE2
      * ALT02 (I)
      *       MOVE AMCV7300-IDADRECB           TO CMVT3000-IDADE3
              MOVE WS-IDADEACT-DTVENCIM        TO CMVT3000-IDADE3
      * ALT02 (I)
           END-IF.

           EXEC SQL
                SELECT  MVALORQT
                  INTO :CMVT3000-MVALORQT
                  FROM  CMVT3000_QUOTAS
                 WHERE  CPRODUTO  = :CMVT3000-CPRODUTO
                   AND  CSUBPROD  = :CMVT3000-CSUBPROD
                   AND  CMOEDA    = :CMVT3000-CMOEDA
                   AND  CPLSUBS   = :CMVT3000-CPLSUBS
                   AND  TXPROG    = :CMVT3000-TXPROG
                   AND  QPRAZO    = :CMVT3000-QPRAZO
                   AND  IDADE1    = :CMVT3000-IDADE1
                   AND  IDADE2    = :CMVT3000-IDADE2
                   AND  IDADE3    = :CMVT3000-IDADE3
                   AND  CCOBADIC  = :CMVT3000-CCOBADIC
                   AND  ICNTSEG   = :CMVT3000-ICNTSEG
                   AND  DATAINI  <= :CMVT3000-DATAINI
                   AND  DATAFIM  >= :CMVT3000-DATAFIM
           END-EXEC.

           MOVE WS-CON-CMVT3000 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF CMVT3000-OK
                IF CMVT3000-MVALORQT = 0
                   IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
      *            NÃO VALIDAR P '510'
                      MOVE ATCK0002-ERROS-FUNCAO
                                            TO ATCL0001-IND-ERROS
                      MOVE AMCK0001-CON-957 TO AMCV7301-ZEMPREST-MSG
                      MOVE WS-CON-1         TO AMCV7301-ZEMPREST-S
                   ELSE
                      IF AMCV7300-ZEMPREST-S NOT EQUAL
                                          AMCK0004-AUTORIZ-NIVEL-4
                         MOVE ATCK0002-AUTORIZACAO TO
                                          ATCL0001-IND-ERROS
                         MOVE AMCK0001-CON-957 TO
                                          AMCV7301-ZEMPREST-MSG
                         MOVE AMCK0004-AUTORIZ-NIVEL-4    TO
                                          AMCV7301-ZEMPREST-S
                      END-IF
                   END-IF
                ELSE
                  IF AMCV7300-MCAPITAL NOT EQUAL ZEROS
                    COMPUTE WS-MQUOTAIN ROUNDED = ( AMCV7300-MCAPITAL *
                            CMVT3000-MVALORQT) / WS-MMULTSUB-MAE

                    COMPUTE WS-VAR-AUX-2 ROUNDED = WS-MQUOTAIN
                    MOVE WS-VAR-AUX-2      TO AMCV7301-MQUOTAIN
                    MOVE AMCV7300-MCAPITAL TO AMCV7301-MCAPITAL
                    MOVE ZEROS             TO AMCV7301-MMOVIM
                  ELSE
                    COMPUTE WS-MCAPITAL ROUNDED = ( WS-MMULTSUB-MAE *
                            AMCV7300-MQUOTAIN) / CMVT3000-MVALORQT

                    COMPUTE WS-VAR-AUX-2 ROUNDED = WS-MCAPITAL
                    MOVE WS-VAR-AUX-2      TO AMCV7301-MCAPITAL
                    MOVE AMCV7300-MQUOTAIN TO AMCV7301-MQUOTAIN
                    MOVE ZEROS             TO AMCV7301-MMOVIM
                    MOVE CMVT3000-MVALORQT TO WS-MVALORQT-MAE
                  END-IF
                END-IF
              ELSE
                 IF CMVT3000-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-957      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-700      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-700      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2211-OBTEM-QUOTA-MAE-EXIT.
           EXIT.
      ******************************************************************
       2212-OBTEM-QUOTA-CTI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2212-OBTEM-QUOTA-CTI' END-IF.

           MOVE WS-CON-74                      TO CMVT3000-CPRODUTO.
      *    MOVE WS-CON-89                      TO CMVT3000-CSUBPROD.
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9       TO CMVT3000-CSUBPROD
           ELSE
              MOVE WS-CON-89       TO CMVT3000-CSUBPROD
           END-IF
           MOVE AMCV7300-CMOEDA                TO CMVT3000-CMOEDA.
           MOVE AMCV7300-CPLSUBS               TO CMVT3000-CPLSUBS.
           MOVE AMCV7300-TXPROG                TO CMVT3000-TXPROG.
           MOVE AMCV7300-DCONTD                TO ATCW3000-DATA8.
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT.
           MOVE ATCW3000-DATA10                TO CMVT3000-DATAINI
                                                  CMVT3000-DATAFIM.
           MOVE WS-IDADEACT-SOCIO              TO CMVT3000-IDADE1.
           MOVE ZEROS                          TO CMVT3000-IDADE2.
           MOVE ZEROS                          TO CMVT3000-IDADE3.
           MOVE AMCV7300-INDSBPRO-CTI          TO CMVT3000-CCOBADIC.
           MOVE ZEROS                          TO CMVT3000-ICNTSEG.

           MOVE WS-QPRAZO-CTI                  TO CMVT3000-QPRAZO.

           EXEC SQL
                SELECT  MVALORQT
                  INTO :CMVT3000-MVALORQT
                  FROM  CMVT3000_QUOTAS
                 WHERE  CPRODUTO  = :CMVT3000-CPRODUTO
                   AND  CSUBPROD  = :CMVT3000-CSUBPROD
                   AND  CMOEDA    = :CMVT3000-CMOEDA
                   AND  CPLSUBS   = :CMVT3000-CPLSUBS
                   AND  TXPROG    = :CMVT3000-TXPROG
                   AND  QPRAZO    = :CMVT3000-QPRAZO
                   AND  IDADE1    = :CMVT3000-IDADE1
                   AND  IDADE2    = :CMVT3000-IDADE2
                   AND  IDADE3    = :CMVT3000-IDADE3
                   AND  CCOBADIC  = :CMVT3000-CCOBADIC
                   AND  ICNTSEG   = :CMVT3000-ICNTSEG
                   AND  DATAINI  <= :CMVT3000-DATAINI
                   AND  DATAFIM  >= :CMVT3000-DATAFIM
           END-EXEC.

           MOVE WS-CON-CMVT3000 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF CMVT3000-OK
                 IF AMCV7300-MCAPITAL-CTI NOT EQUAL ZEROS
                    COMPUTE WS-MQUOTAIN ROUNDED =
                                         ( AMCV7300-MCAPITAL-CTI *
                           CMVT3000-MVALORQT ) / WS-MMULTSUB-CTI

                    COMPUTE WS-VAR-AUX-2 ROUNDED = WS-MQUOTAIN
                    MOVE WS-VAR-AUX-2     TO AMCV7301-MQUOTAIN-CTI
                    MOVE AMCV7300-MCAPITAL-CTI TO AMCV7301-MCAPITAL-CTI
                    MOVE ZEROS            TO AMCV7301-MMOVIM-CTI
                 ELSE
                    COMPUTE WS-MCAPITAL ROUNDED = ( WS-MMULTSUB-CTI *
                           AMCV7300-MQUOTAIN-CTI ) / CMVT3000-MVALORQT

                    COMPUTE WS-VAR-AUX   ROUNDED = WS-MCAPITAL
                    MOVE WS-VAR-AUX       TO AMCV7301-MCAPITAL-CTI
                    MOVE AMCV7300-MQUOTAIN-CTI TO AMCV7301-MQUOTAIN-CTI
                    MOVE ZEROS            TO AMCV7301-MMOVIM-CTI
                 END-IF
              ELSE
                 IF CMVT3000-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-957      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-700      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-700      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2212-OBTEM-QUOTA-CTI-EXIT.
           EXIT.
      ******************************************************************
       2213-OBTEM-QUOTA-CS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2213-OBTEM-QUOTA-CS' END-IF.

           MOVE WS-CON-74                      TO CMVT3000-CPRODUTO.
      *    MOVE WS-CON-91                      TO CMVT3000-CSUBPROD.
           IF AMCV7301-CSUBPROD = 'A3'
              MOVE WS-CON-A0       TO CMVT3000-CSUBPROD
           ELSE
              MOVE WS-CON-91       TO CMVT3000-CSUBPROD
           END-IF
           MOVE AMCV7300-CMOEDA                TO CMVT3000-CMOEDA.
           MOVE AMCV7300-CPLSUBS               TO CMVT3000-CPLSUBS.
           MOVE AMCV7300-TXPROG                TO CMVT3000-TXPROG.
           MOVE AMCV7300-DCONTD                TO ATCW3000-DATA8.
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT.
           MOVE ATCW3000-DATA10                TO CMVT3000-DATAINI
                                                  CMVT3000-DATAFIM.
           MOVE WS-IDADEACT-SOCIO              TO CMVT3000-IDADE1.
           MOVE ZEROS                          TO CMVT3000-IDADE2.
           MOVE ZEROS                          TO CMVT3000-IDADE3.
           MOVE ZEROS                          TO CMVT3000-CCOBADIC.
           MOVE ZEROS                          TO CMVT3000-ICNTSEG.
           MOVE ZEROS                          TO CMVT3000-QPRAZO.
      * ALT02 (I)
      *    MOVE AMCV7300-IDADRECB              TO CMVT3000-IDADE2.
           MOVE WS-IDADEACT-DTVENCIM           TO CMVT3000-IDADE2.
      * ALT02 (F)

           EXEC SQL
                SELECT  MVALORQT
                  INTO :CMVT3000-MVALORQT
                  FROM  CMVT3000_QUOTAS
                 WHERE  CPRODUTO  = :CMVT3000-CPRODUTO
                   AND  CSUBPROD  = :CMVT3000-CSUBPROD
                   AND  CMOEDA    = :CMVT3000-CMOEDA
                   AND  CPLSUBS   = :CMVT3000-CPLSUBS
                   AND  TXPROG    = :CMVT3000-TXPROG
                   AND  QPRAZO    = :CMVT3000-QPRAZO
                   AND  IDADE1    = :CMVT3000-IDADE1
                   AND  IDADE2    = :CMVT3000-IDADE2
                   AND  IDADE3    = :CMVT3000-IDADE3
                   AND  CCOBADIC  = :CMVT3000-CCOBADIC
                   AND  ICNTSEG   = :CMVT3000-ICNTSEG
                   AND  DATAINI  <= :CMVT3000-DATAINI
                   AND  DATAFIM  >= :CMVT3000-DATAFIM
           END-EXEC.

           MOVE WS-CON-CMVT3000 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF CMVT3000-OK
                 MOVE CMVT3000-MVALORQT TO WS-MVALORQT-CS
                 IF AMCV7301-MCAPITAL NOT EQUAL ZEROS
                    COMPUTE WS-MQUOTAIN ROUNDED = ( AMCV7301-MCAPITAL *
                           CMVT3000-MVALORQT) / WS-MMULTSUB-MAE

                    COMPUTE WS-VAR-AUX   ROUNDED = WS-MQUOTAIN
                    MOVE WS-VAR-AUX       TO AMCV7301-MQUOTAIN-CS
                    MOVE ZEROS            TO AMCV7301-MMOVIM-CS
                 ELSE
                    COMPUTE WS-MCAPITAL ROUNDED = ( WS-MMULTSUB-MAE *
                           AMCV7300-MQUOTAIN-CS ) / CMVT3000-MVALORQT
                    MOVE ZEROS            TO AMCV7301-MMOVIM-CS
                 END-IF
              ELSE
                 IF CMVT3000-NOTFND
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-957      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-700      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-700      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2213-OBTEM-QUOTA-CS-EXIT.
           EXIT.
      ******************************************************************
       2214-RECALCULA-PREF.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2214-RECALCULA-PREF' END-IF.

           COMPUTE WS-MVALORQT-TOTAL =  WS-MVALORQT-MAE  +
                                        WS-MVALORQT-CS.

           COMPUTE WS-MCAPITAL-PREF ROUNDED =  (WS-MMULTSUB-MAE    *
                                        AMCV7300-MQUOTAIN) /
                                        WS-MVALORQT-TOTAL.

           COMPUTE WS-VAR-AUX   ROUNDED = WS-MCAPITAL-PREF.
           MOVE WS-VAR-AUX       TO AMCV7301-MCAPITAL.
           MOVE AMCV7301-MCAPITAL      TO AMCV7300-MCAPITAL.

           COMPUTE WS-MULTIPLO-QUOTA ROUNDED = WS-MCAPITAL-PREF /
                                       WS-MMULTSUB-MAE.

           COMPUTE WS-MQUOTAIN-AUX = WS-MULTIPLO-QUOTA *
                                     WS-MVALORQT-MAE.

           COMPUTE WS-VAR-AUX-2 ROUNDED = WS-MQUOTAIN-AUX.
           MOVE WS-VAR-AUX-2     TO AMCV7301-MQUOTAIN.
           MOVE AMCV7301-MQUOTAIN      TO AMCV7300-MQUOTAIN.

           COMPUTE WS-MQUOTAIN-AUX = WS-MULTIPLO-QUOTA *
                                     WS-MVALORQT-CS.

           COMPUTE WS-VAR-AUX-2 ROUNDED = WS-MQUOTAIN-AUX.
           MOVE WS-VAR-AUX-2     TO AMCV7301-MQUOTAIN-CS.
           MOVE AMCV7301-MQUOTAIN-CS   TO AMCV7300-MQUOTAIN-CS.
      *
       2214-RECALCULA-PREF-EXIT.
           EXIT.
      ******************************************************************
       2230-LIMITES-MAE.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2230-LIMITES-MAE' END-IF.

           INITIALIZE CMCL0300-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMCV7300-CPRODUTO           TO CMCL0300-CPRODUTO.
           MOVE AMCV7300-CSUBPROD           TO CMCL0300-CSUBPROD.
           MOVE AMCV7300-CMOEDA             TO CMCL0300-CMOEDA.
           MOVE AMCV7300-COPERAC            TO CMCL0300-COPERAC.

      * 2013-05-03 - VALIDAçãO ESPECIAL PARA BM45-73/93 - INICIO
           IF WS-AMT30-GREFMOV  = WS-CON-BM45 AND
              AMCV7300-CPRODUTO = WS-CON-73   AND
              AMCV7300-CSUBPROD = (WS-CON-93   OR WS-CON-A3)
           THEN
              MOVE ATCL0001-DDIAOP          TO CMCL0300-DCONTD
           ELSE
              MOVE AMCV7300-DCONTD          TO CMCL0300-DCONTD
           END-IF.
      * 2013-05-03 - VALIDAçãO ESPECIAL PARA BM45-73/93 - FIM

           MOVE AMCV7300-DCONTD             TO CMCL0300-DCONTD.
           MOVE AMCV7300-DCONTD             TO CMCL0300-DOPER.
           MOVE WS-CON-S                    TO CMCL0300-ICPMINDS.
           MOVE WS-CON-C                    TO CMCL0300-ISEMALCP.
           MOVE SPACES                      TO CMCL0300-ISEMALNM.
           MOVE SPACES                      TO CMCL0300-IPROCANM.
           MOVE ZEROS                       TO CMCL0300-PMELHRES.
           IF AMCV7300-CSUBPROD EQUAL WS-CON-83
           OR AMCV7300-CSUBPROD EQUAL WS-CON-93
           OR AMCV7300-CSUBPROD EQUAL WS-CON-A3
              MOVE ZEROS                    TO CMCL0300-QAGRAVID
           ELSE
              MOVE AMCV7300-QAGRAVID        TO CMCL0300-QAGRAVID
           END-IF.
           MOVE SPACES                      TO CMCL0300-CPLNENTR.
           MOVE AMCV7300-CPLSUBS            TO CMCL0300-CPLSUBS .
           MOVE AMCV7300-TXPROG             TO CMCL0300-TXPROG .
           MOVE AMCV7300-QPRAZO             TO CMCL0300-PRAZSUBS.
           MOVE ZEROS                       TO CMCL0300-CCOBADIC.
           MOVE WS-IDADEACT-SOCIO           TO CMCL0300-IDADEACT.
      * ALT02 (I)
      *    MOVE AMCV7300-IDADRECB           TO CMCL0300-IDADRECB.
           MOVE WS-IDADEACT-DTVENCIM        TO CMCL0300-IDADRECB.
      * ALT02 (F)
           MOVE ZEROS                       TO CMCL0300-MCAPINIC.
           MOVE AMCV7301-MCAPITAL           TO CMCL0300-MCAPITAL.
           MOVE ZEROS                       TO CMCL0300-MMELHORI.
           MOVE WS-CON-C                    TO CMCL0300-ITPVAL.

           PERFORM CMCI0300-ROTINA
              THRU CMCI0300-EXIT.

           IF NOT CMCL0300-SEM-ERROS
              MOVE CMCL0300-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE CMCL0300-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE CMCL0300-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE CMCL0300-STATUS         TO AMCV7301-CTIPSOC-S
              MOVE CMCL0300-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF CMCL0300-INDEOPER EQUAL WS-CON-2
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-730     TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1             TO AMCV7301-CTIPSOC-S
              ELSE
                 IF CMCL0300-INDEOPER EQUAL WS-CON-4 AND
                    CMCL0300-MCAPITAL-S EQUAL WS-CON-1
                    IF AMCV7300-CLIBERAC NOT EQUAL WS-CON-1
                       IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
      *                NÃO VALIDAR P '510'
                          MOVE ATCK0002-ERROS-FUNCAO
                                                TO ATCL0001-IND-ERROS
                          MOVE AMCK0001-CON-994 TO AMCV7301-CTIPSOC-MSG
                          MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
                       ELSE
                          IF AMCV7300-CSUBPROD-S NOT EQUAL
                                              AMCK0004-AUTORIZ-NIVEL-4
                             MOVE ATCK0002-AUTORIZACAO TO
                                              ATCL0001-IND-ERROS
                             MOVE AMCK0001-CON-994 TO
                                              AMCV7301-CSUBPROD-MSG
                             MOVE AMCK0004-AUTORIZ-NIVEL-4    TO
                                              AMCV7301-CSUBPROD-S
                          END-IF
                       END-IF
                    ELSE
                       PERFORM 2231-LIB-ABAIXO-MINIMO
                          THRU 2231-LIB-ABAIXO-MINIMO-EXIT
                    END-IF
                 ELSE
                    IF CMCL0300-INDEOPER EQUAL WS-CON-4 AND
                       CMCL0300-MCAPITAL-S EQUAL WS-CON-2
                       IF AMCV7300-CLIBERAC NOT EQUAL WS-CON-1 OR
                          AMCV7300-CLIBERAC     EQUAL WS-CON-1
                          IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
      *                   NÃO VALIDAR P '510'
                             MOVE ATCK0002-ERROS-FUNCAO
                                                TO ATCL0001-IND-ERROS
                             MOVE AMCK0001-CON-993
                                                TO AMCV7301-CTIPSOC-MSG
                             MOVE WS-CON-1      TO AMCV7301-CTIPSOC-S
                          ELSE
                             IF AMCV7300-CSUBPROD-S NOT EQUAL
                                            AMCK0004-AUTORIZ-NIVEL-4
                                MOVE ATCK0002-AUTORIZACAO TO
                                                  ATCL0001-IND-ERROS
                                MOVE AMCK0001-CON-993 TO
                                                  AMCV7301-CSUBPROD-MSG
                                MOVE AMCK0004-AUTORIZ-NIVEL-4    TO
                                                  AMCV7301-CSUBPROD-S
                             END-IF
                          END-IF
                       END-IF
                    END-IF
                 END-IF
              END-IF
           END-IF.
      *
       2239-LIMITES-MAE-EXIT.
           EXIT.
      ******************************************************************
       2231-LIB-ABAIXO-MINIMO.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2231-LIB-ABAIXO-MINIMO' END-IF.

           MOVE ZEROS TO WS-CONTADOR.
           COMPUTE AMCV7301-MMOVIM-TOT   =
                   AMCV7301-MMOVIM       +
                   AMCV7301-MMOVIM-CTI   +
                   AMCV7301-MMOVIM-CS
           MOVE CMVT1600-MINSUB1A     TO WS-MVALOR-MIN.
      *
           IF ATCL0001-SEM-ERROS
              IF AMCV7301-MMOVIM-TOT < WS-MVALOR-MIN
                 IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
      *          NÃO VALIDAR P '510'
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-994   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 ELSE
                    IF AMCV7300-CSUBPROD-S NOT EQUAL
                                           AMCK0004-AUTORIZ-NIVEL-4
                       MOVE ATCK0002-AUTORIZACAO TO
                                           ATCL0001-IND-ERROS
                       MOVE AMCK0001-CON-994 TO
                                           AMCV7301-CSUBPROD-MSG
                       MOVE AMCK0004-AUTORIZ-NIVEL-4    TO
                                           AMCV7301-CSUBPROD-S
                    END-IF
                 END-IF
              END-IF
           END-IF.
      *
       2231-LIB-ABAIXO-MINIMO-EXIT.
           EXIT.
      ******************************************************************
       2240-LIMITES-CTI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2240-LIMITES-CTI' END-IF.
      *
           PERFORM 2245-CALL-CMR00300-MPI
              THRU 2245-CALL-CMR00300-MPI-EXIT.

           IF ATCL0001-SEM-ERROS
             IF AMCV7301-MCAPITAL-CTI LESS THAN CMCL0300-MCAPMIN
              IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777 OR
      *       NÃO VALIDAR P '510'
                 AMCV7301-MCAPITAL-CTI     EQUAL ZEROS
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-994 TO AMCV7301-CSUBPROD-MSG
                 MOVE WS-CON-1         TO AMCV7301-CSUBPROD-S
              ELSE
                 IF AMCV7300-CSUBPROD-S NOT EQUAL
                                              AMCK0004-AUTORIZ-NIVEL-4
                    MOVE ATCK0002-AUTORIZACAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-994     TO AMCV7301-CSUBPROD-MSG
                    MOVE AMCK0004-AUTORIZ-NIVEL-4 TO AMCV7301-CSUBPROD-S
                 END-IF
              END-IF
             ELSE
              IF AMCV7301-MCAPITAL-CTI GREATER THAN CMCL0300-MCAPMAX
                 IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
      *          NÃO VALIDAR P '510'
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-993      TO AMCV7301-CSUBPROD-MSG
                    MOVE WS-CON-1              TO AMCV7301-CSUBPROD-S
                 ELSE
                    IF AMCV7300-CSUBPROD-S NOT EQUAL
                                                AMCK0004-AUTORIZ-NIVEL-4
                       MOVE ATCK0002-AUTORIZACAO TO
                                                ATCL0001-IND-ERROS
                       MOVE AMCK0001-CON-993 TO AMCV7301-CSUBPROD-MSG
                       MOVE AMCK0004-AUTORIZ-NIVEL-4    TO
                                                AMCV7301-CSUBPROD-S
                    END-IF
                 END-IF
              END-IF
             END-IF
           END-IF.
      *
           IF NOT ATCL0001-SEM-ERROS
              PERFORM 3000-FINAL-PROGRAMA
           END-IF.
      *
       2249-LIMITES-CTI-EXIT.
           EXIT.
      ******************************************************************
       2245-CALL-CMR00300-MPI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2245-CALL-CMR00300-MPI' END-IF.
      *
           INITIALIZE CMCL0300-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE WS-CON-74                TO CMCL0300-CPRODUTO.
      *    MOVE WS-CON-89                TO CMCL0300-CSUBPROD.
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9       TO CMCL0300-CSUBPROD
           ELSE
              MOVE WS-CON-89       TO CMCL0300-CSUBPROD
           END-IF
           MOVE AMCV7300-CMOEDA          TO CMCL0300-CMOEDA.
           MOVE AMCV7300-COPERAC         TO CMCL0300-COPERAC.
           MOVE AMCV7300-DCONTD          TO CMCL0300-DCONTD
                                            CMCL0300-DOPER.
           MOVE WS-CON-S                 TO CMCL0300-ICPMINDS.
           MOVE WS-CON-C                 TO CMCL0300-ISEMALCP.
           MOVE SPACES                   TO CMCL0300-ISEMALNM.
           MOVE SPACES                   TO CMCL0300-IPROCANM.
           MOVE ZEROS                    TO CMCL0300-PMELHRES.
           MOVE ZEROS                    TO CMCL0300-QAGRAVID.
           MOVE SPACES                   TO CMCL0300-CPLNENTR.
           MOVE 'C '                     TO CMCL0300-CPLSUBS .
           MOVE ZEROS                    TO CMCL0300-TXPROG .
           MOVE AMCV7300-QPRAZO-CTI      TO CMCL0300-PRAZSUBS.
           MOVE ZEROS                    TO CMCL0300-CCOBADIC.
           MOVE WS-IDADEACT-SOCIO        TO CMCL0300-IDADEACT.
      * ALT02 (I)
      *    MOVE AMCV7300-IDADRECB        TO CMCL0300-IDADRECB.
           MOVE WS-IDADEACT-DTVENCIM     TO CMCL0300-IDADRECB.
      * ALT02 (F)
           MOVE ZEROS                    TO CMCL0300-MCAPINIC.
           MOVE AMCV7301-MCAPITAL-CTI    TO CMCL0300-MCAPITAL.
           MOVE ZEROS                    TO CMCL0300-MMELHORI.
           MOVE WS-CON-C                 TO CMCL0300-ITPVAL.


           IF SW-DEBUG-SIM
              DISPLAY 'CMCL0300-CPRODUTO ' CMCL0300-CPRODUTO
              DISPLAY 'CMCL0300-CSUBPROD ' CMCL0300-CSUBPROD
              DISPLAY 'CMCL0300-CMOEDA   ' CMCL0300-CMOEDA
              DISPLAY 'CMCL0300-COPERAC  ' CMCL0300-COPERAC
              DISPLAY 'CMCL0300-DCONTD   ' CMCL0300-DCONTD
              DISPLAY 'CMCL0300-DOPER    ' CMCL0300-DOPER
              DISPLAY 'CMCL0300-ITPVAL   ' CMCL0300-ITPVAL
              DISPLAY 'CMCL0300-ICPMINDS ' CMCL0300-ICPMINDS
              DISPLAY 'CMCL0300-ISEMALCP ' CMCL0300-ISEMALCP
              DISPLAY 'CMCL0300-ISEMALNM ' CMCL0300-ISEMALNM
              DISPLAY 'CMCL0300-IPROCANM ' CMCL0300-IPROCANM
              DISPLAY 'CMCL0300-PMELHRES ' CMCL0300-PMELHRES
              DISPLAY 'CMCL0300-QAGRAVID ' CMCL0300-QAGRAVID
              DISPLAY 'CMCL0300-CPLNENTR ' CMCL0300-CPLNENTR
              DISPLAY 'CMCL0300-CPLSUBS  ' CMCL0300-CPLSUBS
              DISPLAY 'CMCL0300-TXPROG   ' CMCL0300-TXPROG
              DISPLAY 'CMCL0300-PRAZSUBS ' CMCL0300-PRAZSUBS
              DISPLAY 'CMCL0300-CCOBADIC ' CMCL0300-CCOBADIC
              DISPLAY 'CMCL0300-IDADEACT ' CMCL0300-IDADEACT
              DISPLAY 'CMCL0300-IDADRECB ' CMCL0300-IDADRECB
              DISPLAY 'CMCL0300-MCAPINIC ' CMCL0300-MCAPINIC
              DISPLAY 'CMCL0300-MCAPITAL ' CMCL0300-MCAPITAL
              DISPLAY 'CMCL0300-MMELHORI ' CMCL0300-MMELHORI
           END-IF

           PERFORM CMCI0300-ROTINA
              THRU CMCI0300-EXIT.

           IF NOT CMCL0300-SEM-ERROS
              MOVE CMCL0300-NR-ERRO      TO ATCL0001-SQLCODE
              MOVE CMCL0300-TABLE-NAME   TO ATCL0001-TABLE-NAME
              MOVE CMCL0300-IND-ERROS    TO ATCL0001-IND-ERROS
              MOVE CMCL0300-COD-ERRO-GRAVE
                                         TO AMCV7301-CTIPSOC-MSG
              MOVE CMCL0300-STATUS       TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF CMCL0300-INDEOPER EQUAL WS-CON-2
                 MOVE ATCK0002-ERROS-FUNCAO
                                         TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-730   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              ELSE
                 IF CMCL0300-INDEOPER EQUAL WS-CON-4 AND
                    CMCL0300-MCAPITAL-S EQUAL WS-CON-1
                    IF AMCV7300-CLIBERAC NOT EQUAL WS-CON-1
                       IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
      *                NÃO VALIDAR P '510'
                          MOVE ATCK0002-ERROS-FUNCAO
                                                TO ATCL0001-IND-ERROS
                          MOVE AMCK0001-CON-994 TO AMCV7301-CTIPSOC-MSG
                          MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
                       ELSE
                          IF AMCV7300-CSUBPROD-S NOT EQUAL
                                              AMCK0004-AUTORIZ-NIVEL-4
                             MOVE ATCK0002-AUTORIZACAO TO
                                              ATCL0001-IND-ERROS
                             MOVE AMCK0001-CON-994 TO
                                              AMCV7301-CBALCAO-MSG
                             MOVE AMCK0004-AUTORIZ-NIVEL-4    TO
                                              AMCV7301-CBALCAO-S
                          END-IF
                       END-IF
                    ELSE
                       MOVE WS-CON-N125  TO WS-MVALOR-MIN
                    END-IF
                 ELSE
                    IF CMCL0300-INDEOPER EQUAL WS-CON-4 AND
                       CMCL0300-MCAPITAL-S EQUAL WS-CON-2
                       IF AMCV7300-CLIBERAC NOT EQUAL WS-CON-1
                          IF ATCL0001-CBALCAO-OPER NOT EQUAL WS-CON-777
      *                   NÃO VALIDAR P '510'
                             MOVE ATCK0002-ERROS-FUNCAO
                                                TO ATCL0001-IND-ERROS
                             MOVE AMCK0001-CON-993
                                                TO AMCV7301-CTIPSOC-MSG
                             MOVE WS-CON-1      TO AMCV7301-CTIPSOC-S
                          ELSE
                             IF AMCV7300-CSUBPROD-S NOT EQUAL
                                            AMCK0004-AUTORIZ-NIVEL-4
                                MOVE ATCK0002-AUTORIZACAO TO
                                                  ATCL0001-IND-ERROS
                                MOVE AMCK0001-CON-993 TO
                                                  AMCV7301-CBALCAO-MSG
                                MOVE AMCK0004-AUTORIZ-NIVEL-4    TO
                                                  AMCV7301-CBALCAO-S
                             END-IF
                          END-IF
                       END-IF
                    END-IF
                 END-IF
              END-IF
           END-IF.
      *
       2245-CALL-CMR00300-MPI-EXIT.
           EXIT.
      ******************************************************************
       2250-LIM-CONJUNTOS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2250-LIM-CONJUNTOS' END-IF.

           MOVE AMCV7300-CPRODUTO       TO AMCL0100-CPRODUTO.
           MOVE SPACES                  TO AMCL0100-CBALCAO.
           MOVE SPACES                  TO AMCL0100-CNUMECTA.
           MOVE SPACES                  TO AMCL0100-CDIGICTA.
           MOVE AMCV7300-CSUBPROD       TO AMCL0100-CSUBPROD.
           MOVE AMCV7300-CMOEDA         TO AMCL0100-CMOEDA.
           MOVE ZEROS                   TO AMCL0100-QAGRAVID.
           MOVE ZEROS                   TO AMCL0100-MCAPITAL.

           MOVE WS-CON-0                TO AMCL0100-GPE-ESP .

           COMPUTE AMCL0100-MCAPITAL = AMCV7301-MCAPITAL
                                     - WS-AMVT0115-MCAPITAL.

           IF AMCV7300-CSUBPROD EQUAL WS-CON-83
           OR AMCV7300-CSUBPROD EQUAL WS-CON-93
           OR AMCV7300-CSUBPROD EQUAL WS-CON-A3
               MOVE ZEROS               TO AMCL0100-QAGRAVID
           ELSE
               MOVE AMCV7300-QAGRAVID   TO AMCL0100-QAGRAVID
           END-IF.

           MOVE AMCV7300-DCONTD         TO AMCL0100-DDIAOP.

           PERFORM 2251-CHAMA-AMCI0100
              THRU 2251-CHAMA-AMCI0100-EXIT.

           IF ATCL0001-SEM-ERROS  OR
              ATCL0001-AUTORIZACAO
              IF AMCL0100-QAGRAVID NOT EQUAL ZEROS
                 MOVE ZEROS        TO AMCL0100-QAGRAVID
                 PERFORM 2251-CHAMA-AMCI0100
                    THRU 2251-CHAMA-AMCI0100-EXIT
              END-IF
           END-IF.
      *
       2259-LIM-CONJUNTOS-EXIT.
           EXIT.
      ******************************************************************
       2251-CHAMA-AMCI0100.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2251-CHAMA-AMCI0100' END-IF.

           PERFORM AMCI0100-ROTINA
              THRU AMCI0100-EXIT.

           IF NOT AMCL0100-SEM-ERROS
              MOVE AMCL0100-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCL0100-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE ATCK0002-ABEND-DB2      TO ATCL0001-IND-ERROS
              MOVE AMCL0100-STATUS         TO AMCV7301-CTIPSOC-S
              MOVE AMCL0100-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
           ELSE
              IF AMCL0100-CRETORNO EQUAL ZEROS
                 IF ATCL0001-CBALCAO-OPER EQUAL WS-CON-777
      *          NÃO VALIDAR P '510'
                    IF AMCV7300-CLIBERAC NOT EQUAL WS-CON-1
                       IF AMCV7300-CSUBPROD EQUAL WS-CON-84 OR WS-CON-A4
                          IF AMCV7300-CDIGISOC-S NOT EQUAL
                             AMCK0004-AUTORIZ-NIVEL-4
                             MOVE WS-CON-AU       TO ATCL0001-IND-ERROS
                             MOVE AMCK0004-AUTORIZ-NIVEL-4
                                                  TO AMCV7301-CDIGISOC-S
                             MOVE AMCK0001-CON-040
                                                TO AMCV7301-CDIGISOC-MSG
                          END-IF
                       ELSE
                          MOVE ATCK0002-ERROS-FUNCAO
                                                TO ATCL0001-IND-ERROS
                          MOVE AMCK0001-CON-040 TO AMCV7301-CDIGISOC-MSG
                          MOVE WS-CON-1         TO AMCV7301-CDIGISOC-S
                       END-IF
                    ELSE
                       IF AMCV7300-CDIGISOC-S NOT EQUAL
                          AMCK0004-AUTORIZ-NIVEL-4
                          MOVE WS-CON-AU        TO ATCL0001-IND-ERROS
                          MOVE AMCK0004-AUTORIZ-NIVEL-4
                                                TO AMCV7301-CDIGISOC-S
                          MOVE AMCK0001-CON-040 TO AMCV7301-CDIGISOC-MSG
                       END-IF
                    END-IF
                 ELSE
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-040      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           END-IF.
      *
       2251-CHAMA-AMCI0100-EXIT.
           EXIT.
      ******************************************************************
       2260-LIM-CONJUNTOS-CTI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2260-LIM-CONJUNTOS-CTI' END-IF.

           INITIALIZE AMCL0100-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE WS-CON-74               TO AMCL0100-CPRODUTO.
           MOVE SPACES                  TO AMCL0100-CBALCAO.
           MOVE SPACES                  TO AMCL0100-CNUMECTA.
           MOVE SPACES                  TO AMCL0100-CDIGICTA.
           MOVE AMCV7300-CMOEDA         TO AMCL0100-CMOEDA.
           MOVE AMCV7301-ZCLIENTE-SOC1  TO AMCL0100-ZCLIENTE.

           COMPUTE AMCL0100-MCAPITAL = AMCV7301-MCAPITAL-CTI
                                     - WS-AMVT0115-MCAPITAL.
           MOVE WS-CON-0                TO AMCL0100-GPE-ESP.

      *    MOVE WS-CON-89               TO AMCL0100-CSUBPROD
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9       TO AMCL0100-CSUBPROD
           ELSE
              MOVE WS-CON-89       TO AMCL0100-CSUBPROD
           END-IF

           MOVE ZEROS                   TO AMCL0100-QAGRAVID

           MOVE AMCV7300-DCONTD         TO AMCL0100-DDIAOP.

           PERFORM 2261-CHAMA-AMCI0100
              THRU 2261-CHAMA-AMCI0100-EXIT.

           IF ATCL0001-SEM-ERROS  OR
              ATCL0001-AUTORIZACAO
              IF AMCL0100-QAGRAVID NOT EQUAL ZEROS
                 MOVE ZEROS        TO AMCL0100-QAGRAVID
                 PERFORM 2261-CHAMA-AMCI0100
                    THRU 2261-CHAMA-AMCI0100-EXIT
              END-IF
           END-IF.
      *
       2269-LIM-CONJUNTOS-CTI-EXIT.
           EXIT.
      ******************************************************************
       2261-CHAMA-AMCI0100.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2261-CHAMA-AMCI0100' END-IF.

           PERFORM AMCI0100-ROTINA
              THRU AMCI0100-EXIT.

           IF NOT AMCL0100-SEM-ERROS
              MOVE AMCL0100-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCL0100-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE ATCK0002-ABEND-DB2      TO ATCL0001-IND-ERROS
              MOVE AMCL0100-STATUS         TO AMCV7301-CTIPSOC-S
              MOVE AMCL0100-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
           ELSE
              IF AMCL0100-CRETORNO EQUAL ZEROS
                 IF ATCL0001-CBALCAO-OPER EQUAL WS-CON-777 AND
      *          NÃO VALIDAR P '510'
                    AMCV7300-CSUBPROD     EQUAL (WS-CON-84 OR WS-CON-A4)
                    IF AMCV7300-CDIGISOC-S NOT EQUAL
                       AMCK0004-AUTORIZ-NIVEL-4
                       MOVE WS-CON-AU          TO ATCL0001-IND-ERROS
                       MOVE AMCK0004-AUTORIZ-NIVEL-4
                                               TO AMCV7301-CDIGISOC-S
                       MOVE AMCK0001-CON-040   TO AMCV7301-CDIGISOC-MSG
                    END-IF
                 ELSE
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-040      TO AMCV7301-CDIGISOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CDIGISOC-S
                 END-IF
              END-IF
           END-IF.
      *
       2261-CHAMA-AMCI0100-EXIT.
           EXIT.
      ******************************************************************
       2270-SOMA-CAPITAL-INSP.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2270-SOMA-CAPITAL-INSP' END-IF.

           MOVE AMCV7300-CTIPSOC  TO AMCL1014-CTIPSOC.
           MOVE AMCV7300-ZSOCIO   TO AMCL1014-ZSOCIO.
           MOVE AMCV7300-CDIGISOC TO AMCL1014-CDIGISOC.
           MOVE AMCV7300-CSUBPROD TO AMCL1014-CSUBPROD1.
           MOVE SPACES            TO AMCL1014-CSUBPROD2
                                     AMCL1014-CSITSUB.
           MOVE ZEROS             TO WS-MCAPITAL-INSP.

      *
           EXEC CICS
               HANDLE CONDITION
               ERROR (9010-ERRO-CICS)
           END-EXEC.

           PERFORM AMCI1014-ROTINA
              THRU AMCI1014-EXIT.

           MOVE AMCL1014-IND-ERROS      TO ATCL0001-IND-ERROS.
           MOVE AMCL1014-NR-ERRO        TO ATCL0001-SQLCODE.
           MOVE AMCL1014-TABLE-NAME     TO ATCL0001-TABLE-NAME.
           IF AMCL1014-STATUS EQUAL SPACES
              MOVE WS-CON-0             TO AMCL1014-STATUS
           END-IF.
           MOVE AMCL1014-STATUS         TO AMCV7301-CTIPSOC-S.
           MOVE AMCL1014-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG.

           IF ATCL0001-SEM-ERROS
              MOVE AMCL1014-MCAPACTU TO WS-MCAPITAL-INSP
              MOVE AMCV7300-CPRODUTO       TO WS-AMVT0115-CPRODUTO
              MOVE AMCV7300-CSUBPROD       TO WS-AMVT0115-CSUBPROD
              PERFORM 9400-OBTER-MCAPITAL
                 THRU 9499-OBTER-MCAPITAL-EXIT
           END-IF.
           IF ATCL0001-SEM-ERROS
              COMPUTE WS-MCAPITAL-INSP =  WS-MCAPITAL-INSP -
                                             WS-AMVT0115-MCAPITAL
           END-IF.
      *
       2279-SOMA-CAPITAL-INSP-EXIT.
           EXIT.
      ******************************************************************
       2270-INSP-MEDICA.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2270-INSP-MEDICA' END-IF.

           MOVE AMCV7300-CPRODUTO     TO CMVT0502-CPRODUTO.
           MOVE AMCV7300-CSUBPROD     TO CMVT0502-CSUBPROD.
           MOVE AMCV7300-CMOEDA       TO CMVT0502-CMOEDA.
      *    MOVE WS-IDADEACT-SOCIO     TO CMVT0502-IDADEMAX.
           MOVE WS-IDADETET-SOCIO-DIA TO CMVT0502-IDADEMAX.
           MOVE AMCV7300-CPLSUBS      TO CMVT0502-CPLSUBS.
           MOVE AMCV7300-TXPROG       TO CMVT0502-TXPROG.
           MOVE ATCL0001-DDIAOP       TO ATCW3000-DATA8   .
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT.
           MOVE ATCW3000-DATA10       TO CMVT0502-DINICIO .
           MOVE ATCW3000-DATA10       TO CMVT0502-DFIM    .

           ADD AMCV7301-MCAPITAL     TO WS-MCAPITAL-INSP
                    GIVING  CMVT0502-MCAPMAX .
           ADD AMCV7301-MCAPITAL     TO WS-MCAPITAL-INSP
                    GIVING  CMVT0502-MCAPMIN .

      *    MOVE WS-IDADEACT-SOCIO     TO CMVT0502-IDADEMIN.
           MOVE WS-IDADETET-SOCIO-DIA TO CMVT0502-IDADEMIN.
           MOVE SPACES                TO CMVT0502-CRISCO  .
           MOVE AMCV7300-CLIBERAC     TO CMVT0502-CLIBERAC.

           EXEC SQL
                OPEN CRS-CMT05
           END-EXEC.

           MOVE WS-CON-CMVT0502  TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT CMVT0502-OK
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              EXEC SQL
                   FETCH CRS-CMT05
                    INTO :CMVT0502-MCAPMAX ,
                         :CMVT0502-CTEXAMED
              END-EXEC

              MOVE WS-CON-CMVT0502      TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF ATCL0001-SEM-ERROS
                 IF NOT CMVT0502-OK AND NOT CMVT0502-NOTFND
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 ELSE

                    PERFORM 2279-10-VALIDA-CTEXAMED
                       THRU 2279-10-VALIDA-CTEXAMED-EXIT

                    MOVE CMVT0502-CTEXAMED    TO WS-CTEXAMED-MAE
                 END-IF
              ELSE
                 MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.
           IF SW-DEBUG-SIM
              DISPLAY 'CMVT0502-CTEXAMED :' CMVT0502-CTEXAMED
              DISPLAY 'AMCV7300-IEMIQCLI :' AMCV7300-IEMIQCLI
           END-IF

           IF ATCL0001-SEM-ERROS AND NOT CMVT0502-NOTFND
              IF CMVT0502-CTEXAMED EQUAL WS-CON-A
      *X92567 - C4570 (I)
              OR AMCV7300-IEMIQCLI EQUAL WS-CON-S
                 MOVE WS-CON-A        TO WS-CTEXAMED-MAE
      *X92567 - C4570 (F)
                 MOVE WS-CON-Q        TO WS-IIMOBRIG-MAE
                 MOVE
                'NECESSÁRIO PREENCHIMENTO DE QUESTIONÁRIO CLÍNICO'
                                      TO AMCV7301-GAVISO-2
              ELSE
                 IF CMVT0502-CTEXAMED NOT EQUAL SPACES AND
                    CMVT0502-CTEXAMED NOT EQUAL 'S'
                    MOVE WS-CON-P        TO WS-IIMOBRIG-MAE
                    MOVE 'INSPECÇÃO MÉDICA PRESENCIAL OBRIGATÓRIA'
                          TO AMCV7301-GAVISO-3
                 END-IF

                 IF CMVT0502-CTEXAMED NOT EQUAL SPACES AND
                    CMVT0502-CTEXAMED EQUAL 'S'
      *            MOVE WS-CON-P        TO WS-IIMOBRIG-MAE
                   MOVE SPACES          TO WS-IIMOBRIG-MAE
                   MOVE 'NECESSÁRIO ASSINAR DEC. DE BOM ESTADO DE SAÚDE'
                          TO AMCV7301-GAVISO-3
                 END-IF
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              EXEC SQL
                  CLOSE CRS-CMT05
              END-EXEC

              MOVE WS-CON-CMVT0502     TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF ATCL0001-SEM-ERROS
                 IF NOT CMVT0502-OK
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.
      *
       2279-INSP-MEDICA-EXIT.
           EXIT.
      ******************************************************************
      *                      9001-10-VALIDA-CTEXAMED
      ******************************************************************
       2279-10-VALIDA-CTEXAMED.
      *
           IF SW-DEBUG-SIM
              DISPLAY 'AMI03060 | 2279-10-VALIDA-CTEXAMED'
           END-IF.
      *
           INITIALIZE DCLAMVT3403-MOTPEND

           MOVE AMCV7300-CBALCAO         TO AMVT3403-CBALCAO.
           MOVE AMCV7300-CPRODUTO        TO AMVT3403-CPRODUTO.
           MOVE AMCV7300-CNUMECTA        TO AMVT3403-CNUMECTA.
           MOVE AMCV7300-CDIGICTA        TO AMVT3403-CDIGICTA.
           MOVE '0'                      TO AMVT3403-IPROCESS.

           EXEC SQL
                SELECT CTEXAMED
                  INTO :AMVT3403-CTEXAMED
                  FROM AMVT3403_MOTPEND
                 WHERE CBALCAO  = :AMVT3403-CBALCAO
                   AND CPRODUTO = :AMVT3403-CPRODUTO
                   AND CNUMECTA = :AMVT3403-CNUMECTA
                   AND CDIGICTA = :AMVT3403-CDIGICTA
                   AND IPROCESS = :AMVT3403-IPROCESS
           END-EXEC.
      *
           MOVE WS-CON-AMVT3403          TO ATCL0001-TABLE-NAME.

           PERFORM 9020-DB2CHECK
              THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF AMVT3403-OK

                 IF AMVT3403-CTEXAMED NOT EQUAL CMVT0502-CTEXAMED

                    MOVE ATCK0002-ABEND-DB2
                                         TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-299
                                         TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1        TO AMCV7301-CTIPSOC-S

                    DISPLAY '9001-10-VALIDA-CTEXAMED '
                    DISPLAY 'CTEXAMED DIFERENTES'
                    DISPLAY 'AMVT3403-CTEXAMED ' AMVT3403-CTEXAMED
                    DISPLAY 'CMVT0502-CTEXAMED ' CMVT0502-CTEXAMED
                    DISPLAY 'AMVT3403-CBALCAO  ' AMVT3403-CBALCAO
                    DISPLAY 'AMVT3403-CPRODUTO ' AMVT3403-CPRODUTO
                    DISPLAY 'AMVT3403-CNUMECTA ' AMVT3403-CNUMECTA
                    DISPLAY 'AMVT3403-IPROCESS ' AMVT3403-IPROCESS

                 END-IF

              ELSE
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-129   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S

                 DISPLAY '9001-10-VALIDA-CTEXAMED '
                 DISPLAY 'ATCW0005-SQLCODE  ' ATCW0005-SQLCODE
                 DISPLAY 'AMVT3403-CBALCAO  ' AMVT3403-CBALCAO
                 DISPLAY 'AMVT3403-CPRODUTO ' AMVT3403-CPRODUTO
                 DISPLAY 'AMVT3403-CNUMECTA ' AMVT3403-CNUMECTA
                 DISPLAY 'AMVT3403-IPROCESS ' AMVT3403-IPROCESS
              END-IF
           ELSE
              MOVE AMCK0001-CON-572      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.

       2279-10-VALIDA-CTEXAMED-EXIT.
           EXIT.
      ******************************************************************
       2280-INSP-MEDICA-CTI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2280-INSP-MEDICA-CTI' END-IF.

           MOVE WS-CON-74             TO CMVT0502-CPRODUTO.
      *    MOVE WS-CON-89             TO CMVT0502-CSUBPROD
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9       TO CMVT0502-CSUBPROD
           ELSE
              MOVE WS-CON-89       TO CMVT0502-CSUBPROD
           END-IF

           MOVE AMCV7300-CMOEDA       TO CMVT0502-CMOEDA.
      *    MOVE WS-IDADEACT-SOCIO     TO CMVT0502-IDADEMAX.
           MOVE WS-IDADETET-SOCIO-DIA TO CMVT0502-IDADEMAX.
           MOVE AMCV7300-CPLSUBS      TO CMVT0502-CPLSUBS.
           MOVE AMCV7300-TXPROG       TO CMVT0502-TXPROG.
           MOVE ATCL0001-DDIAOP       TO ATCW3000-DATA8   .
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT.
           MOVE ATCW3000-DATA10       TO CMVT0502-DINICIO .
           MOVE ATCW3000-DATA10       TO CMVT0502-DFIM    .

           MOVE WS-MCAPITAL-INSP      TO CMVT0502-MCAPMAX .
           MOVE WS-MCAPITAL-INSP      TO CMVT0502-MCAPMIN .

      *    MOVE WS-IDADEACT-SOCIO     TO CMVT0502-IDADEMIN.
           MOVE WS-IDADETET-SOCIO-DIA TO CMVT0502-IDADEMIN.
           MOVE AMCV7300-INDSBPRO-CTI TO CMVT0502-CRISCO  .
           MOVE AMCV7300-CLIBERAC     TO CMVT0502-CLIBERAC.

           EXEC SQL
                OPEN CRS-CMT05
           END-EXEC.

           MOVE WS-CON-CMVT0502  TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT CMVT0502-OK
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              EXEC SQL
                   FETCH CRS-CMT05
                    INTO :CMVT0502-MCAPMAX ,
                         :CMVT0502-CTEXAMED
              END-EXEC

              MOVE WS-CON-CMVT0502      TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF ATCL0001-SEM-ERROS
                 IF NOT CMVT0502-OK AND NOT CMVT0502-NOTFND
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 ELSE
                    MOVE CMVT0502-CTEXAMED    TO WS-CTEXAMED-CTI
                 END-IF
              ELSE
                 MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND NOT CMVT0502-NOTFND
              IF CMVT0502-CTEXAMED EQUAL WS-CON-A
                 MOVE WS-CON-Q        TO WS-IIMOBRIG-CTI
                 MOVE
                'NECESSÁRIO PREENCHIMENTO DE QUESTIONÁRIO CLÍNICO'
                                      TO AMCV7301-GAVISO-2
              ELSE
                 IF CMVT0502-CTEXAMED NOT EQUAL SPACES
                    MOVE WS-CON-P        TO WS-IIMOBRIG-CTI
                    MOVE 'INSPECÇÃO MÉDICA PRESENCIAL OBRIGATÓRIA'
                          TO AMCV7301-GAVISO-3
                 END-IF
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              EXEC SQL
                  CLOSE CRS-CMT05
              END-EXEC

              MOVE WS-CON-CMVT0502     TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF ATCL0001-SEM-ERROS
                 IF NOT CMVT0502-OK
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 MOVE AMCK0001-CON-624   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.
      *
       2289-INSP-MEDICA-CTI-EXIT.
           EXIT.
      ******************************************************************
       2300-ACTUALIZA.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2300-ACTUALIZA' END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2320-FORMATA-AMT01-MAE
                 THRU 2329-FORMATA-AMT01-MAE-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2330-INSERE-AMT30-MAE
                 THRU 2339-INSERE-AMT30-MAE-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2340-INSERE-AMT34
                 THRU 2349-INSERE-AMT34-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2350-UPDATE-AMT01
                 THRU 2359-UPDATE-AMT01-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2360-VERIFICA-REL-CONTAS
                 THRU 2360-VERIFICA-REL-CONTAS-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE AMCV7300-CPRODUTO       TO WS-AMVT0115-CPRODUTO
              MOVE AMCV7300-CSUBPROD       TO WS-AMVT0115-CSUBPROD
              PERFORM 9400-OBTER-MCAPITAL
                 THRU 9499-OBTER-MCAPITAL-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 2390-LIM-CONJUNTOS
                 THRU 2399-LIM-CONJUNTOS-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMCV7300-ICTI EQUAL WS-CON-1

              IF ATCL0001-SEM-ERROS
                 PERFORM 2320-FORMATA-AMT01-CTI
                    THRU 2329-FORMATA-AMT01-CTI-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 PERFORM 2330-INSERE-AMT30-CTI
                    THRU 2339-INSERE-AMT30-CTI-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 PERFORM 2340-INSERE-AMT34
                    THRU 2349-INSERE-AMT34-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 PERFORM 2350-UPDATE-AMT01
                    THRU 2359-UPDATE-AMT01-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 PERFORM 2360-VERIFICA-REL-CONTAS
                    THRU 2360-VERIFICA-REL-CONTAS-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 MOVE WS-CON-74               TO WS-AMVT0115-CPRODUTO
      *          MOVE WS-CON-89               TO WS-AMVT0115-CSUBPROD
                 IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
                    MOVE WS-CON-A9 TO WS-AMVT0115-CSUBPROD
                 ELSE
                    MOVE WS-CON-89 TO WS-AMVT0115-CSUBPROD
                 END-IF
                 PERFORM 9400-OBTER-MCAPITAL
                    THRU 9499-OBTER-MCAPITAL-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 PERFORM 2390-LIM-CONJUNTOS
                    THRU 2399-LIM-CONJUNTOS-EXIT
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS               AND
              AMCV7300-ICS      EQUAL WS-CON-1 AND
             (AMCV7300-CSUBPROD EQUAL WS-CON-83 OR
              AMCV7300-CSUBPROD EQUAL WS-CON-93 OR
              AMCV7300-CSUBPROD EQUAL WS-CON-A3)

              IF ATCL0001-SEM-ERROS
                 PERFORM 2320-FORMATA-AMT01-CS
                    THRU 2329-FORMATA-AMT01-CS-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 PERFORM 2330-INSERE-AMT30-CS
                    THRU 2339-INSERE-AMT30-CS-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 PERFORM 2340-INSERE-AMT34
                    THRU 2349-INSERE-AMT34-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 PERFORM 2350-UPDATE-AMT01
                    THRU 2359-UPDATE-AMT01-EXIT
              END-IF

              IF ATCL0001-SEM-ERROS
                 PERFORM 2360-VERIFICA-REL-CONTAS
                    THRU 2360-VERIFICA-REL-CONTAS-EXIT
              END-IF

           END-IF.

           IF NOT ATCL0001-SEM-ERROS
              MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
           END-IF.
      *
       2399-ACTUALIZA-EXIT.
           EXIT.
      ******************************************************************
       2310-NUMERA-MAE.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2310-NUMERA-MAE' END-IF.

           INITIALIZE ATCL0002-COMMAREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE WS-CON-N1         TO ATCL0002-IND-OPERACAO.
           MOVE ATCL0001-CBALCAO-OPER  TO WS-CBAL.
           MOVE AMCV7300-CPRODUTO TO WS-CPROD.
           MOVE WS-CSEQUEN        TO ATCL0002-CSEQUEN.

           EXEC CICS
               LINK PROGRAM ('ATI99800')
                    COMMAREA (ATCL0002-COMMAREA)
           END-EXEC.

           MOVE ATCL0002-IND-ERROS      TO ATCL0001-IND-ERROS.
           MOVE ATCL0002-COD-ERRO-GRAVE TO ATCL0001-COD-ERRO-GRAVE.

           IF ATCL0001-SEM-ERROS
              MOVE ATCL0002-ZSEQUEN-1 TO WS-ZSEQUEN-1
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE AMCV7300-CPRODUTO     TO DPCW0010-PRODUTO
              MOVE ATCL0001-CBALCAO-OPER TO DPCW0010-BALCAO
              MOVE WS-ZSEQUEN-1          TO DPCW0010-NUMECTA

              PERFORM DPCP0010-CHECK-DIGIT
                 THRU DPCP0010-CHECK-DIGIT-EXIT
           END-IF.
      *
       2319-NUMERA-MAE-EXIT.
           EXIT.
      ******************************************************************
       2310-NUMERA-CTI-CS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2310-NUMERA-CTI-CS' END-IF.

           INITIALIZE ATCL0002-COMMAREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE WS-CON-N1         TO ATCL0002-IND-OPERACAO.
           MOVE ATCL0001-CBALCAO-OPER  TO WS-CBAL.
           MOVE WS-CON-74         TO WS-CPROD.
           MOVE WS-CSEQUEN        TO ATCL0002-CSEQUEN.

           EXEC CICS
               LINK PROGRAM ('ATI99800')
                    COMMAREA (ATCL0002-COMMAREA)
           END-EXEC.

           MOVE ATCL0002-IND-ERROS      TO ATCL0001-IND-ERROS.
           MOVE ATCL0002-COD-ERRO-GRAVE TO ATCL0001-COD-ERRO-GRAVE.

           IF ATCL0001-SEM-ERROS
              MOVE ATCL0002-ZSEQUEN-1 TO WS-ZSEQUEN-1
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE WS-CON-74             TO DPCW0010-PRODUTO
              MOVE ATCL0001-CBALCAO-OPER TO DPCW0010-BALCAO
              MOVE WS-ZSEQUEN-1          TO DPCW0010-NUMECTA

              PERFORM DPCP0010-CHECK-DIGIT
                 THRU DPCP0010-CHECK-DIGIT-EXIT
           END-IF.
      *
       2319-NUMERA-CTI-CS-EXIT.
           EXIT.
      ******************************************************************
       2320-FORMATA-AMT01-MAE.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2320-FORMATA-AMT01-MAE' END-IF.

           MOVE AMCV7301-CPRODUTO      TO AMVT0115-CPRODUTO.
           MOVE AMVT0115-CPRODUTO      TO WS-CPRODUTO-MAE.
           MOVE AMCV7301-CBALCAO       TO AMVT0115-CBALCAO.
           MOVE AMVT0115-CBALCAO       TO WS-CBALCAO-MAE.
           MOVE AMCV7301-CNUMECTA      TO AMVT0115-CNUMECTA.
           MOVE AMVT0115-CNUMECTA      TO WS-CNUMECTA-MAE.
           MOVE AMCV7301-CDIGICTA      TO AMVT0115-CDIGICTA.
           MOVE AMVT0115-CDIGICTA      TO WS-CDIGICTA-MAE.
           MOVE AMCV7301-CSUBPROD      TO AMVT0115-CSUBPROD.
           MOVE AMCV7301-CTIPSOC       TO AMVT0115-CTIPSOC .
           MOVE AMCV7301-ZSOCIO        TO AMVT0115-ZSOCIO .
           MOVE AMCV7301-CDIGISOC      TO AMVT0115-CDIGISOC.
           MOVE AMCV7301-ZINSCRIC      TO AMVT0115-ZINSCRIC.

           IF AMCV7300-CLIBERAC EQUAL ZEROS
              MOVE WS-CON-00           TO AMVT0115-CSITSUB
           ELSE
              MOVE WS-CON-08           TO AMVT0115-CSITSUB
           END-IF.
           MOVE WS-IDADETET-SOCIO      TO AMVT0115-IDADECRO.
           MOVE AMCV7301-DNASCIM-SOC1  TO ATCW3000-DATA8 .
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT .
           MOVE ATCW3000-DATA10        TO AMVT0115-DNASCIM .
           IF AMCV7301-DNASCIM-BEN NOT EQUAL SPACES
              MOVE AMCV7301-DNASCIM-BEN   TO ATCW3000-DATA8
              PERFORM ATCP6000-CONV-DATA810
                 THRU ATCP6000-CONV-DATA810-EXIT
              MOVE ATCW3000-DATA10        TO AMVT0115-DNASCIMB
           ELSE
              MOVE WS-CON-0001-01-01      TO AMVT0115-DNASCIMB
           END-IF.
           MOVE WS-IDADEACT-SOCIO      TO AMVT0115-IDADEACT.
           MOVE WS-IDADEACT-BEN        TO AMVT0115-IDADAIBP.

           MOVE AMCV7301-CODPER        TO AMVT0115-CODPER .
           MOVE AMCV7301-DCONTD        TO ATCW3000-DATA8 .
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT .
           MOVE ATCW3000-DATA10        TO AMVT0115-DCONTD .
           IF AMCV7300-CLIBERAC EQUAL WS-CON-1
              MOVE AMVT0115-DCONTD     TO AMVT0115-DULTLIB
           ELSE
              MOVE WS-CON-0001-01-01   TO AMVT0115-DULTLIB
           END-IF.
           IF AMCV7300-CLIBERAC EQUAL WS-CON-1
              MOVE WS-CON-0001-01-01   TO AMVT0115-DFIMCOBQ
           ELSE
              MOVE WS-DFIMCOBQ-MAE     TO AMVT0115-DFIMCOBQ
           END-IF
           MOVE WS-DTVENCIM-MAE        TO AMVT0115-DTVENCIM.
           MOVE ZEROS                  TO AMVT0115-MQTSUPL .
           MOVE CMVT1300-PERCAGQT      TO AMVT0115-PERCAGQT.
           IF AMCV7300-CSUBPROD EQUAL WS-CON-83
           OR AMCV7300-CSUBPROD EQUAL WS-CON-93
           OR AMCV7300-CSUBPROD EQUAL WS-CON-A3
              MOVE ZEROS               TO AMVT0115-QAGRAVID
           ELSE
              MOVE AMCV7301-QAGRAVID   TO AMVT0115-QAGRAVID
           END-IF.
           MOVE WS-QPRAZO-MAE          TO AMVT0115-QPRAZO .
           MOVE AMCV7301-MCAPITAL      TO AMVT0115-MCAPITAL.
           MOVE AMCV7301-MCAPITAL      TO AMVT0115-MCAPACTU.
           MOVE AMCV7301-MQUOTAIN      TO AMVT0115-MQUOTAIN.
           MOVE AMCV7301-MQUOTAIN      TO AMVT0115-MQUOTAAC.
           MOVE AMCV7301-CBALSUB       TO AMVT0115-CBALSUB.
           MOVE AMCV7301-CPRDSUB       TO AMVT0115-CPRDSUB.
           MOVE AMCV7301-CCTASUB       TO AMVT0115-CCTASUB.
           MOVE AMCV7301-CDIGSUB       TO AMVT0115-CDIGSUB.
      * C82065(I)
           MOVE AMCV7301-CPAISIBSB     TO AMVT0115-CPAISIBSB.
           MOVE AMCV7301-CBANIBSB      TO AMVT0115-CBANIBSB .
           MOVE AMCV7301-CCTAIBSB      TO AMVT0115-CCTAIBSB .
           MOVE AMCV7301-CDIGIBSB      TO AMVT0115-CDIGIBSB .
      * C82065(F)
      * ALT02 (I)
           MOVE WS-IDADEACT-DTVENCIM   TO AMVT0115-IDADRECB.
           MOVE AMCV7301-QIDRFSOL      TO AMVT0115-QIDRFSOL.
      * ALT02 (F)
      *PDI-C138491
           IF ATCL0001-CBALCAO-OPER = '510'
           OR ATCL0001-CBALCAO-OPER = '777'
              MOVE AMCV7301-CGESTMUT   TO AMVT0115-CGESTMUT
           END-IF.

      *C123517 - INI AQUI
           IF AMCV7301-CBANIBSQ = AMCK0002-CON-CBANCO-MG
              IF WS-CTIPCLI-ZCLIEMP NOT EQUAL WS-CON-E
      *c         iban-mg-particulares
                 MOVE '0'               TO AMVT0115-IPAGAEMP
                 MOVE ZEROS             TO AMVT0115-ZCLIEMP
                 MOVE ZEROS             TO AMCV7301-ZCLIEMP
              ELSE
      *c      IF WS-CTIPCLI-ZCLIEMP = WS-CON-E
      *c         iban-mg-empresas
                 MOVE '1'               TO AMVT0115-IPAGAEMP
              END-IF
           ELSE
      *c   OIC
              IF AMCV7301-ZCLIEMP = ZEROS
                 MOVE '0'               TO AMVT0115-IPAGAEMP
                 MOVE ZEROS             TO AMVT0115-ZCLIEMP
                 MOVE ZEROS             TO AMCV7301-ZCLIEMP
              ELSE
                 IF WS-CTIPCLI-ZCLIEMP = WS-CON-E
                    MOVE '1'              TO AMVT0115-IPAGAEMP
      **            MOVE AMCV7301-ZCLIEMP TO AMVT0115-ZCLIEMP
                 ELSE
                    MOVE '0'            TO AMVT0115-IPAGAEMP
                    MOVE ZEROS          TO AMVT0115-ZCLIEMP
                    MOVE ZEROS          TO AMCV7301-ZCLIEMP
                 END-IF
              END-IF
           END-IF
           IF SW-DEBUG-SIM
              DISPLAY 'C123517 1 - AMCV7301-CBANIBSQ = '
                                   AMCV7301-CBANIBSQ
                      ' WS-CTIPCLI-ZCLIEMP = ' WS-CTIPCLI-ZCLIEMP
              DISPLAY 'C123517 1 - AMVT0115-IPAGAEMP = '
                                   AMVT0115-IPAGAEMP
                      ' AMVT0115-ZCLIEMP = ' AMVT0115-ZCLIEMP
           END-IF.
      *C123517 - fim
      *
       2329-FORMATA-AMT01-MAE-EXIT.
           EXIT.
      ******************************************************************
       2320-FORMATA-AMT01-CTI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2320-FORMATA-AMT01-CTI' END-IF.

           MOVE AMCV7301-CTIPSOC       TO AMVT0115-CTIPSOC .
           MOVE AMCV7301-ZSOCIO        TO AMVT0115-ZSOCIO  .
           MOVE AMCV7301-CDIGISOC      TO AMVT0115-CDIGISOC.
           MOVE AMCV7301-ZINSCRIC      TO AMVT0115-ZINSCRIC.
           MOVE WS-CON-74              TO AMVT0115-CPRODUTO.
      *    MOVE WS-CON-89              TO AMVT0115-CSUBPROD.
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9       TO AMVT0115-CSUBPROD
           ELSE
              MOVE WS-CON-89       TO AMVT0115-CSUBPROD
           END-IF

           EXEC SQL
                   SELECT CPRODUTO  ,
                          CBALCAO   ,
                          CNUMECTA  ,
                          CDIGICTA
                   INTO  :AMVT0115-CPRODUTO  ,
                         :AMVT0115-CBALCAO   ,
                         :AMVT0115-CNUMECTA  ,
                         :AMVT0115-CDIGICTA
                    FROM AMVT0115_BASIOPER
                   WHERE CTIPSOC  = :AMVT0115-CTIPSOC
                     AND ZSOCIO   = :AMVT0115-ZSOCIO
                     AND CDIGISOC = :AMVT0115-CDIGISOC
                     AND CPRODUTO = :AMVT0115-CPRODUTO
                     AND CSUBPROD = :AMVT0115-CSUBPROD
                     AND ZINSCRIC = :AMVT0115-ZINSCRIC
           END-EXEC.

           MOVE WS-CON-AMVT0115        TO ATCL0001-TABLE-NAME
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT0115-OK
                 MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-500    TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-500    TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
           END-IF.

           IF AMCV7300-CLIBERAC EQUAL ZEROS
              MOVE WS-CON-00           TO AMVT0115-CSITSUB
           ELSE
              MOVE WS-CON-08           TO AMVT0115-CSITSUB
           END-IF.

           MOVE WS-IDADETET-SOCIO      TO AMVT0115-IDADECRO.
           MOVE AMCV7301-DNASCIM-SOC1  TO ATCW3000-DATA8 .
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT .
           MOVE ATCW3000-DATA10        TO AMVT0115-DNASCIM .
           MOVE WS-CON-0001-01-01      TO AMVT0115-DNASCIMB.
           MOVE WS-IDADEACT-SOCIO      TO AMVT0115-IDADEACT.
           MOVE ZEROS                  TO AMVT0115-IDADAIBP.

           MOVE AMCV7301-CODPER        TO AMVT0115-CODPER .
           MOVE AMCV7301-DCONTD        TO ATCW3000-DATA8 .
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT .
           MOVE ATCW3000-DATA10        TO AMVT0115-DCONTD .
           IF AMCV7300-CLIBERAC EQUAL WS-CON-1
              MOVE AMVT0115-DCONTD     TO AMVT0115-DULTLIB
           ELSE
              MOVE WS-CON-0001-01-01   TO AMVT0115-DULTLIB
           END-IF.
           IF AMCV7300-CLIBERAC EQUAL WS-CON-1
              MOVE WS-CON-0001-01-01   TO AMVT0115-DFIMCOBQ
           ELSE
              MOVE WS-DFIMCOBQ-CTI     TO AMVT0115-DFIMCOBQ
           END-IF.
           MOVE WS-DTVENCIM-CTI        TO AMVT0115-DTVENCIM.
           MOVE ZEROS                  TO AMVT0115-MQTSUPL .
           MOVE ZEROS                  TO AMVT0115-PERCAGQT.
           MOVE ZEROS                  TO AMVT0115-QAGRAVID
           MOVE WS-QPRAZO-CTI          TO AMVT0115-QPRAZO .
           MOVE AMCV7301-MCAPITAL-CTI  TO AMVT0115-MCAPITAL.
           MOVE AMCV7301-MCAPITAL-CTI  TO AMVT0115-MCAPACTU.
           MOVE AMCV7301-MQUOTAIN-CTI  TO AMVT0115-MQUOTAIN.
           MOVE AMCV7301-MQUOTAIN-CTI  TO AMVT0115-MQUOTAAC.
           MOVE AMCV7301-CBALSUB       TO AMVT0115-CBALSUB.
           MOVE AMCV7301-CPRDSUB       TO AMVT0115-CPRDSUB.
           MOVE AMCV7301-CCTASUB       TO AMVT0115-CCTASUB.
           MOVE AMCV7301-CDIGSUB       TO AMVT0115-CDIGSUB.
      * C82065(I)
           MOVE AMCV7301-CPAISIBSB     TO AMVT0115-CPAISIBSB.
           MOVE AMCV7301-CBANIBSB      TO AMVT0115-CBANIBSB .
           MOVE AMCV7301-CCTAIBSB      TO AMVT0115-CCTAIBSB .
           MOVE AMCV7301-CDIGIBSB      TO AMVT0115-CDIGIBSB .
      * C82065(F)
      * ALT02 (I)
           MOVE WS-IDADEACT-DTVENCIM   TO AMVT0115-IDADRECB.
           MOVE AMCV7301-QIDRFSOL      TO AMVT0115-QIDRFSOL.
      * ALT02 (F)
      *PDI-C138491
           IF ATCL0001-CBALCAO-OPER = '510'
           OR ATCL0001-CBALCAO-OPER = '777'
              MOVE AMCV7301-CGESTMUT   TO AMVT0115-CGESTMUT
           END-IF.

      *C123517 - INI AQUI
           IF AMCV7301-CBANIBSQ = AMCK0002-CON-CBANCO-MG
              IF WS-CTIPCLI-ZCLIEMP NOT EQUAL WS-CON-E
      *c         iban-mg-particulares
                 MOVE '0'               TO AMVT0115-IPAGAEMP
                 MOVE ZEROS             TO AMVT0115-ZCLIEMP
                 MOVE ZEROS             TO AMCV7301-ZCLIEMP
              ELSE
      *c      IF WS-CTIPCLI-ZCLIEMP = WS-CON-E
      *c         iban-mg-empresas
                 MOVE '1'               TO AMVT0115-IPAGAEMP
              END-IF
           ELSE
      *c   OIC
              IF AMCV7301-ZCLIEMP = ZEROS
                 MOVE '0'               TO AMVT0115-IPAGAEMP
                 MOVE ZEROS             TO AMVT0115-ZCLIEMP
                 MOVE ZEROS             TO AMCV7301-ZCLIEMP
              ELSE
                 IF WS-CTIPCLI-ZCLIEMP = WS-CON-E
                    MOVE '1'              TO AMVT0115-IPAGAEMP
      **            MOVE AMCV7301-ZCLIEMP TO AMVT0115-ZCLIEMP
                 ELSE
                    MOVE '0'            TO AMVT0115-IPAGAEMP
                    MOVE ZEROS          TO AMVT0115-ZCLIEMP
                    MOVE ZEROS          TO AMCV7301-ZCLIEMP
                 END-IF
              END-IF
           END-IF
           IF SW-DEBUG-SIM
              DISPLAY 'C123517 1 - AMCV7301-CBANIBSQ = '
                                   AMCV7301-CBANIBSQ
                      ' WS-CTIPCLI-ZCLIEMP = ' WS-CTIPCLI-ZCLIEMP
              DISPLAY 'C123517 1 - AMVT0115-IPAGAEMP = '
                                   AMVT0115-IPAGAEMP
                      ' AMVT0115-ZCLIEMP = ' AMVT0115-ZCLIEMP
           END-IF.
      *C123517 - fim
      *
       2329-FORMATA-AMT01-CTI-EXIT.
           EXIT.
      ******************************************************************
       2320-FORMATA-AMT01-CS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2320-FORMATA-AMT01-CS' END-IF.

           MOVE AMCV7301-CTIPSOC       TO AMVT0115-CTIPSOC .
           MOVE AMCV7301-ZSOCIO        TO AMVT0115-ZSOCIO  .
           MOVE AMCV7301-CDIGISOC      TO AMVT0115-CDIGISOC.
           MOVE AMCV7301-ZINSCRIC      TO AMVT0115-ZINSCRIC.
           MOVE WS-CON-74              TO AMVT0115-CPRODUTO.
      *    MOVE WS-CON-91              TO AMVT0115-CSUBPROD.
           IF AMCV7301-CSUBPROD = 'A3'
              MOVE WS-CON-A0       TO AMVT0115-CSUBPROD
           ELSE
              MOVE WS-CON-91       TO AMVT0115-CSUBPROD
           END-IF

           EXEC SQL
                   SELECT CPRODUTO  ,
                          CBALCAO   ,
                          CNUMECTA  ,
                          CDIGICTA
                   INTO  :AMVT0115-CPRODUTO  ,
                         :AMVT0115-CBALCAO   ,
                         :AMVT0115-CNUMECTA  ,
                         :AMVT0115-CDIGICTA
                    FROM AMVT0115_BASIOPER
                   WHERE CTIPSOC  = :AMVT0115-CTIPSOC
                     AND ZSOCIO   = :AMVT0115-ZSOCIO
                     AND CDIGISOC = :AMVT0115-CDIGISOC
                     AND CPRODUTO = :AMVT0115-CPRODUTO
                     AND CSUBPROD = :AMVT0115-CSUBPROD
                     AND ZINSCRIC = :AMVT0115-ZINSCRIC
           END-EXEC.

           MOVE WS-CON-AMVT0115        TO ATCL0001-TABLE-NAME
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT0115-OK
                 MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-500    TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-500    TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
           END-IF.

           IF AMCV7300-CLIBERAC EQUAL ZEROS
              MOVE WS-CON-00           TO AMVT0115-CSITSUB
           ELSE
              MOVE WS-CON-08           TO AMVT0115-CSITSUB
           END-IF.
           MOVE WS-IDADETET-SOCIO      TO AMVT0115-IDADECRO.
           MOVE AMCV7301-DNASCIM-SOC1  TO ATCW3000-DATA8 .
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT .
           MOVE ATCW3000-DATA10        TO AMVT0115-DNASCIM .
           MOVE WS-CON-0001-01-01      TO AMVT0115-DNASCIMB
           MOVE WS-IDADEACT-SOCIO      TO AMVT0115-IDADEACT.
           MOVE ZEROS                  TO AMVT0115-IDADAIBP.
           MOVE AMCV7301-CODPER        TO AMVT0115-CODPER .
           MOVE AMCV7301-DCONTD        TO ATCW3000-DATA8 .
           PERFORM ATCP6000-CONV-DATA810
              THRU ATCP6000-CONV-DATA810-EXIT .
           MOVE ATCW3000-DATA10        TO AMVT0115-DCONTD .
           IF AMCV7300-CLIBERAC EQUAL WS-CON-1
              MOVE AMVT0115-DCONTD     TO AMVT0115-DULTLIB
           ELSE
              MOVE WS-CON-0001-01-01   TO AMVT0115-DULTLIB
           END-IF.
           IF AMCV7300-CLIBERAC EQUAL WS-CON-1
              MOVE WS-CON-0001-01-01   TO AMVT0115-DFIMCOBQ
           ELSE
              MOVE WS-DFIMCOBQ-CS      TO AMVT0115-DFIMCOBQ
           END-IF.
           MOVE WS-DTVENCIM-CS         TO AMVT0115-DTVENCIM.
           MOVE ZEROS                  TO AMVT0115-MQTSUPL .
           MOVE ZEROS                  TO AMVT0115-PERCAGQT.
           MOVE ZEROS                  TO AMVT0115-QAGRAVID
           MOVE WS-QPRAZO-CS           TO AMVT0115-QPRAZO .
           MOVE ZEROS                  TO AMVT0115-MCAPITAL.
           MOVE ZEROS                  TO AMVT0115-MCAPACTU.
           MOVE AMCV7301-MQUOTAIN-CS   TO AMVT0115-MQUOTAIN.
           MOVE AMCV7301-MQUOTAIN-CS   TO AMVT0115-MQUOTAAC.
           MOVE AMCV7301-CBALSUB       TO AMVT0115-CBALSUB.
           MOVE AMCV7301-CPRDSUB       TO AMVT0115-CPRDSUB.
           MOVE AMCV7301-CCTASUB       TO AMVT0115-CCTASUB.
           MOVE AMCV7301-CDIGSUB       TO AMVT0115-CDIGSUB.
      * C82065(I)
           MOVE AMCV7301-CPAISIBSB     TO AMVT0115-CPAISIBSB.
           MOVE AMCV7301-CBANIBSB      TO AMVT0115-CBANIBSB .
           MOVE AMCV7301-CCTAIBSB      TO AMVT0115-CCTAIBSB .
           MOVE AMCV7301-CDIGIBSB      TO AMVT0115-CDIGIBSB .
      * C82065(F)
      * ALT02 (I)
           MOVE WS-IDADEACT-DTVENCIM   TO AMVT0115-IDADRECB.
           MOVE AMCV7301-QIDRFSOL      TO AMVT0115-QIDRFSOL.
      * ALT02 (F)
      *
      *C138491
           IF ATCL0001-CBALCAO-OPER = '510'
           OR ATCL0001-CBALCAO-OPER = '777'
              MOVE AMCV7301-CGESTMUT   TO AMVT0115-CGESTMUT
           END-IF.

      *C123517 - INI AQUI
           IF AMCV7301-CBANIBSQ = AMCK0002-CON-CBANCO-MG
              IF WS-CTIPCLI-ZCLIEMP NOT EQUAL WS-CON-E
      *c         iban-mg-particulares
                 MOVE '0'               TO AMVT0115-IPAGAEMP
                 MOVE ZEROS             TO AMVT0115-ZCLIEMP
                 MOVE ZEROS             TO AMCV7301-ZCLIEMP
              ELSE
      *c      IF WS-CTIPCLI-ZCLIEMP = WS-CON-E
      *c         iban-mg-empresas
                 MOVE '1'               TO AMVT0115-IPAGAEMP
              END-IF
           ELSE
      *c   OIC
              IF AMCV7301-ZCLIEMP = ZEROS
                 MOVE '0'               TO AMVT0115-IPAGAEMP
                 MOVE ZEROS             TO AMVT0115-ZCLIEMP
                 MOVE ZEROS             TO AMCV7301-ZCLIEMP
              ELSE
                 IF WS-CTIPCLI-ZCLIEMP = WS-CON-E
                    MOVE '1'              TO AMVT0115-IPAGAEMP
      **            MOVE AMCV7301-ZCLIEMP TO AMVT0115-ZCLIEMP
                 ELSE
                    MOVE '0'            TO AMVT0115-IPAGAEMP
                    MOVE ZEROS          TO AMVT0115-ZCLIEMP
                    MOVE ZEROS          TO AMCV7301-ZCLIEMP
                 END-IF
              END-IF
           END-IF
           IF SW-DEBUG-SIM
              DISPLAY 'C123517 1 - AMCV7301-CBANIBSQ = '
                                   AMCV7301-CBANIBSQ
                      ' WS-CTIPCLI-ZCLIEMP = ' WS-CTIPCLI-ZCLIEMP
              DISPLAY 'C123517 1 - AMVT0115-IPAGAEMP = '
                                   AMVT0115-IPAGAEMP
                      ' AMVT0115-ZCLIEMP = ' AMVT0115-ZCLIEMP
           END-IF.
      *C123517 - fim
      *
       2329-FORMATA-AMT01-CS-EXIT.
           EXIT.
      ******************************************************************
       2330-INSERE-AMT30-MAE.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2330-INSERE-AMT30-MAE' END-IF.

           MOVE AMCV7300-CTIPSOC        TO WS-AMT01-CTIPSOC .
           MOVE AMCV7300-ZSOCIO         TO WS-AMT01-ZSOCIO  .
           MOVE AMCV7300-CDIGISOC       TO WS-AMT01-CDIGISOC.
           MOVE AMCV7300-ZINSCRIC       TO WS-AMT01-ZINSCRIC.
           MOVE AMCV7300-CSUBPROD       TO WS-AMT01-CSUBPROD.

           EXEC SQL
                SELECT  ZMOVCTA ,
                        DDIAOP  ,
                        DDIAVL  ,
                        DCONTD  ,
                        MMOVIM  ,
                        MCAPITAL,
                        MCAPACTU,
                        MQUOTAIN,
                        MQUOTAAC,
                        QAGRAVID,
                        QPRAZO  ,
                        CLIBERAC,
                        CBALSAQ ,
                        CPRODSAQ,
                        CCNTSAQ ,
                        CDIGISAQ,
      * C82065(I)
                        CPAISIBSQ,
                        CBANIBSQ,
                        CCTAIBSQ,
                        CDIGIBSQ
      * C82065(F)
                  INTO :WS-AMT30-ZMOVCTA ,
                       :WS-AMT30-DDIAOP  ,
                       :WS-AMT30-DDIAVL  ,
                       :WS-AMT30-DCONTD  ,
                       :WS-AMT30-MMOVIM  ,
                       :WS-AMT30-MCAPITAL,
                       :WS-AMT30-MCAPACTU,
                       :WS-AMT30-MQUOTAIN,
                       :WS-AMT30-MQUOTAAC,
                       :WS-AMT30-QAGRAVID,
                       :WS-AMT30-QPRAZO  ,
                       :WS-AMT30-CLIBERAC,
                       :WS-AMT30-CBALSAQ ,
                       :WS-AMT30-CPRODSAQ,
                       :WS-AMT30-CCNTSAQ ,
                       :WS-AMT30-CDIGISAQ,

      * C82065(I)
                       :WS-AMT30-CPAISIBSQ,
                       :WS-AMT30-CBANIBSQ,
                       :WS-AMT30-CCTAIBSQ,
                       :WS-AMT30-CDIGIBSQ
      * C82065(F)
                  FROM  AMVT3008_HISTOPER
                 WHERE  CPRODUTO = :AMVT0115-CPRODUTO
                   AND  CBALCAO  = :AMVT0115-CBALCAO
                   AND  CNUMECTA = :AMVT0115-CNUMECTA
                   AND  CDIGICTA = :AMVT0115-CDIGICTA
                   AND  ZMOVCTA  = 1
           END-EXEC.

           MOVE WS-CON-AMVT3008 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT3008-OK
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-556   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-556      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE AMVT0115-CPRODUTO  TO AMVT3008-CPRODUTO
              MOVE AMVT0115-CBALCAO   TO AMVT3008-CBALCAO
              MOVE AMVT0115-CNUMECTA  TO AMVT3008-CNUMECTA
              MOVE AMVT0115-CDIGICTA  TO AMVT3008-CDIGICTA
              MOVE AMVT0115-DCONTD    TO AMVT3008-DCONTD
              MOVE AMCV7301-MMOVIM    TO AMVT3008-MMOVIM
              MOVE AMVT0115-MCAPITAL  TO AMVT3008-MCAPITAL
              MOVE AMVT0115-MCAPACTU  TO AMVT3008-MCAPACTU
              MOVE AMVT0115-MQUOTAIN  TO AMVT3008-MQUOTAIN
              MOVE AMVT0115-MQUOTAAC  TO AMVT3008-MQUOTAAC
              MOVE AMVT0115-QAGRAVID  TO AMVT3008-QAGRAVID
              MOVE AMVT0115-QPRAZO    TO AMVT3008-QPRAZO
              MOVE AMCV7300-CLIBERAC  TO AMVT3008-CLIBERAC

              MOVE WS-AMT30-CBALSAQ   TO WS-CBALSAQ-CAT-ANT
              MOVE WS-AMT30-CPRODSAQ  TO WS-CPRODSAQ-CAT-ANT
              MOVE WS-AMT30-CCNTSAQ   TO WS-CCNTSAQ-CAT-ANT
              MOVE WS-AMT30-CDIGISAQ  TO WS-CDIGISAQ-CAT-ANT
      * C82065(I)
              MOVE WS-AMT30-CPAISIBSQ TO WS-CPAISIBSQ-CAT-ANT
              MOVE WS-AMT30-CBANIBSQ  TO WS-CBANIBSQ-CAT-ANT
              MOVE WS-AMT30-CCTAIBSQ  TO WS-CCTAIBSQ-CAT-ANT
              MOVE WS-AMT30-CDIGIBSQ  TO WS-CDIGIBSQ-CAT-ANT
      * C82065(F)
              MOVE AMCV7300-CBALSAQ   TO AMVT3008-CBALSAQ
              MOVE AMCV7300-CPRODSAQ  TO AMVT3008-CPRODSAQ
              MOVE AMCV7300-CCNTSAQ   TO AMVT3008-CCNTSAQ
              MOVE AMCV7300-CDIGISAQ  TO AMVT3008-CDIGISAQ
      * C82065(I)
              MOVE AMCV7300-CPAISIBSQ TO AMVT3008-CPAISIBSQ
              MOVE AMCV7300-CBANIBSQ  TO AMVT3008-CBANIBSQ
              MOVE AMCV7300-CCTAIBSQ  TO AMVT3008-CCTAIBSQ
              MOVE AMCV7300-CDIGIBSQ  TO AMVT3008-CDIGIBSQ
      * C82065(F)

              EXEC SQL
                 UPDATE AMVT3008_HISTOPER
                   SET
                        DCONTD   = :AMVT3008-DCONTD    ,
                        MMOVIM   = :AMVT3008-MMOVIM    ,
                        MCAPITAL = :AMVT3008-MCAPITAL  ,
                        MCAPACTU = :AMVT3008-MCAPACTU  ,
                        MQUOTAIN = :AMVT3008-MQUOTAIN  ,
                        MQUOTAAC = :AMVT3008-MQUOTAAC  ,
                        QAGRAVID = :AMVT3008-QAGRAVID  ,
                        QPRAZO   = :AMVT3008-QPRAZO    ,
                        CLIBERAC = :AMVT3008-CLIBERAC  ,
                        CBALSAQ  = :AMVT3008-CBALSAQ   ,
                        CPRODSAQ = :AMVT3008-CPRODSAQ  ,
                        CCNTSAQ  = :AMVT3008-CCNTSAQ   ,
                        CDIGISAQ = :AMVT3008-CDIGISAQ  ,
      * C82065(I)
                        CPAISIBSQ= :AMVT3008-CPAISIBSQ ,
                        CBANIBSQ = :AMVT3008-CBANIBSQ  ,
                        CCTAIBSQ = :AMVT3008-CCTAIBSQ  ,
                        CDIGIBSQ = :AMVT3008-CDIGIBSQ
      * C82065(F)
                  WHERE CBALCAO  = :AMVT3008-CBALCAO
                    AND CPRODUTO = :AMVT3008-CPRODUTO
                    AND CNUMECTA = :AMVT3008-CNUMECTA
                    AND CDIGICTA = :AMVT3008-CDIGICTA
              END-EXEC

              MOVE WS-CON-AMVT3008        TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF ATCL0001-SEM-ERROS
                 IF NOT AMVT3008-OK
                    MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-558    TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 MOVE AMCK0001-CON-558    TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF WS-AMT30-MMOVIM   NOT EQUAL AMVT3008-MMOVIM   OR
                 WS-AMT30-MQUOTAAC NOT EQUAL AMVT3008-MQUOTAAC
                 MOVE WS-CON-S            TO SWITCH-ALTERA-CATIVO
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-DCONTD   NOT EQUAL WS-AMT30-DCONTD
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-DCONTD           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-DCONTD         TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-DCONTD         TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MMOVIM   NOT EQUAL WS-AMT30-MMOVIM
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MMOVIM           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MMOVIM         TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MMOVIM         TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MCAPITAL NOT EQUAL WS-AMT30-MCAPITAL
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MCAPITAL         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MCAPITAL       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MCAPITAL       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MCAPACTU NOT EQUAL WS-AMT30-MCAPACTU
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MCAPACTU         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MCAPACTU       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MCAPACTU       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MQUOTAIN NOT EQUAL WS-AMT30-MQUOTAIN
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MQUOTAIN         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MQUOTAIN       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MQUOTAIN       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MQUOTAAC NOT EQUAL WS-AMT30-MQUOTAAC
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MQUOTAAC         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MQUOTAAC       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MQUOTAAC       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-QAGRAVID NOT EQUAL WS-AMT30-QAGRAVID
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-QAGRAVID         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-QAGRAVID       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-QAGRAVID       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-QPRAZO   NOT EQUAL WS-AMT30-QPRAZO
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-QPRAZO           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-QPRAZO         TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-QPRAZO         TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-CLIBERAC NOT EQUAL WS-AMT30-CLIBERAC
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-CLIBERAC         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-CLIBERAC       TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-CLIBERAC       TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMVT0115-CEMPSEC NOT EQUAL ZEROS
                 IF AMVT3008-MMOVIM NOT EQUAL ZEROS
                    MOVE AMVT3008-MMOVIM     TO WS-TOTAL-MAE
                 ELSE
                    MOVE ZEROS               TO WS-TOTAL-MAE
                 END-IF
              ELSE
                 MOVE AMVT3008-MMOVIM        TO WS-TOTAL-MAE
                 ADD  AMVT3008-MQUOTAAC      TO WS-TOTAL-MAE
              END-IF
           END-IF.
      *
       2339-INSERE-AMT30-MAE-EXIT.
           EXIT.
      ******************************************************************
       2330-INSERE-AMT30-CTI.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2330-INSERE-AMT30-CTI' END-IF.

           MOVE AMCV7300-CTIPSOC        TO WS-AMT01-CTIPSOC .
           MOVE AMCV7300-ZSOCIO         TO WS-AMT01-ZSOCIO  .
           MOVE AMCV7300-CDIGISOC       TO WS-AMT01-CDIGISOC.
           MOVE AMCV7300-ZINSCRIC       TO WS-AMT01-ZINSCRIC.
      *    MOVE WS-CON-89               TO WS-AMT01-CSUBPROD.
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9       TO WS-AMT01-CSUBPROD
           ELSE
              MOVE WS-CON-89       TO WS-AMT01-CSUBPROD
           END-IF

           EXEC SQL
                SELECT  ZMOVCTA ,
                        DDIAOP  ,
                        DCONTD  ,
                        MMOVIM  ,
                        MCAPITAL,
                        MCAPACTU,
                        MQUOTAIN,
                        MQUOTAAC,
                        QAGRAVID,
                        QPRAZO  ,
                        CLIBERAC,
                        CBALSAQ ,
                        CPRODSAQ,
                        CCNTSAQ ,
                        CDIGISAQ,
      * C82065(I)
                        CPAISIBSQ,
                        CBANIBSQ,
                        CCTAIBSQ,
                        CDIGIBSQ
      * C82065(F)
                  INTO :WS-AMT30-ZMOVCTA ,
                       :WS-AMT30-DDIAOP  ,
                       :WS-AMT30-DCONTD  ,
                       :WS-AMT30-MMOVIM  ,
                       :WS-AMT30-MCAPITAL,
                       :WS-AMT30-MCAPACTU,
                       :WS-AMT30-MQUOTAIN,
                       :WS-AMT30-MQUOTAAC,
                       :WS-AMT30-QAGRAVID,
                       :WS-AMT30-QPRAZO  ,
                       :WS-AMT30-CLIBERAC,
                       :WS-AMT30-CBALSAQ ,
                       :WS-AMT30-CPRODSAQ,
                       :WS-AMT30-CCNTSAQ ,
                       :WS-AMT30-CDIGISAQ,
      * C82065(I)
                       :WS-AMT30-CPAISIBSQ,
                       :WS-AMT30-CBANIBSQ,
                       :WS-AMT30-CCTAIBSQ,
                       :WS-AMT30-CDIGIBSQ
      * C82065(F)
                  FROM  AMVT3008_HISTOPER
                 WHERE  CPRODUTO = :AMVT0115-CPRODUTO
                   AND  CBALCAO  = :AMVT0115-CBALCAO
                   AND  CNUMECTA = :AMVT0115-CNUMECTA
                   AND  CDIGICTA = :AMVT0115-CDIGICTA
                   AND  ZMOVCTA  = 1
           END-EXEC.

           MOVE WS-CON-AMVT3008 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT3008-OK
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-556   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-556      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE AMVT0115-CPRODUTO  TO AMVT3008-CPRODUTO
              MOVE AMVT0115-CBALCAO   TO AMVT3008-CBALCAO
              MOVE AMVT0115-CNUMECTA  TO AMVT3008-CNUMECTA
              MOVE AMVT0115-CDIGICTA  TO AMVT3008-CDIGICTA
              MOVE AMVT0115-DCONTD    TO AMVT3008-DCONTD
              MOVE AMCV7301-MMOVIM-CTI TO AMVT3008-MMOVIM
              MOVE AMVT0115-MCAPITAL  TO AMVT3008-MCAPITAL
              MOVE AMVT0115-MCAPACTU  TO AMVT3008-MCAPACTU
              MOVE AMVT0115-MQUOTAIN  TO AMVT3008-MQUOTAIN
              MOVE AMVT0115-MQUOTAAC  TO AMVT3008-MQUOTAAC
              MOVE AMVT0115-QAGRAVID  TO AMVT3008-QAGRAVID
              MOVE AMVT0115-QPRAZO    TO AMVT3008-QPRAZO
              MOVE AMCV7300-CLIBERAC  TO AMVT3008-CLIBERAC

              MOVE AMCV7300-CBALSAQ   TO AMVT3008-CBALSAQ
              MOVE AMCV7300-CPRODSAQ  TO AMVT3008-CPRODSAQ
              MOVE AMCV7300-CCNTSAQ   TO AMVT3008-CCNTSAQ
              MOVE AMCV7300-CDIGISAQ  TO AMVT3008-CDIGISAQ
      * C82065(I)
              MOVE AMCV7300-CPAISIBSQ TO AMVT3008-CPAISIBSQ
              MOVE AMCV7300-CBANIBSQ  TO AMVT3008-CBANIBSQ
              MOVE AMCV7300-CCTAIBSQ  TO AMVT3008-CCTAIBSQ
              MOVE AMCV7300-CDIGIBSQ  TO AMVT3008-CDIGIBSQ
      * C82065(F)

              EXEC SQL
                 UPDATE AMVT3008_HISTOPER
                   SET
                        DCONTD   = :AMVT3008-DCONTD    ,
                        MMOVIM   = :AMVT3008-MMOVIM    ,
                        MCAPITAL = :AMVT3008-MCAPITAL  ,
                        MCAPACTU = :AMVT3008-MCAPACTU  ,
                        MQUOTAIN = :AMVT3008-MQUOTAIN  ,
                        MQUOTAAC = :AMVT3008-MQUOTAAC  ,
                        QAGRAVID = :AMVT3008-QAGRAVID  ,
                        QPRAZO   = :AMVT3008-QPRAZO    ,
                        CLIBERAC = :AMVT3008-CLIBERAC  ,
                        CBALSAQ  = :AMVT3008-CBALSAQ   ,
                        CPRODSAQ = :AMVT3008-CPRODSAQ  ,
                        CCNTSAQ  = :AMVT3008-CCNTSAQ   ,
                        CDIGISAQ = :AMVT3008-CDIGISAQ  ,
      * C82065(I)
                        CPAISIBSQ= :AMVT3008-CPAISIBSQ ,
                        CBANIBSQ = :AMVT3008-CBANIBSQ  ,
                        CCTAIBSQ = :AMVT3008-CCTAIBSQ  ,
                        CDIGIBSQ = :AMVT3008-CDIGIBSQ
      * C82065(I)
                  WHERE CBALCAO  = :AMVT3008-CBALCAO
                    AND CPRODUTO = :AMVT3008-CPRODUTO
                    AND CNUMECTA = :AMVT3008-CNUMECTA
                    AND CDIGICTA = :AMVT3008-CDIGICTA
              END-EXEC

              MOVE WS-CON-AMVT3008        TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF ATCL0001-SEM-ERROS
                 IF NOT AMVT3008-OK
                    MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-558    TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 MOVE AMCK0001-CON-558    TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF WS-AMT30-MMOVIM   NOT EQUAL AMVT3008-MMOVIM   OR
                 WS-AMT30-MQUOTAAC NOT EQUAL AMVT3008-MQUOTAAC
                 MOVE WS-CON-S            TO SWITCH-ALTERA-CATIVO
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-DCONTD   NOT EQUAL WS-AMT30-DCONTD
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-DCONTD           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-DCONTD         TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-DCONTD         TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MMOVIM   NOT EQUAL WS-AMT30-MMOVIM
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MMOVIM           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MMOVIM         TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MMOVIM         TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MCAPITAL NOT EQUAL WS-AMT30-MCAPITAL
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MCAPITAL         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MCAPITAL       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MCAPITAL       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MCAPACTU NOT EQUAL WS-AMT30-MCAPACTU
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MCAPACTU         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MCAPACTU       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MCAPACTU       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MQUOTAIN NOT EQUAL WS-AMT30-MQUOTAIN
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MQUOTAIN         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MQUOTAIN       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MQUOTAIN       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MQUOTAAC NOT EQUAL WS-AMT30-MQUOTAAC
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MQUOTAAC         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MQUOTAAC       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MQUOTAAC       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-QAGRAVID NOT EQUAL WS-AMT30-QAGRAVID
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-QAGRAVID         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-QAGRAVID       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-QAGRAVID       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-QPRAZO   NOT EQUAL WS-AMT30-QPRAZO
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-QPRAZO           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-QPRAZO         TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-QPRAZO         TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-CLIBERAC NOT EQUAL WS-AMT30-CLIBERAC
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-CLIBERAC         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-CLIBERAC       TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-CLIBERAC       TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMVT0115-CEMPSEC NOT EQUAL ZEROS
                 IF AMVT3008-MMOVIM NOT EQUAL ZEROS
                    MOVE AMVT3008-MMOVIM     TO WS-TOTAL-COMP1
                 ELSE
                    MOVE ZEROS               TO WS-TOTAL-COMP1
                 END-IF
              ELSE
                 MOVE AMVT3008-MMOVIM        TO WS-TOTAL-COMP1
                 ADD  AMVT3008-MQUOTAAC      TO WS-TOTAL-COMP1
              END-IF
           END-IF.
      *
       2339-INSERE-AMT30-CTI-EXIT.
           EXIT.
      ******************************************************************
       2330-INSERE-AMT30-CS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2330-INSERE-AMT30-CS' END-IF.

           MOVE AMCV7300-CTIPSOC        TO WS-AMT01-CTIPSOC .
           MOVE AMCV7300-ZSOCIO         TO WS-AMT01-ZSOCIO  .
           MOVE AMCV7300-CDIGISOC       TO WS-AMT01-CDIGISOC.
           MOVE AMCV7300-ZINSCRIC       TO WS-AMT01-ZINSCRIC.
      *    MOVE WS-CON-91               TO WS-AMT01-CSUBPROD.
           IF AMCV7301-CSUBPROD = 'A3'
              MOVE WS-CON-A0       TO WS-AMT01-CSUBPROD
           ELSE
              MOVE WS-CON-91       TO WS-AMT01-CSUBPROD
           END-IF

           EXEC SQL
                SELECT  ZMOVCTA ,
                        DDIAOP  ,
                        DCONTD  ,
                        MMOVIM  ,
                        MCAPITAL,
                        MCAPACTU,
                        MQUOTAIN,
                        MQUOTAAC,
                        QAGRAVID,
                        QPRAZO  ,
                        CLIBERAC,
                        CBALSAQ ,
                        CPRODSAQ,
                        CCNTSAQ ,
                        CDIGISAQ,
      * C82065(I)
                        CPAISIBSQ,
                        CBANIBSQ,
                        CCTAIBSQ,
                        CDIGIBSQ
      * C82065(F)
                  INTO :WS-AMT30-ZMOVCTA ,
                       :WS-AMT30-DDIAOP  ,
                       :WS-AMT30-DCONTD  ,
                       :WS-AMT30-MMOVIM  ,
                       :WS-AMT30-MCAPITAL,
                       :WS-AMT30-MCAPACTU,
                       :WS-AMT30-MQUOTAIN,
                       :WS-AMT30-MQUOTAAC,
                       :WS-AMT30-QAGRAVID,
                       :WS-AMT30-QPRAZO  ,
                       :WS-AMT30-CLIBERAC,
                       :WS-AMT30-CBALSAQ ,
                       :WS-AMT30-CPRODSAQ,
                       :WS-AMT30-CCNTSAQ ,
                       :WS-AMT30-CDIGISAQ,
      * C82065(I)
                       :WS-AMT30-CPAISIBSQ,
                       :WS-AMT30-CBANIBSQ,
                       :WS-AMT30-CCTAIBSQ,
                       :WS-AMT30-CDIGIBSQ
      * C82065(F)
                  FROM  AMVT3008_HISTOPER
                 WHERE  CPRODUTO = :AMVT0115-CPRODUTO
                   AND  CBALCAO  = :AMVT0115-CBALCAO
                   AND  CNUMECTA = :AMVT0115-CNUMECTA
                   AND  CDIGICTA = :AMVT0115-CDIGICTA
                   AND  ZMOVCTA  = 1
           END-EXEC.

           MOVE WS-CON-AMVT3008 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT3008-OK
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-556   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-556      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              MOVE AMVT0115-CPRODUTO  TO AMVT3008-CPRODUTO
              MOVE AMVT0115-CBALCAO   TO AMVT3008-CBALCAO
              MOVE AMVT0115-CNUMECTA  TO AMVT3008-CNUMECTA
              MOVE AMVT0115-CDIGICTA  TO AMVT3008-CDIGICTA
              MOVE AMVT0115-DCONTD    TO AMVT3008-DCONTD
              MOVE AMCV7301-MMOVIM-CS  TO AMVT3008-MMOVIM
              MOVE AMVT0115-MCAPITAL  TO AMVT3008-MCAPITAL
              MOVE AMVT0115-MCAPACTU  TO AMVT3008-MCAPACTU
              MOVE AMVT0115-MQUOTAIN  TO AMVT3008-MQUOTAIN
              MOVE AMVT0115-MQUOTAAC  TO AMVT3008-MQUOTAAC
              MOVE AMVT0115-QAGRAVID  TO AMVT3008-QAGRAVID
              MOVE AMVT0115-QPRAZO    TO AMVT3008-QPRAZO
              MOVE AMCV7300-CLIBERAC  TO AMVT3008-CLIBERAC

              MOVE AMCV7300-CBALSAQ   TO AMVT3008-CBALSAQ
              MOVE AMCV7300-CPRODSAQ  TO AMVT3008-CPRODSAQ
              MOVE AMCV7300-CCNTSAQ   TO AMVT3008-CCNTSAQ
              MOVE AMCV7300-CDIGISAQ  TO AMVT3008-CDIGISAQ
      * C82065(I)
              MOVE AMCV7300-CPAISIBSQ TO AMVT3008-CPAISIBSQ
              MOVE AMCV7300-CBANIBSQ  TO AMVT3008-CBANIBSQ
              MOVE AMCV7300-CCTAIBSQ  TO AMVT3008-CCTAIBSQ
              MOVE AMCV7300-CDIGIBSQ  TO AMVT3008-CDIGIBSQ
      * C82065(F)

              EXEC SQL
                 UPDATE AMVT3008_HISTOPER
                   SET
                        DCONTD   = :AMVT3008-DCONTD    ,
                        MMOVIM   = :AMVT3008-MMOVIM    ,
                        MCAPITAL = :AMVT3008-MCAPITAL  ,
                        MCAPACTU = :AMVT3008-MCAPACTU  ,
                        MQUOTAIN = :AMVT3008-MQUOTAIN  ,
                        MQUOTAAC = :AMVT3008-MQUOTAAC  ,
                        QAGRAVID = :AMVT3008-QAGRAVID  ,
                        QPRAZO   = :AMVT3008-QPRAZO    ,
                        CLIBERAC = :AMVT3008-CLIBERAC  ,
                        CBALSAQ  = :AMVT3008-CBALSAQ   ,
                        CPRODSAQ = :AMVT3008-CPRODSAQ  ,
                        CCNTSAQ  = :AMVT3008-CCNTSAQ   ,
                        CDIGISAQ = :AMVT3008-CDIGISAQ ,
      * C82065(I)
                        CPAISIBSQ= :AMVT3008-CPAISIBSQ ,
                        CBANIBSQ = :AMVT3008-CBANIBSQ  ,
                        CCTAIBSQ = :AMVT3008-CCTAIBSQ  ,
                        CDIGIBSQ = :AMVT3008-CDIGIBSQ
      * C82065(F)
                  WHERE CBALCAO  = :AMVT3008-CBALCAO
                    AND CPRODUTO = :AMVT3008-CPRODUTO
                    AND CNUMECTA = :AMVT3008-CNUMECTA
                    AND CDIGICTA = :AMVT3008-CDIGICTA
              END-EXEC

              MOVE WS-CON-AMVT3008        TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF ATCL0001-SEM-ERROS
                 IF NOT AMVT3008-OK
                    MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-558    TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 MOVE AMCK0001-CON-558    TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF WS-AMT30-MMOVIM   NOT EQUAL AMVT3008-MMOVIM   OR
                 WS-AMT30-MQUOTAAC NOT EQUAL AMVT3008-MQUOTAAC
                 MOVE WS-CON-S            TO SWITCH-ALTERA-CATIVO
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-DCONTD   NOT EQUAL WS-AMT30-DCONTD
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-DCONTD           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-DCONTD         TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-DCONTD         TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MMOVIM   NOT EQUAL WS-AMT30-MMOVIM
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MMOVIM           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MMOVIM         TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MMOVIM         TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MCAPITAL NOT EQUAL WS-AMT30-MCAPITAL
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MCAPITAL         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MCAPITAL       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MCAPITAL       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MCAPACTU NOT EQUAL WS-AMT30-MCAPACTU
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MCAPACTU         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MCAPACTU       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MCAPACTU       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MQUOTAIN NOT EQUAL WS-AMT30-MQUOTAIN
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MQUOTAIN         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MQUOTAIN       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MQUOTAIN       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-MQUOTAAC NOT EQUAL WS-AMT30-MQUOTAAC
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MQUOTAAC         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-MQUOTAAC       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-MQUOTAAC       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-QAGRAVID NOT EQUAL WS-AMT30-QAGRAVID
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-QAGRAVID         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-QAGRAVID       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-QAGRAVID       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-QPRAZO   NOT EQUAL WS-AMT30-QPRAZO
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-QPRAZO           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-QPRAZO         TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-QPRAZO         TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT3008-CLIBERAC NOT EQUAL WS-AMT30-CLIBERAC
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT3008-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT3008-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT3008-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT3008-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT30            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE WS-AMT30-ZMOVCTA        TO AMCL1500-ZMOVCTA
              MOVE WS-CON-CLIBERAC         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT30-CLIBERAC       TO AMCL1500-GCAMDB2A
              MOVE AMVT3008-CLIBERAC       TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMVT0115-CEMPSEC NOT EQUAL ZEROS
                 IF AMVT3008-MMOVIM NOT EQUAL ZEROS
                    MOVE AMVT3008-MMOVIM     TO WS-TOTAL-COMP2
                 ELSE
                    MOVE ZEROS               TO WS-TOTAL-COMP2
                 END-IF
              ELSE
                 MOVE AMVT3008-MMOVIM        TO WS-TOTAL-COMP2
                 ADD  AMVT3008-MQUOTAAC      TO WS-TOTAL-COMP2
              END-IF
           END-IF.
      *
       2339-INSERE-AMT30-CS-EXIT.
           EXIT.
      ******************************************************************
       2340-INSERE-AMT34.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2340-INSERE-AMT34' END-IF.

           EXEC SQL
                UPDATE AMVT3403_MOTPEND
                SET
                      DCONTD   = :AMVT0115-DCONTD
                WHERE CBALCAO  = :AMVT0115-CBALCAO
                  AND CPRODUTO = :AMVT0115-CPRODUTO
                  AND CNUMECTA = :AMVT0115-CNUMECTA
                  AND CDIGICTA = :AMVT0115-CDIGICTA
           END-EXEC.

           MOVE WS-CON-AMVT3403     TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT3403-OK AND NOT AMVT3403-NOTFND
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-574 TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-574 TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              EXEC SQL
                   UPDATE AMVT3600_PROCPEND
                   SET
                         DCONTD   = :AMVT0115-DCONTD
                   WHERE CBALCAO  = :AMVT0115-CBALCAO
                     AND CPRODUTO = :AMVT0115-CPRODUTO
                     AND CNUMECTA = :AMVT0115-CNUMECTA
                     AND CDIGICTA = :AMVT0115-CDIGICTA
              END-EXEC

              MOVE WS-CON-AMVT3600     TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF ATCL0001-SEM-ERROS
                 IF NOT AMVT3600-OK AND NOT AMVT3600-NOTFND
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-999 TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 MOVE AMCK0001-CON-999 TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS
              EXEC SQL
                   UPDATE AMVT6300_MOVCONF
                   SET
                         DCONTD   = :AMVT0115-DCONTD
                   WHERE CBALCAO  = :AMVT0115-CBALCAO
                     AND CPRODUTO = :AMVT0115-CPRODUTO
                     AND CNUMECTA = :AMVT0115-CNUMECTA
                     AND CDIGICTA = :AMVT0115-CDIGICTA
              END-EXEC

              MOVE WS-CON-AMVT6300     TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF ATCL0001-SEM-ERROS
                 IF NOT AMVT6300-OK AND NOT AMVT6300-NOTFND
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-610 TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
                 END-IF
              ELSE
                 MOVE AMCK0001-CON-610 TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
              END-IF
           END-IF.
      *
       2349-INSERE-AMT34-EXIT.
           EXIT.
      ******************************************************************
       2350-UPDATE-AMT01.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2350-UPDATE-AMT01' END-IF.
      *
           MOVE AMCV7300-CTIPSOC        TO WS-AMT01-CTIPSOC .
           MOVE AMCV7300-ZSOCIO         TO WS-AMT01-ZSOCIO  .
           MOVE AMCV7300-CDIGISOC       TO WS-AMT01-CDIGISOC.
           MOVE AMCV7300-ZINSCRIC       TO WS-AMT01-ZINSCRIC.

           IF SW-DEBUG-SIM
              DISPLAY ' ====================================='
              DISPLAY ' ANTES DO UPDATE NA AMT01 '
              DISPLAY ' WS-AMT01-CSITSUB   ' WS-AMT01-CSITSUB
              DISPLAY ' WS-AMT01-IDADECRO  ' WS-AMT01-IDADECRO
              DISPLAY ' WS-AMT01-DNASCIM   ' WS-AMT01-DNASCIM
              DISPLAY ' WS-AMT01-DNASCIMB  ' WS-AMT01-DNASCIMB
              DISPLAY ' WS-AMT01-IDADEACT  ' WS-AMT01-IDADEACT
              DISPLAY ' WS-AMT01-IDADAIBP  ' WS-AMT01-IDADAIBP
              DISPLAY ' WS-AMT01-CODPER    ' WS-AMT01-CODPER
              DISPLAY ' WS-AMT01-DCALCDEC  ' WS-AMT01-DCALCDEC
              DISPLAY ' WS-AMT01-DCONTD    ' WS-AMT01-DCONTD
              DISPLAY ' WS-AMT01-DULTLIB   ' WS-AMT01-DULTLIB
              DISPLAY ' WS-AMT01-DFIMCOBQ  ' WS-AMT01-DFIMCOBQ
              DISPLAY ' WS-AMT01-DTVENCIM  ' WS-AMT01-DTVENCIM
              DISPLAY ' WS-AMT01-CISENCAO  ' WS-AMT01-CISENCAO
              DISPLAY ' WS-AMT01-DFIMISEN  ' WS-AMT01-DFIMISEN
              DISPLAY ' WS-AMT01-MQTSUPL   ' WS-AMT01-MQTSUPL
              DISPLAY ' WS-AMT01-QPRESTQS  ' WS-AMT01-QPRESTQS
              DISPLAY ' WS-AMT01-PERCAGQT  ' WS-AMT01-PERCAGQT
              DISPLAY ' WS-AMT01-QAGRAVID  ' WS-AMT01-QAGRAVID
              DISPLAY ' WS-AMT01-QPRAZO    ' WS-AMT01-QPRAZO
              DISPLAY ' WS-AMT01-MCAPITAL  ' WS-AMT01-MCAPITAL
              DISPLAY ' WS-AMT01-MCAPACTU  ' WS-AMT01-MCAPACTU
              DISPLAY ' WS-AMT01-MQUOTAIN  ' WS-AMT01-MQUOTAIN
              DISPLAY ' WS-AMT01-MQUOTAAC  ' WS-AMT01-MQUOTAAC
              DISPLAY ' WS-AMT01-CCOBADIC  ' WS-AMT01-CCOBADIC
      * C82065(I)
              DISPLAY ' WS-AMT01-CPAISIBSQ ' WS-AMT01-CPAISIBSQ
              DISPLAY ' WS-AMT01-CBANIBSQ  ' WS-AMT01-CBANIBSQ
              DISPLAY ' WS-AMT01-CCTAIBSQ  ' WS-AMT01-CCTAIBSQ
              DISPLAY ' WS-AMT01-CDIGIBSQ  ' WS-AMT01-CDIGIBSQ
              DISPLAY ' WS-AMT01-CPAISIBSB ' WS-AMT01-CPAISIBSB
              DISPLAY ' WS-AMT01-CBANIBSB  ' WS-AMT01-CBANIBSB
              DISPLAY ' WS-AMT01-CCTAIBSB  ' WS-AMT01-CCTAIBSB
              DISPLAY ' WS-AMT01-CDIGIBSB  ' WS-AMT01-CDIGIBSB
      * C82065(F)
      *PDI-C138491
              DISPLAY ' WS-AMT01-CGESTMUT  ' WS-AMT01-CGESTMUT
      *C123517
              DISPLAY ' WS-AMT01-IPAGAEMP  ' WS-AMT01-IPAGAEMP
              DISPLAY ' WS-AMT01-ZCLIEMP   ' WS-AMT01-ZCLIEMP

              DISPLAY ' CHAVE '
              DISPLAY ' AMVT0115-CPRODUTO ' AMVT0115-CPRODUTO
              DISPLAY ' AMVT0115-CBALCAO  ' AMVT0115-CBALCAO
              DISPLAY ' AMVT0115-CNUMECTA ' AMVT0115-CNUMECTA
              DISPLAY ' AMVT0115-CDIGICTA ' AMVT0115-CDIGICTA
              DISPLAY ' ====================================='
           END-IF
      *
           EXEC SQL
                SELECT  CSITSUB ,
                        IDADECRO,
                        DNASCIM ,
                        DNASCIMB,
                        IDADEACT,
                        IDADAIBP,
                        CODPER  ,
                        DCALCDEC,
                        DCONTD  ,
                        DULTLIB ,
                        DFIMCOBQ,
                        DTVENCIM,
                        CISENCAO,
                        DFIMISEN,
                        MQTSUPL ,
                        QPRESTQS,
                        PERCAGQT,
                        QAGRAVID,
                        QPRAZO  ,
                        MCAPITAL,
                        MCAPACTU,
                        MQUOTAIN,
                        MQUOTAAC,
                        CCOBADIC
                      , CPRODUTO
                      , CBALCAO
                      , CNUMECTA
                      , CDIGICTA
                      , CTRATCTA
                      , CBALSAQ
                      , CPRODSAQ
                      , CCNTSAQ
                      , CBALSUB
                      , CPRDSUB
                      , CCTASUB
                      , CDIGSUB
      * C82065(I)
                      , CPAISIBSQ
                      , CBANIBSQ
                      , CCTAIBSQ
                      , CDIGIBSQ
                      , CPAISIBSB
                      , CBANIBSB
                      , CCTAIBSB
                      , CDIGIBSB
      * C82065(F)
      *PDI-C138491
                      , CGESTMUT
      *C123517
                      , IPAGAEMP
                      , ZCLIEMP
                  INTO :WS-AMT01-CSITSUB ,
                       :WS-AMT01-IDADECRO,
                       :WS-AMT01-DNASCIM ,
                       :WS-AMT01-DNASCIMB,
                       :WS-AMT01-IDADEACT,
                       :WS-AMT01-IDADAIBP,
                       :WS-AMT01-CODPER  ,
                       :WS-AMT01-DCALCDEC,
                       :WS-AMT01-DCONTD  ,
                       :WS-AMT01-DULTLIB ,
                       :WS-AMT01-DFIMCOBQ,
                       :WS-AMT01-DTVENCIM,
                       :WS-AMT01-CISENCAO,
                       :WS-AMT01-DFIMISEN,
                       :WS-AMT01-MQTSUPL ,
                       :WS-AMT01-QPRESTQS,
                       :WS-AMT01-PERCAGQT,
                       :WS-AMT01-QAGRAVID,
                       :WS-AMT01-QPRAZO  ,
                       :WS-AMT01-MCAPITAL,
                       :WS-AMT01-MCAPACTU,
                       :WS-AMT01-MQUOTAIN,
                       :WS-AMT01-MQUOTAAC,
                       :WS-AMT01-CCOBADIC
                     , :WS-AMT01-CPRODUTO
                     , :WS-AMT01-CBALCAO
                     , :WS-AMT01-CNUMECTA
                     , :WS-AMT01-CDIGICTA
                     , :WS-AMT01-CTRATCTA
                     , :WS-AMT01-CBALSAQ
                     , :WS-AMT01-CPRODSAQ
                     , :WS-AMT01-CCNTSAQ
                     , :WS-AMT01-CBALSUB
                     , :WS-AMT01-CPRDSUB
                     , :WS-AMT01-CCTASUB
                     , :WS-AMT01-CDIGSUB
      * C82065(I)
                     , :WS-AMT01-CPAISIBSQ
                     , :WS-AMT01-CBANIBSQ
                     , :WS-AMT01-CCTAIBSQ
                     , :WS-AMT01-CDIGIBSQ
                     , :WS-AMT01-CPAISIBSB
                     , :WS-AMT01-CBANIBSB
                     , :WS-AMT01-CCTAIBSB
                     , :WS-AMT01-CDIGIBSB
      *PDI-C138491
                     , :WS-AMT01-CGESTMUT
      *C123517
                     , :WS-AMT01-IPAGAEMP
                     , :WS-AMT01-ZCLIEMP
      * C82065(F)
                  FROM  AMVT0115_BASIOPER
                 WHERE  CPRODUTO = :AMVT0115-CPRODUTO
                   AND  CBALCAO  = :AMVT0115-CBALCAO
                   AND  CNUMECTA = :AMVT0115-CNUMECTA
                   AND  CDIGICTA = :AMVT0115-CDIGICTA
           END-EXEC.
           MOVE WS-CON-AMVT0115 TO ATCL0001-TABLE-NAME.
           MOVE SQLCODE                    TO WS-SQLCODE

           IF SW-DEBUG-SIM
              DISPLAY ' SEL AMT01 SQLCODE  = ' WS-SQLCODE
           END-IF
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT0115-OK
      ***        IF SW-DEBUG-SIM
                    DISPLAY  ' ATCL0001-SEM-ERROS NOT AMVT0115-OK '
      ***        END-IF
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-556   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
      ***     IF SW-DEBUG-SIM
                 DISPLAY ' NOT ATCL0001-SEM-ERROS '
      ***     END-IF

              MOVE AMCK0001-CON-556      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.

           IF SW-DEBUG-SIM
              DISPLAY '=====UPDATE NA AMT01============ '
              DISPLAY 'AMCV7300-CTIPSOC       ' AMCV7300-CTIPSOC
              DISPLAY 'AMCV7300-ZSOCIO        ' AMCV7300-ZSOCIO
              DISPLAY 'AMCV7300-CDIGISOC      ' AMCV7300-CDIGISOC
              DISPLAY 'AMCV7300-GTITULO       ' AMCV7300-GTITULO
              DISPLAY 'AMCV7300-ZINSCRIC      ' AMCV7300-ZINSCRIC
              DISPLAY 'AMCV7300-CPRODUTO      ' AMCV7300-CPRODUTO
              DISPLAY 'AMCV7300-CSUBPROD      ' AMCV7300-CSUBPROD
              DISPLAY 'AMCV7300-CBALCAO       ' AMCV7300-CBALCAO
              DISPLAY 'AMCV7300-NUMCONTA      ' AMCV7300-NUMCONTA
              DISPLAY 'AMCV7300-CPRODUTO-N    ' AMCV7300-CPRODUTO-N
              DISPLAY 'AMCV7300-CNUMECTA      ' AMCV7300-CNUMECTA
              DISPLAY 'AMCV7300-CDIGICTA      ' AMCV7300-CDIGICTA
              DISPLAY 'AMCV7300-INDSBPRO-CTI :' AMCV7300-INDSBPRO-CTI
              DISPLAY 'AMCV7301-INDSBPRO-CTI :' AMCV7301-INDSBPRO-CTI
              DISPLAY '================================ '
           END-IF.
      *
           MOVE AMCV7301-INDSBPRO-CTI TO AMVT0115-CCOBADIC.
      *
      *PDI-C138491
           IF ATCL0001-CBALCAO-OPER = '510'
           OR ATCL0001-CBALCAO-OPER = '777'
              MOVE AMCV7301-CGESTMUT TO AMVT0115-CGESTMUT
           END-IF.

      *C123517 - INI AQUI
           IF AMCV7301-CBANIBSQ = AMCK0002-CON-CBANCO-MG
              IF WS-CTIPCLI-ZCLIEMP NOT EQUAL WS-CON-E
      *c         iban-mg-particulares
                 MOVE '0'               TO AMVT0115-IPAGAEMP
                 MOVE ZEROS             TO AMVT0115-ZCLIEMP
                 MOVE ZEROS             TO AMCV7301-ZCLIEMP
              ELSE
      *c      IF WS-CTIPCLI-ZCLIEMP = WS-CON-E
      *c         iban-mg-empresas
                 MOVE '1'               TO AMVT0115-IPAGAEMP
              END-IF
           ELSE
      *c   OIC
              IF AMCV7301-ZCLIEMP = ZEROS
                 MOVE '0'               TO AMVT0115-IPAGAEMP
                 MOVE ZEROS             TO AMVT0115-ZCLIEMP
                 MOVE ZEROS             TO AMCV7301-ZCLIEMP
              ELSE
                 IF WS-CTIPCLI-ZCLIEMP = WS-CON-E
                    MOVE '1'              TO AMVT0115-IPAGAEMP
      **            MOVE AMCV7301-ZCLIEMP TO AMVT0115-ZCLIEMP
                 ELSE
                    MOVE '0'            TO AMVT0115-IPAGAEMP
                    MOVE ZEROS          TO AMVT0115-ZCLIEMP
                    MOVE ZEROS          TO AMCV7301-ZCLIEMP
                 END-IF
              END-IF
           END-IF
           IF SW-DEBUG-SIM
              DISPLAY 'C123517 1 - AMCV7301-CBANIBSQ = '
                                   AMCV7301-CBANIBSQ
                      ' WS-CTIPCLI-ZCLIEMP = ' WS-CTIPCLI-ZCLIEMP
              DISPLAY 'C123517 1 - AMVT0115-IPAGAEMP = '
                                   AMVT0115-IPAGAEMP
                      ' AMVT0115-ZCLIEMP = ' AMVT0115-ZCLIEMP
           END-IF.
      *C123517 - fim
      *
           EXEC SQL
                UPDATE AMVT0115_BASIOPER
                SET
                      CSITSUB   = :AMVT0115-CSITSUB    ,
                      IDADECRO  = :AMVT0115-IDADECRO   ,
                      DNASCIM   = :AMVT0115-DNASCIM    ,
                      DNASCIMB  = :AMVT0115-DNASCIMB   ,
                      IDADEACT  = :AMVT0115-IDADEACT   ,
                      IDADAIBP  = :AMVT0115-IDADAIBP   ,
                      CODPER    = :AMVT0115-CODPER     ,
                      DCONTD    = :AMVT0115-DCONTD     ,
                      DULTLIB   = :AMVT0115-DULTLIB    ,
                      DFIMCOBQ  = :AMVT0115-DFIMCOBQ   ,
                      DTVENCIM  = :AMVT0115-DTVENCIM   ,
                      MQTSUPL   = :AMVT0115-MQTSUPL    ,
                      PERCAGQT  = :AMVT0115-PERCAGQT   ,
                      QAGRAVID  = :AMVT0115-QAGRAVID   ,
                      QPRAZO    = :AMVT0115-QPRAZO     ,
                      MCAPITAL  = :AMVT0115-MCAPITAL   ,
                      MCAPACTU  = :AMVT0115-MCAPACTU   ,
                      MQUOTAIN  = :AMVT0115-MQUOTAIN   ,
                      MQUOTAAC  = :AMVT0115-MQUOTAAC   ,
                      CCOBADIC  = :AMVT0115-CCOBADIC
                    , CBALSUB   = :AMVT0115-CBALSUB
                    , CPRDSUB   = :AMVT0115-CPRDSUB
                    , CCTASUB   = :AMVT0115-CCTASUB
                    , CDIGSUB   = :AMVT0115-CDIGSUB
      * ALT02 (I)
                    , IDADRECB  = :AMVT0115-IDADRECB
                    , QIDRFSOL  = :AMVT0115-QIDRFSOL
      * ALT02 (F)
      * C82065(I)
                    , CPAISIBSB = :AMVT0115-CPAISIBSB
                    , CBANIBSB  = :AMVT0115-CBANIBSB
                    , CCTAIBSB  = :AMVT0115-CCTAIBSB
                    , CDIGIBSB  = :AMVT0115-CDIGIBSB
      * C82065(F)
      *PDI-C138491
                    , CGESTMUT  = :AMVT0115-CGESTMUT
      *C123517
                    , IPAGAEMP  = :AMVT0115-IPAGAEMP
                    , ZCLIEMP   = :AMVT0115-ZCLIEMP
                WHERE CBALCAO   = :AMVT0115-CBALCAO
                  AND CPRODUTO  = :AMVT0115-CPRODUTO
                  AND CNUMECTA  = :AMVT0115-CNUMECTA
                  AND CDIGICTA  = :AMVT0115-CDIGICTA
           END-EXEC.
           MOVE WS-CON-AMVT0115        TO ATCL0001-TABLE-NAME
           MOVE SQLCODE                    TO WS-SQLCODE

           IF SW-DEBUG-SIM
              DISPLAY ' UPD AMT01 SQLCODE2 = ' WS-SQLCODE
           END-IF
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT0115-OK
      ***        IF SW-DEBUG-SIM
                    DISPLAY 'UPDATE AMT01 | NOT AMVT0115-OK '
      ***        END-IF

                 MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-502    TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
      ***     IF SW-DEBUG-SIM
                 DISPLAY ' UPDATE AMT01 | NOT ATCL0001-SEM-ERROS '
      ***     END-IF

              MOVE AMCK0001-CON-502    TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-CSITSUB  NOT EQUAL WS-AMT01-CSITSUB
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-CSITSUB          TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-CSITSUB        TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-CSITSUB        TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-IDADECRO NOT EQUAL WS-AMT01-IDADECRO
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-IDADECRO         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-IDADECRO       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-IDADECRO       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-DNASCIM  NOT EQUAL WS-AMT01-DNASCIM
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-DNASCIM          TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-DNASCIM        TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-DNASCIM        TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-DNASCIMB NOT EQUAL WS-AMT01-DNASCIMB
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-DNASCIMB         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-DNASCIMB       TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-DNASCIMB       TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-IDADEACT NOT EQUAL WS-AMT01-IDADEACT
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-IDADEACT         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-IDADEACT       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-IDADEACT       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-IDADAIBP NOT EQUAL WS-AMT01-IDADAIBP
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-IDADAIBP         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-IDADAIBP       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-IDADAIBP       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-CODPER   NOT EQUAL WS-AMT01-CODPER
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-CODPER           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-CODPER         TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-CODPER         TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-DCONTD   NOT EQUAL WS-AMT01-DCONTD
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-DCONTD           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-DCONTD         TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-DCONTD         TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-DULTLIB  NOT EQUAL WS-AMT01-DULTLIB
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-DULTLIB          TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-DULTLIB        TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-DULTLIB        TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-DFIMCOBQ NOT EQUAL WS-AMT01-DFIMCOBQ
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-DFIMCOBQ         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-DFIMCOBQ       TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-DFIMCOBQ       TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-DTVENCIM NOT EQUAL WS-AMT01-DTVENCIM
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-DTVENCIM         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-DTVENCIM       TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-DTVENCIM       TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-MQTSUPL  NOT EQUAL WS-AMT01-MQTSUPL
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MQTSUPL          TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-MQTSUPL        TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-MQTSUPL        TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-PERCAGQT NOT EQUAL WS-AMT01-PERCAGQT
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-PERCAGQT         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-PERCAGQT       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-PERCAGQT       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-QAGRAVID NOT EQUAL WS-AMT01-QAGRAVID
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-QAGRAVID         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-QAGRAVID       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-QAGRAVID       TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-QPRAZO   NOT EQUAL WS-AMT01-QPRAZO
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-QPRAZO           TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-QPRAZO         TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-QPRAZO         TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-MCAPITAL NOT EQUAL WS-AMT01-MCAPITAL
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MCAPITAL         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-MCAPITAL       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-MCAPITAL       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-MCAPACTU NOT EQUAL WS-AMT01-MCAPACTU
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MCAPACTU         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-MCAPACTU       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-MCAPACTU       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-MQUOTAIN NOT EQUAL WS-AMT01-MQUOTAIN
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MQUOTAIN         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-MQUOTAIN       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-MQUOTAIN       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER   TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              AMVT0115-MQUOTAAC NOT EQUAL WS-AMT01-MQUOTAAC
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE WS-CON-MQUOTAAC         TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-MQUOTAAC       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-MQUOTAAC       TO WS-NUMERICO13-2
              MOVE WS-NUMERICO13-2         TO WS-NUMERICO13-2-EDIT
              MOVE WS-NUMERICO13-2-EDIT    TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER    TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.
      *
      *C138491
           IF ATCL0001-SEM-ERROS AND
              AMVT0115-CGESTMUT NOT EQUAL WS-AMT01-CGESTMUT
              IF ATCL0001-CBALCAO-OPER = '510'
              OR ATCL0001-CBALCAO-OPER = '777'
                 INITIALIZE AMCL1500-AREA
                     REPLACING ALPHANUMERIC DATA BY SPACES
                               NUMERIC DATA BY ZEROS

                 MOVE AMVT0115-CPRODUTO    TO AMCL1500-CPRODUTO
                 MOVE AMVT0115-CBALCAO     TO AMCL1500-CBALCAO
                 MOVE AMVT0115-CNUMECTA    TO AMCL1500-CNUMECTA
                 MOVE AMVT0115-CDIGICTA    TO AMCL1500-CDIGICTA
                 MOVE WS-AMT01-CSUBPROD    TO AMCL1500-CSUBPROD
                 MOVE WS-AMT01-CTIPSOC     TO AMCL1500-CTIPSOC
                 MOVE WS-AMT01-ZSOCIO      TO AMCL1500-ZSOCIO
                 MOVE WS-AMT01-CDIGISOC    TO AMCL1500-CDIGISOC
                 MOVE WS-AMT01-ZINSCRIC    TO AMCL1500-ZINSCRIC
                 MOVE WS-CON-AMI73060      TO AMCL1500-NPROGRAM
                 MOVE WS-CON-AMT01         TO AMCL1500-NTABELA
                 MOVE WS-CON-0001-01-01    TO AMCL1500-DQUOTA
                 MOVE ZEROS                TO AMCL1500-ZMOVCTA
                 MOVE 'CGESTMUT'           TO AMCL1500-N1CAMDB2
                 MOVE WS-AMT01-CGESTMUT    TO AMCL1500-GCAMDB2A
                 MOVE AMVT0115-CGESTMUT    TO AMCL1500-GCAMDB2D
                 MOVE SPACES               TO AMCL1500-GOBSERVA
                 MOVE ATCL0001-CBALCAO-OPER TO AMCL1500-BOPER
                 MOVE ATCL0001-CUTILIZA    TO AMCL1500-CUTALTER
                 MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

                 PERFORM AMCI1500-ROTINA
                    THRU AMCI1500-EXIT

                 IF NOT AMCL1500-SEM-ERROS
                    MOVE AMCL1500-NR-ERRO     TO ATCL0001-SQLCODE
                    MOVE AMCL1500-TABLE-NAME  TO ATCL0001-TABLE-NAME
                    MOVE AMCL1500-IND-ERROS   TO ATCL0001-IND-ERROS
                    MOVE AMCL1500-STATUS      TO AMCV7301-CTIPSOC-S
                    MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
                 END-IF
              END-IF
           END-IF.
      *
      *C123517 - INI
           IF ATCL0001-SEM-ERROS AND
              AMVT0115-IPAGAEMP NOT EQUAL WS-AMT01-IPAGAEMP
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE 'IPAGAEMP'              TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-IPAGAEMP       TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-IPAGAEMP       TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.
           IF ATCL0001-SEM-ERROS AND
              AMVT0115-ZCLIEMP NOT EQUAL WS-AMT01-ZCLIEMP
              INITIALIZE AMCL1500-AREA
                  REPLACING ALPHANUMERIC DATA BY SPACES
                            NUMERIC DATA BY ZEROS

              MOVE AMVT0115-CPRODUTO       TO AMCL1500-CPRODUTO
              MOVE AMVT0115-CBALCAO        TO AMCL1500-CBALCAO
              MOVE AMVT0115-CNUMECTA       TO AMCL1500-CNUMECTA
              MOVE AMVT0115-CDIGICTA       TO AMCL1500-CDIGICTA
              MOVE WS-AMT01-CSUBPROD       TO AMCL1500-CSUBPROD
              MOVE WS-AMT01-CTIPSOC        TO AMCL1500-CTIPSOC
              MOVE WS-AMT01-ZSOCIO         TO AMCL1500-ZSOCIO
              MOVE WS-AMT01-CDIGISOC       TO AMCL1500-CDIGISOC
              MOVE WS-AMT01-ZINSCRIC       TO AMCL1500-ZINSCRIC
              MOVE WS-CON-AMI73060         TO AMCL1500-NPROGRAM
              MOVE WS-CON-AMT01            TO AMCL1500-NTABELA
              MOVE WS-CON-0001-01-01       TO AMCL1500-DQUOTA
              MOVE ZEROS                   TO AMCL1500-ZMOVCTA
              MOVE 'ZCLIEMP'               TO AMCL1500-N1CAMDB2
              MOVE WS-AMT01-ZCLIEMP        TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2A
              MOVE AMVT0115-ZCLIEMP        TO WS-NUMERICO10
              MOVE WS-NUMERICO10           TO WS-NUMERICO10-EDIT
              MOVE WS-NUMERICO10-EDIT      TO AMCL1500-GCAMDB2D
              MOVE SPACES                  TO AMCL1500-GOBSERVA
              MOVE ATCL0001-CBALCAO-OPER TO AMCL1500-BOPER
              MOVE ATCL0001-CUTILIZA       TO AMCL1500-CUTALTER
              MOVE ATCL0001-UT-AUT-CENTRAL TO AMCL1500-CUTULAUT

              PERFORM AMCI1500-ROTINA
                 THRU AMCI1500-EXIT

              IF NOT AMCL1500-SEM-ERROS
                 MOVE AMCL1500-NR-ERRO        TO ATCL0001-SQLCODE
                 MOVE AMCL1500-TABLE-NAME     TO ATCL0001-TABLE-NAME
                 MOVE AMCL1500-IND-ERROS      TO ATCL0001-IND-ERROS
                 MOVE AMCL1500-STATUS         TO AMCV7301-CTIPSOC-S
                 MOVE AMCL1500-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.
      *C123517 - FIM
      *
       2359-UPDATE-AMT01-EXIT.
           EXIT.
      ******************************************************************
       2360-VERIFICA-REL-CONTAS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2360-VERIFICA-REL-CONTAS' END-IF.
           IF (WS-AMT01-CBALSUB NOT = AMCV7300-CBALSAQ  OR
               WS-AMT01-CPRDSUB NOT = AMCV7300-CPRODSAQ OR
               WS-AMT01-CCTASUB NOT = AMCV7300-CCNTSAQ    ) AND
              (WS-AMT01-CBALSUB NOT = AMCV7300-CBALSUB  OR
               WS-AMT01-CPRDSUB NOT = AMCV7300-CPRDSUB  OR
               WS-AMT01-CCTASUB NOT = AMCV7300-CCTASUB    ) AND
              (WS-AMT01-CBALSUB NOT = SPACES            OR
               WS-AMT01-CPRDSUB NOT = SPACES            OR
               WS-AMT01-CCTASUB NOT = SPACES              )
           THEN
              PERFORM 2362-APAGA-REL-CNTSUB
                 THRU 2362-APAGA-REL-CNTSUB-EXIT
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF (AMCV7300-CBALSUB NOT = WS-AMT01-CBALSAQ  OR
                  AMCV7300-CPRDSUB NOT = WS-AMT01-CPRODSAQ OR
                  AMCV7300-CCTASUB NOT = WS-AMT01-CCNTSAQ    ) AND
                 (AMCV7300-CBALSUB NOT = WS-AMT01-CBALSUB  OR
                  AMCV7300-CPRDSUB NOT = WS-AMT01-CPRDSUB  OR
                  AMCV7300-CCTASUB NOT = WS-AMT01-CCTASUB    )
              THEN
                 PERFORM 2367-INSERE-REL-CNTSUB
                    THRU 2367-INSERE-REL-CNTSUB-EXIT
              END-IF
           END-IF.

       2360-VERIFICA-REL-CONTAS-EXIT.
           EXIT.
      ******************************************************************
       2362-APAGA-REL-CNTSUB.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2362-APAGA-REL-CNTSUB' END-IF.
           MOVE WS-AMT01-CBALSUB  TO DCVT1500-CBALCAO .
           MOVE WS-AMT01-CPRDSUB  TO DCVT1500-CPRODUTO.
           MOVE WS-AMT01-CCTASUB  TO DCVT1500-CNUMECTA.
           MOVE WS-AMT01-CDIGSUB  TO DCVT1500-CDIGICTA.
           MOVE WS-AMT01-CBALCAO  TO DCVT1500-CBALREL .
           MOVE WS-AMT01-CPRODUTO TO DCVT1500-CPRDREL .
           MOVE WS-AMT01-CNUMECTA TO DCVT1500-CCTAREL .
           MOVE WS-AMT01-CDIGICTA TO DCVT1500-CDIGREL .
           MOVE WS-CON-013        TO DCVT1500-CRELCTA .

           PERFORM 2364-APAGA-REL-CONTAS
              THRU 2364-APAGA-REL-CONTAS-EXIT.

       2362-APAGA-REL-CNTSUB-EXIT.
           EXIT.
      ******************************************************************
       2364-APAGA-REL-CONTAS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2364-APAGA-REL-CONTAS' END-IF.
           EXEC SQL
                DELETE FROM DCVT1500_RELCTA
                      WHERE CBALCAO  = :DCVT1500-CBALCAO
                        AND CPRODUTO = :DCVT1500-CPRODUTO
                        AND CNUMECTA = :DCVT1500-CNUMECTA
                        AND CDIGICTA = :DCVT1500-CDIGICTA
                        AND CBALREL  = :DCVT1500-CBALREL
                        AND CPRDREL  = :DCVT1500-CPRDREL
                        AND CCTAREL  = :DCVT1500-CCTAREL
                        AND CDIGREL  = :DCVT1500-CDIGREL
                        AND CRELCTA  = :DCVT1500-CRELCTA
           END-EXEC.

           MOVE WS-CON-DCVT1500             TO ATCL0001-TABLE-NAME.

           PERFORM 9020-DB2CHECK
              THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT DCVT1500-OK
                 DISPLAY 'PROGRAMA = AMI02060'
                 DISPLAY 'PARAGRAFO= 2364-APAGA-REL-CONTAS'
                 DISPLAY 'CBALCAO  = ' DCVT1500-CBALCAO
                 DISPLAY 'CPRODUTO = ' DCVT1500-CPRODUTO
                 DISPLAY 'CNUMECTA = ' DCVT1500-CNUMECTA
                 DISPLAY 'CDIGICTA = ' DCVT1500-CDIGICTA
                 DISPLAY 'CBALREL  = ' DCVT1500-CBALREL
                 DISPLAY 'CPRDREL  = ' DCVT1500-CPRDREL
                 DISPLAY 'CCTAREL  = ' DCVT1500-CCTAREL
                 DISPLAY 'CDIGREL  = ' DCVT1500-CDIGREL
                 DISPLAY 'CRELCTA  = ' DCVT1500-CRELCTA
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-778      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              IF SW-DEBUG-SIM
                 DISPLAY 'PROGRAMA = AMI02060'
                 DISPLAY 'PARAGRAFO= 2364-APAGA-REL-CONTAS'
                 DISPLAY 'CBALCAO  = ' DCVT1500-CBALCAO
                 DISPLAY 'CPRODUTO = ' DCVT1500-CPRODUTO
                 DISPLAY 'CNUMECTA = ' DCVT1500-CNUMECTA
                 DISPLAY 'CDIGICTA = ' DCVT1500-CDIGICTA
                 DISPLAY 'CBALREL  = ' DCVT1500-CBALREL
                 DISPLAY 'CPRDREL  = ' DCVT1500-CPRDREL
                 DISPLAY 'CCTAREL  = ' DCVT1500-CCTAREL
                 DISPLAY 'CDIGREL  = ' DCVT1500-CDIGREL
                 DISPLAY 'CRELCTA  = ' DCVT1500-CRELCTA
              END-IF
              MOVE AMCK0001-CON-778         TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1                 TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2364-APAGA-REL-CONTAS-EXIT.
           EXIT.
      ******************************************************************
       2367-INSERE-REL-CNTSUB.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2367-INSERE-REL-CNTSUB' END-IF.
           MOVE AMCV7300-CBALSUB  TO DCVT1500-CBALCAO .
           MOVE AMCV7300-CPRDSUB  TO DCVT1500-CPRODUTO.
           MOVE AMCV7300-CCTASUB  TO DCVT1500-CNUMECTA.
           MOVE AMCV7300-CDIGSUB  TO DCVT1500-CDIGICTA.
           MOVE WS-CTRATCTA-SUB   TO DCVT1500-CTRATCTA.
           MOVE WS-AMT01-CBALCAO  TO DCVT1500-CBALREL .
           MOVE WS-AMT01-CPRODUTO TO DCVT1500-CPRDREL .
           MOVE WS-AMT01-CNUMECTA TO DCVT1500-CCTAREL .
           MOVE WS-AMT01-CDIGICTA TO DCVT1500-CDIGREL .
           MOVE WS-AMT01-CTRATCTA TO DCVT1500-CTRATREL.
           MOVE WS-CON-013        TO DCVT1500-CRELCTA .
           MOVE ATCL0001-CUTILIZA TO DCVT1500-CUTULMOD.

           PERFORM 2369-INSERE-REL-CONTAS
              THRU 2369-INSERE-REL-CONTAS-EXIT.

       2367-INSERE-REL-CNTSUB-EXIT.
           EXIT.
      ******************************************************************
       2369-INSERE-REL-CONTAS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2369-INSERE-REL-CONTAS' END-IF.
           EXEC SQL
                INSERT INTO DCVT1500_RELCTA
                     VALUES ( :DCVT1500-CPRODUTO,
                              :DCVT1500-CBALCAO,
                              :DCVT1500-CNUMECTA,
                              :DCVT1500-CDIGICTA,
                              :DCVT1500-CTRATCTA,
                              :DCVT1500-CPRDREL,
                              :DCVT1500-CBALREL,
                              :DCVT1500-CCTAREL,
                              :DCVT1500-CDIGREL,
                              :DCVT1500-CTRATREL,
                              :DCVT1500-CRELCTA,
                               CURRENT TIMESTAMP,
                              :DCVT1500-CUTULMOD,
                              :DCVT1500-CUSRTAB)
           END-EXEC.

           MOVE WS-CON-DCVT1500             TO ATCL0001-TABLE-NAME.

           PERFORM 9020-DB2CHECK
              THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT DCVT1500-OK
                 DISPLAY 'PROGRAMA = AMI02060'
                 DISPLAY 'PARAGRAFO= 2369-INSERE-REL-CONTAS'
                 DISPLAY 'CBALCAO  = ' DCVT1500-CBALCAO
                 DISPLAY 'CPRODUTO = ' DCVT1500-CPRODUTO
                 DISPLAY 'CNUMECTA = ' DCVT1500-CNUMECTA
                 DISPLAY 'CDIGICTA = ' DCVT1500-CDIGICTA
                 DISPLAY 'CBALREL  = ' DCVT1500-CBALREL
                 DISPLAY 'CPRDREL  = ' DCVT1500-CPRDREL
                 DISPLAY 'CCTAREL  = ' DCVT1500-CCTAREL
                 DISPLAY 'CDIGREL  = ' DCVT1500-CDIGREL
                 DISPLAY 'CRELCTA  = ' DCVT1500-CRELCTA
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-774      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              IF SW-DEBUG-SIM
                 DISPLAY 'PROGRAMA = AMI02060'
                 DISPLAY 'PARAGRAFO= 2369-INSERE-REL-CONTAS'
                 DISPLAY 'CBALCAO  = ' DCVT1500-CBALCAO
                 DISPLAY 'CPRODUTO = ' DCVT1500-CPRODUTO
                 DISPLAY 'CNUMECTA = ' DCVT1500-CNUMECTA
                 DISPLAY 'CDIGICTA = ' DCVT1500-CDIGICTA
                 DISPLAY 'CBALREL  = ' DCVT1500-CBALREL
                 DISPLAY 'CPRDREL  = ' DCVT1500-CPRDREL
                 DISPLAY 'CCTAREL  = ' DCVT1500-CCTAREL
                 DISPLAY 'CDIGREL  = ' DCVT1500-CDIGREL
                 DISPLAY 'CRELCTA  = ' DCVT1500-CRELCTA
              END-IF
              MOVE AMCK0001-CON-774         TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1                 TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2369-INSERE-REL-CONTAS-EXIT.
           EXIT.
      ******************************************************************
       2360-INSERE-DCT15.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2360-INSERE-DCT15' END-IF.

           MOVE AMVT0115-CPRODSAQ    TO DCVT1500-CPRODUTO.
           MOVE AMVT0115-CBALSAQ     TO DCVT1500-CBALCAO.
           MOVE AMVT0115-CCNTSAQ     TO DCVT1500-CNUMECTA.
           MOVE AMVT0115-CDIGISAQ    TO DCVT1500-CDIGICTA.
           MOVE WS-CTRATCTA          TO DCVT1500-CTRATCTA.
           MOVE AMVT0115-CPRODUTO    TO DCVT1500-CPRDREL.
           MOVE AMVT0115-CBALCAO     TO DCVT1500-CBALREL.
           MOVE AMVT0115-CNUMECTA    TO DCVT1500-CCTAREL.
           MOVE AMVT0115-CDIGICTA    TO DCVT1500-CDIGREL.
           MOVE AMVT0115-CTRATCTA    TO DCVT1500-CTRATREL.
           MOVE WS-CON-013           TO DCVT1500-CRELCTA.
           MOVE ATCL0001-CUTILIZA    TO DCVT1500-CUTULMOD.

           EXEC SQL
                INSERT INTO DCVT1500_RELCTA
                     VALUES ( :DCVT1500-CPRODUTO,
                              :DCVT1500-CBALCAO,
                              :DCVT1500-CNUMECTA,
                              :DCVT1500-CDIGICTA,
                              :DCVT1500-CTRATCTA,
                              :DCVT1500-CPRDREL,
                              :DCVT1500-CBALREL,
                              :DCVT1500-CCTAREL,
                              :DCVT1500-CDIGREL,
                              :DCVT1500-CTRATREL,
                              :DCVT1500-CRELCTA,
                               CURRENT TIMESTAMP,
                              :DCVT1500-CUTULMOD,
                              :DCVT1500-CUSRTAB)
           END-EXEC.

           MOVE WS-CON-DCVT1500        TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT DCVT1500-OK
                 MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-774    TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-774    TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2369-INSERE-DCT15-EXIT.
           EXIT.
      ******************************************************************
       2370-INSERE-CLT08.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2370-INSERE-CLT08' END-IF.
           MOVE AMVT0115-CPRODUTO   TO CLVT0803-CPRODUTO.
           MOVE AMVT0115-CBALCAO    TO CLVT0803-CBALCAO.
           MOVE AMVT0115-CNUMECTA   TO CLVT0803-CNUMECTA.
           MOVE AMVT0115-CDIGICTA   TO CLVT0803-CDIGICTA.

           MOVE AMVT0115-DCONTD     TO CLVT0803-DINIREL.
           MOVE WS-DDIAOP           TO CLVT0803-DABERTUR.
           MOVE AMVT0115-CTRATCTA   TO CLVT0803-CTRATCTA.
           MOVE WS-CON-9999-12-31   TO CLVT0803-DCANCEL.
           MOVE WS-CON-0001-01-01   TO CLVT0803-DULTMOD.
           MOVE ATCL0001-CUTILIZA   TO CLVT0803-CUTULMOD
                                       CLVT0803-CUSRTAB.

           INITIALIZE                  CLCLCT08-COMMAREA.

           MOVE  CLVT0803-ZCLIENTE      TO CLCLCT08-ZCLIENTE.
           MOVE  CLVT0803-CBALCAO       TO CLCLCT08-CBALCAO .
           MOVE  CLVT0803-CPRODUTO      TO CLCLCT08-CPRODUTO.
           MOVE  CLVT0803-CNUMECTA      TO CLCLCT08-CNUMECTA.
           MOVE  CLVT0803-CDIGICTA      TO CLCLCT08-CDIGICTA.
           MOVE  CLVT0803-CTITULAR      TO CLCLCT08-CTITULAR.
           MOVE  CLVT0803-ZTITULAR      TO CLCLCT08-ZTITULAR.
           MOVE  CLVT0803-DINIREL       TO CLCLCT08-DINIREL .
           MOVE  CLVT0803-DABERTUR      TO CLCLCT08-DABERTUR.
           MOVE  CLVT0803-DCANCEL       TO CLCLCT08-DCANCEL.
           MOVE  CLVT0803-DULTMOD       TO CLCLCT08-DULTMOD .
           MOVE  CLVT0803-CTRATCTA      TO CLCLCT08-CTRATCTA.
           MOVE  CLVT0803-CUSRTAB       TO CLCLCT08-CUSRTAB.
           MOVE  CLVT0803-CUTULMOD      TO CLCLCT08-CUTULMOD.
           MOVE   'I'                   TO CLCLCT08-ACCAO .
           MOVE   '0'                   TO CLCLCT08-AMBIENTE.
           MOVE  WS-DDIAOP              TO CLCLCT08-DDIAOP .
           MOVE  ATCL0001-CBALCAO-OPER  TO CLCLCT08-CBALCAO-OPER.
           MOVE  CLVT0803-CBALCAO       TO CLCLCT08-CBALTIT.
           MOVE  ATCL0001-CUTILIZA      TO CLCLCT08-CUTILIZA.
           MOVE   'AMI73060'            TO CLCLCT08-NPROGRAM.


           CALL WS-CON-ROT-CLCLCT08 USING CLCLCT08-COMMAREA.


           IF CLCLCT08-ERRO
              MOVE CLCLCT08-STATUS            TO AMCV7301-CTIPSOC-S
              MOVE CLCLCT08-IND-ERROS         TO ATCL0001-IND-ERROS
              MOVE AMCK0001-CON-775           TO AMCV7301-CTIPSOC-MSG
           END-IF.

           IF NOT ATCL0001-SEM-ERROS
              EXEC CICS
                   SYNCPOINT ROLLBACK
              END-EXEC
           END-IF.
      *
       2379-INSERE-CLT08-EXIT.
           EXIT.
      ******************************************************************
       2380-INSERE-AMT20.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2380-INSERE-AMT20' END-IF.

           MOVE AMVT0115-CPRODUTO      TO AMVT2000-CPRODUTO.
           MOVE AMVT0115-CBALCAO       TO AMVT2000-CBALCAO.
           MOVE AMVT0115-CNUMECTA      TO AMVT2000-CNUMECTA.
           MOVE AMVT0115-CDIGICTA      TO AMVT2000-CDIGICTA.
           MOVE ZEROS                  TO AMVT2000-ZTITULAR.
           MOVE WS-CON-N1              TO AMVT2000-ZGRUPBEN.
           MOVE WS-CON-13              TO AMVT2000-CQUALPEN.
           MOVE WS-CON-99              TO AMVT2000-CPARENTE.
           MOVE WS-CON-N100            TO AMVT2000-PERCBENF.
           MOVE ZEROS                  TO AMVT2000-MBENEF.
           MOVE WS-CON-9               TO AMVT2000-IPENTEMP.
           MOVE ZEROS                  TO AMVT2000-QPRAZO.
           MOVE WS-CON-N               TO AMVT2000-INDREVER.
           MOVE SPACES                 TO AMVT2000-GCONDBEN.
           MOVE WS-DDIAOP              TO AMVT2000-DCRIACAO.
           MOVE ATCL0001-CUTILIZA      TO AMVT2000-CUTULMOD.
           MOVE WS-CON-N               TO AMVT2000-IBENAT.
           MOVE AMVT0115-CMOEDA        TO AMVT2000-CMOEDA  .
           MOVE AMCV7301-ZCLIENTE-BEN  TO AMVT2000-ZCLIENTE.
           MOVE WS-CON-N1              TO AMVT2000-ZMORADA.
           MOVE SPACES                 TO AMVT2000-CENDALT.
           MOVE SPACES                 TO AMVT2000-CBALDO .
           MOVE SPACES                 TO AMVT2000-CPRDDO .
           MOVE SPACES                 TO AMVT2000-CNUMDO .
           MOVE SPACES                 TO AMVT2000-CDIGDO .
           MOVE ZEROS                  TO AMVT2000-ZCHQ   .
           MOVE WS-CON-9999-12-31      TO AMVT2000-DEMICART.

           EXEC SQL
                INSERT INTO AMVT2000_BENEFICI
                     VALUES ( :AMVT2000-CPRODUTO,
                              :AMVT2000-CBALCAO,
                              :AMVT2000-CNUMECTA,
                              :AMVT2000-CDIGICTA,
                              :AMVT2000-ZTITULAR,
                              :AMVT2000-ZGRUPBEN,
                              :AMVT2000-CPARENTE,
                              :AMVT2000-PERCBENF,
                              :AMVT2000-MBENEF,
                              :AMVT2000-IPENTEMP,
                              :AMVT2000-QPRAZO,
                              :AMVT2000-INDREVER,
                              :AMVT2000-GCONDBEN,
                              :AMVT2000-DCRIACAO,
                               CURRENT TIMESTAMP,
                              :AMVT2000-CUTULMOD,
                              :AMVT2000-IBENAT  ,
                              :AMVT2000-CMOEDA  ,
                              :AMVT2000-ZCLIENTE,
                              :AMVT2000-ZMORADA ,
                              :AMVT2000-CENDALT ,
                              :AMVT2000-CBALDO  ,
                              :AMVT2000-CPRDDO  ,
                              :AMVT2000-CNUMDO  ,
                              :AMVT2000-CDIGDO  ,
                              :AMVT2000-ZCHQ    ,
                              :AMVT2000-DEMICART,
                              :AMVT2000-CQUALPEN)
           END-EXEC.

           MOVE WS-CON-AMVT2000        TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT2000-OK
                 MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-537    TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-537    TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       2389-INSERE-AMT20-EXIT.
           EXIT.
      ******************************************************************
       2390-LIM-CONJUNTOS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2390-LIM-CONJUNTOS' END-IF.

           INITIALIZE AMCL0100-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMVT0115-CPRODUTO       TO AMCL0100-CPRODUTO.
           MOVE AMVT0115-CBALCAO        TO AMCL0100-CBALCAO.
           MOVE AMVT0115-CNUMECTA       TO AMCL0100-CNUMECTA.
           MOVE AMVT0115-CDIGICTA       TO AMCL0100-CDIGICTA.
           MOVE AMVT0115-CSUBPROD       TO AMCL0100-CSUBPROD.
           MOVE AMVT0115-CMOEDA         TO AMCL0100-CMOEDA.
           MOVE ZEROS                   TO AMCL0100-ZCLIENTE.
           MOVE ZEROS                   TO AMCL0100-MCAPITAL.

           MOVE WS-CON-0                TO AMCL0100-GPE-ESP.

           IF AMVT0115-CSUBPROD EQUAL WS-CON-83 OR
              AMVT0115-CSUBPROD EQUAL WS-CON-93 OR
              AMVT0115-CSUBPROD EQUAL WS-CON-A3 OR
              AMVT0115-CSUBPROD EQUAL WS-CON-89 OR
              AMVT0115-CSUBPROD EQUAL WS-CON-A9 OR
              AMVT0115-CSUBPROD EQUAL WS-CON-91 OR
              AMVT0115-CSUBPROD EQUAL WS-CON-A0
              MOVE ZEROS               TO AMCL0100-QAGRAVID
           ELSE
              MOVE AMCV7301-QAGRAVID   TO AMCL0100-QAGRAVID
           END-IF.

           MOVE AMCV7301-DCONTD         TO AMCL0100-DDIAOP.

           PERFORM 2391-CHAMA-AMCI0100
              THRU 2391-CHAMA-AMCI0100-EXIT.

           IF ATCL0001-SEM-ERROS  OR
              ATCL0001-AUTORIZACAO
              IF AMCL0100-QAGRAVID NOT EQUAL ZEROS
                 MOVE ZEROS         TO AMCL0100-QAGRAVID
                 PERFORM 2391-CHAMA-AMCI0100
                    THRU 2391-CHAMA-AMCI0100-EXIT
              END-IF
           END-IF.
      *
       2399-LIM-CONJUNTOS-EXIT.
           EXIT.
      ******************************************************************
       2391-CHAMA-AMCI0100.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2391-CHAMA-AMCI0100' END-IF.

           PERFORM AMCI0100-ROTINA
              THRU AMCI0100-EXIT.

           IF NOT AMCL0100-SEM-ERROS
              MOVE AMCL0100-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCL0100-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE ATCK0002-ABEND-DB2      TO ATCL0001-IND-ERROS
              MOVE AMCL0100-STATUS         TO AMCV7301-CTIPSOC-S
              MOVE AMCL0100-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
           ELSE
              IF AMCL0100-CRETORNO EQUAL ZEROS
                 IF ATCL0001-CBALCAO-OPER EQUAL WS-CON-777
      *          NÃO VALIDAR P '510'
                    IF AMCV7300-CLIBERAC NOT EQUAL WS-CON-1
                       IF AMCV7300-CSUBPROD EQUAL WS-CON-84 OR WS-CON-A4
                          IF AMCV7300-CDIGISOC-S NOT EQUAL
                             AMCK0004-AUTORIZ-NIVEL-4
                             MOVE WS-CON-AU       TO ATCL0001-IND-ERROS
                             MOVE AMCK0004-AUTORIZ-NIVEL-4
                                                  TO AMCV7301-CDIGISOC-S
                             MOVE AMCK0001-CON-040
                                                TO AMCV7301-CDIGISOC-MSG
                             EXEC CICS SYNCPOINT ROLLBACK END-EXEC
                          END-IF
                       ELSE
                          MOVE ATCK0002-ERROS-FUNCAO
                                                TO ATCL0001-IND-ERROS
                          MOVE AMCK0001-CON-040 TO AMCV7301-CDIGISOC-MSG
                          MOVE WS-CON-1         TO AMCV7301-CDIGISOC-S
                          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
                       END-IF
                    ELSE
                       IF AMCV7300-CDIGISOC-S NOT EQUAL
                          AMCK0004-AUTORIZ-NIVEL-4
                          MOVE WS-CON-AU        TO ATCL0001-IND-ERROS
                          MOVE AMCK0004-AUTORIZ-NIVEL-4
                                                TO AMCV7301-CDIGISOC-S
                          MOVE AMCK0001-CON-040 TO AMCV7301-CDIGISOC-MSG
                          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
                       END-IF
                    END-IF
                 ELSE
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-040      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                    EXEC CICS SYNCPOINT ROLLBACK END-EXEC
                 END-IF
              END-IF
           END-IF.
      *
       2391-CHAMA-AMCI0100-EXIT.
           EXIT.
      ******************************************************************
       2400-ANULA-CATIVO.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2400-ANULA-CATIVO' END-IF.

           PERFORM 2401-SELECT-DCT12
              THRU 2401-SELECT-DCT12-EXIT.

           IF ATCL0001-SEM-ERROS AND
              DCVT1202-OK
              PERFORM 2402-QUEDA-CATIVO
                 THRU 2402-QUEDA-CATIVO-EXIT
           END-IF.
      *
       2499-ANULA-CATIVO-EXIT.
           EXIT.
      ******************************************************************
       2401-SELECT-DCT12.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2401-SELECT-DCT12' END-IF.

           MOVE WS-CBALSAQ-CAT-ANT         TO DCVT1202-CBALCAO .
           MOVE WS-CPRODSAQ-CAT-ANT        TO DCVT1202-CPRODUTO.
           MOVE WS-CCNTSAQ-CAT-ANT         TO DCVT1202-CNUMECTA.
           MOVE WS-CDIGISAQ-CAT-ANT        TO DCVT1202-CDIGICTA.

           MOVE SPACES                     TO DCVT1202-GREFCAT.
           MOVE WS-CONTA-AM-MAE            TO DCVT1202-GREFCAT(1:12)

           EXEC SQL
                SELECT  GREFCAT
                  INTO :DCVT1202-GREFCAT
                  FROM  DCVT1202_CATIVOS
                 WHERE  CPRODUTO = :DCVT1202-CPRODUTO
                   AND  CBALCAO  = :DCVT1202-CBALCAO
                   AND  CNUMECTA = :DCVT1202-CNUMECTA
                   AND  CDIGICTA = :DCVT1202-CDIGICTA
                   AND  GREFCAT  = :DCVT1202-GREFCAT
           END-EXEC.

           MOVE WS-CON-DCVT1202    TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT .

           IF NOT DCVT1202-OK AND NOT DCVT1202-NOTFND
              MOVE ATCK0002-ABEND-DB2      TO ATCL0001-IND-ERROS
              MOVE WS-CON-1                TO AMCV7301-CTIPSOC-S
              MOVE DPCK0001-CATIVOS-NOTFND TO AMCV7301-CTIPSOC-MSG
           END-IF.
      *
       2401-SELECT-DCT12-EXIT.
           EXIT.
      ******************************************************************
       2402-QUEDA-CATIVO.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2402-QUEDA-CATIVO' END-IF.

           MOVE ZEROS                   TO OPCV1300-CBALCAO-S
                                           OPCV1300-CBALCAO-MSG
                                           OPCV1300-NUMCONTA-S
                                           OPCV1300-NUMCONTA-MSG
                                           OPCV1300-GREFCAT-S
                                           OPCV1300-GREFCAT-MSG.

           MOVE WS-CBALSAQ-CAT-ANT    TO OPCV1300-CBALCAO.
           MOVE WS-CPRODSAQ-CAT-ANT   TO WS-CPRODSAQ.
           MOVE WS-CCNTSAQ-CAT-ANT    TO WS-CCNTSAQ.
           MOVE WS-CDIGISAQ-CAT-ANT   TO WS-CDIGISAQ.
           MOVE WS-NUMCTADO           TO OPCV1300-NUMCONTA.

           MOVE SPACES                TO OPCV1300-GREFCAT.
           MOVE WS-CONTA-AM-MAE       TO OPCV1300-GREFCAT(1:12).

           MOVE OPCV1300-NR-CAMPOS TO ATCW0009-NR-CAMPOS-SUB-FUNCAO .
           MOVE OPCV1300-LENGTH TO ATCW0009-LENGTH-MSG-SUB-FUNCAO .
           MOVE OPCV1300-MSG    TO ATCW0009-MSG-SUB-FUNCAO .
           MOVE WS-CON-OP       TO ATCW0009-CAPLIC-SUB-FUNCAO .
           MOVE WS-CON-13       TO ATCW0009-COPCAO-SUB-FUNCAO .
           MOVE WS-CON-OPI13060 TO ATCW0009-PGMID .

           ADD  1                        TO ATCW0009-SEQUENCIA-OPER.
           PERFORM ATCP0007-NOVA-FUNCAO
              THRU ATCP0007-NOVA-FUNCAO-EXIT .
           MOVE ATCW0009-MSG             TO OPCV1301-MSG.

           IF NOT ATCL0001-SEM-ERROS

              EXEC CICS SYNCPOINT ROLLBACK END-EXEC

              MOVE OPCV1301-CBALCAO-S    TO AMCV7301-CBALCAO-S
              MOVE OPCV1301-CBALCAO-MSG  TO AMCV7301-CBALCAO-MSG
              MOVE OPCV1301-NUMCONTA-S   TO AMCV7301-NUMCONTA-S
              MOVE OPCV1301-NUMCONTA-MSG TO AMCV7301-NUMCONTA-MSG
              MOVE OPCV1301-GREFCAT-S    TO AMCV7301-MMOVIM-S
              MOVE OPCV1301-GREFCAT-MSG  TO AMCV7301-MMOVIM-MSG
           END-IF.
      *
       2402-QUEDA-CATIVO-EXIT.
           EXIT.
      ******************************************************************
       2400-INSERE-CATIVO.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2400-INSERE-CATIVO' END-IF.

           MOVE ZEROS                 TO OPCV0900-CBALCAO-S
                                         OPCV0900-CBALCAO-MSG
                                         OPCV0900-NUMCONTA-S
                                         OPCV0900-NUMCONTA-MSG
                                         OPCV0900-MMOVIM-S
                                         OPCV0900-MMOVIM-MSG
                                         OPCV0900-CCODCAT-S
                                         OPCV0900-CCODCAT-MSG
                                         OPCV0900-DDCATIV-S
                                         OPCV0900-DDCATIV-MSG
                                         OPCV0900-CCONTA-S
                                         OPCV0900-CCONTA-MSG
                                         OPCV0900-REF-DOC-S
                                         OPCV0900-REF-DOC-MSG.

           MOVE AMCV7300-MMOVIM-S    TO OPCV0900-MMOVIM-S
           MOVE AMCV7300-MMOVIM-MSG  TO OPCV0900-MMOVIM-MSG

           INITIALIZE OPCV0900-ADE.
           MOVE AMCV7301-CBALSAQ      TO OPCV0900-CBALCAO.
           MOVE AMCV7301-CPRODSAQ     TO WS-CPRODSAQ.
           MOVE AMCV7301-CCNTSAQ      TO WS-CCNTSAQ.
           MOVE AMCV7301-CDIGISAQ     TO WS-CDIGISAQ.
           MOVE WS-NUMCTADO           TO OPCV0900-NUMCONTA.
           MOVE WS-TOTAL-MAE          TO OPCV0900-MMOVIM.
           ADD  WS-TOTAL-COMP1        TO OPCV0900-MMOVIM.
           ADD  WS-TOTAL-COMP2        TO OPCV0900-MMOVIM.
           MOVE AMCV7301-CMOEDA       TO OPCV0900-CMOEDA.

           MOVE WS-CON-AM             TO OPCV0900-CCODCAT.
           MOVE 999                   TO OPCV0900-DDCATIV.
           MOVE SPACES                TO OPCV0900-CCONTA
                                         OPCV0900-IDIAS.
           MOVE SPACES                TO OPCV0900-REF-DOC.
           MOVE WS-CONTA-AM-MAE       TO OPCV0900-REF-DOC(1:12).
           MOVE OPCV0900-NR-CAMPOS    TO ATCW0009-NR-CAMPOS-SUB-FUNCAO.
           MOVE OPCV0900-LENGTH       TO ATCW0009-LENGTH-MSG-SUB-FUNCAO.
           MOVE OPCV0900-MSG          TO ATCW0009-MSG-SUB-FUNCAO.
           MOVE WS-CON-OP             TO ATCW0009-CAPLIC-SUB-FUNCAO.
           MOVE WS-CON-09             TO ATCW0009-COPCAO-SUB-FUNCAO.
           MOVE WS-CON-OPI09090       TO ATCW0009-PGMID.
           COMPUTE ATCW0009-SEQUENCIA-OPER =
                                ATCW0009-SEQUENCIA-OPER + 1.
           PERFORM ATCP0007-NOVA-FUNCAO
              THRU ATCP0007-NOVA-FUNCAO-EXIT.
           MOVE  ATCW0009-MSG         TO OPCV0901-MSG.

           IF NOT ATCL0001-SEM-ERROS

              EXEC CICS SYNCPOINT ROLLBACK END-EXEC

              MOVE OPCV0901-CBALCAO-S    TO AMCV7301-CBALCAO-S
              MOVE OPCV0901-CBALCAO-MSG  TO AMCV7301-CBALCAO-MSG
              MOVE OPCV0901-NUMCONTA-S   TO AMCV7301-NUMCONTA-S
              MOVE OPCV0901-NUMCONTA-MSG TO AMCV7301-NUMCONTA-MSG
              MOVE OPCV0901-MMOVIM-S     TO AMCV7301-MMOVIM-S
              MOVE AMCK0001-CON-929      TO AMCV7301-MMOVIM-MSG
              MOVE OPCV0901-CCODCAT-S    TO AMCV7301-CCODCAT-S
              MOVE OPCV0901-CCODCAT-MSG  TO AMCV7301-CCODCAT-MSG
              MOVE OPCV0901-DDCATIV-S    TO AMCV7301-DDCATIV-S
              MOVE OPCV0901-DDCATIV-MSG  TO AMCV7301-DDCATIV-MSG
              MOVE OPCV0901-CCONTA-S     TO AMCV7301-CCONTA-S
              MOVE OPCV0901-CCONTA-MSG   TO AMCV7301-CCONTA-MSG
              MOVE OPCV0901-REF-DOC-S    TO AMCV7301-REF-DOC-S
              MOVE OPCV0901-REF-DOC-MSG  TO AMCV7301-REF-DOC-MSG
           END-IF.
      *
       2499-INSERE-CATIVO-EXIT.
           EXIT.
      ******************************************************************
       2500-FORMATA-OUTPUT.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '2500-FORMATA-OUTPUT' END-IF.

           MOVE AMCV7301-COPERAC         TO AMCV7301-COPERAC-P  .
           MOVE AMCV7301-DNASCIM-SOC1    TO AMCV7301-DNASCIM-P .
           MOVE AMCV7301-DNASCIM-BEN     TO AMCV7301-DNASCIMB-P.
           MOVE WS-IDADEACT-SOCIO        TO AMCV7301-IDADEACT-P .
           MOVE AMCV7301-QAGRAVID        TO AMCV7301-QAGRAVID-P .
      * ALT02 (I)
      *    MOVE WS-IDADRECB-MAE          TO AMCV7301-IDADRECB-P .
           MOVE WS-IDADEACT-DTVENCIM     TO AMCV7301-IDADRECB-P .
           MOVE WS-IDADRECB-MAE          TO AMCV7301-QIDRFSOL-P .
      * ALT02 (F)
           MOVE WS-IDADEACT-BEN          TO AMCV7301-IDADAIBP-P .
           MOVE WS-QPRAZO-MAE            TO AMCV7301-QPRAZO-P .
           MOVE ZEROS                    TO AMCV7301-QANOSDIF-P .
           MOVE AMCV7301-DCONTD          TO AMCV7301-DCONTD-P .
           MOVE WS-CON-00010101          TO AMCV7301-DULTMELH-P.
           MOVE WS-DFIMCOBQ-MAE          TO ATCW3000-DATA10.
           PERFORM ATCP3000-CONV-DATA108
              THRU ATCP3000-CONV-DATA108-EXIT
           MOVE ATCW3000-DATA8           TO AMCV7301-DFIMCOBQ-P .
           MOVE WS-DTVENCIM-MAE          TO ATCW3000-DATA10.
           PERFORM ATCP3000-CONV-DATA108
              THRU ATCP3000-CONV-DATA108-EXIT
           MOVE ATCW3000-DATA8           TO AMCV7301-DTVENCIM-P .
           MOVE AMCV7301-CPLSUBS         TO AMCV7301-CPLSUBS-P.
           MOVE AMCV7301-TXPROG          TO AMCV7301-TXPROG-P .
           MOVE WS-ICNTSEG-MAE           TO AMCV7301-ICNTSEG-P .
           MOVE WS-CPERFRA-MAE           TO AMCV7301-CPERFRA-P.
           MOVE AMCV7300-INDSBPRO-CTI    TO AMCV7301-CCOBADIC-P .
           MOVE ZEROS                    TO AMCV7301-MMELHORI-P .
           MOVE AMCV7301-MCAPITAL        TO AMCV7301-MCAPITAL-P .
           MOVE AMCV7301-MQUOTAIN        TO AMCV7301-MQUOTAIN-P .
           MOVE AMCV7301-MQUOTAIN-CTI    TO AMCV7301-MQUOTAI2-P .
           MOVE AMCV7301-MQUOTAIN-CS     TO AMCV7301-MQUOTAI3-P .
           MOVE AMCV7301-MQUOTAIN        TO AMCV7301-MQUOTAAC-P .
           MOVE AMCV7301-MCAPITAL        TO AMCV7301-MCAPACTU-P .
           MOVE AMCV7301-MMOVIM          TO AMCV7301-SQTVENCD-P .
           MOVE AMCV7301-MMOVIM          TO AMCV7301-SQTVENCA-P .
           MOVE AMCV7301-DCONTD          TO AMCV7301-DCALC-P .
           MOVE AMCV7301-MCAPITAL        TO AMCV7301-MCAPITNV-P .
           MOVE AMCV7301-MQUOTAIN        TO AMCV7301-MNQUOTIN-P .
           MOVE AMCV7301-MQUOTAIN-CTI    TO AMCV7301-MNQUOTI2-P .
           MOVE AMCV7301-MQUOTAIN-CS     TO AMCV7301-MNQUOTI3-P .
           MOVE AMCV7301-CPLSUBS         TO AMCV7301-CPLSUBNV-P.
           MOVE AMCV7301-TXPROG          TO AMCV7301-TXPROGNV-P .
      * ALT02 (I)
      *    MOVE WS-IDADRECB-MAE          TO AMCV7301-IDADRECN-P .
           MOVE WS-IDADEACT-DTVENCIM     TO AMCV7301-IDADRECN-P .
      * ALT02 (F)

           IF AMCV7301-CSUBPROD EQUAL WS-CON-83
           OR AMCV7301-CSUBPROD EQUAL WS-CON-93
           OR AMCV7301-CSUBPROD EQUAL WS-CON-A3
              MOVE AMCV7301-MMOVIM       TO AMCV7301-SQTVENCD-P
              MOVE AMCV7301-MMOVIM-CTI   TO AMCV7301-SQTVENCA-P
              MOVE AMCV7301-MMOVIM-CS    TO AMCV7301-MNQUOTIN-P
              MOVE AMCV7301-MCAPITAL-CTI TO AMCV7301-MCAPITNV-P
           END-IF.

           IF WS-CTEXAMED-MAE GREATER WS-CTEXAMED-CTI
              IF WS-CTEXAMED-MAE GREATER WS-CTEXAMED-CS
                 MOVE WS-CTEXAMED-MAE   TO AMCV7301-CTEXAMED
              ELSE
                 MOVE WS-CTEXAMED-CS    TO AMCV7301-CTEXAMED
              END-IF
           ELSE
              IF WS-CTEXAMED-CTI GREATER WS-CTEXAMED-CS
                 MOVE WS-CTEXAMED-CTI   TO AMCV7301-CTEXAMED
              ELSE
                 MOVE WS-CTEXAMED-CS    TO AMCV7301-CTEXAMED
              END-IF
           END-IF.
      *
           IF  AMCV7300-CORIGASS = CON-CLI-FINIBANCO
           AND ATCL0001-SEM-ERROS
           AND NOT ATCL0001-SIMULACAO-SIM
               PERFORM 4000-UPD-AMT47
                  THRU 4000-EXIT
           END-IF.
      *
      **** ----------------------------------------------------------
      **** SOMENTE CLIENTES FINIBANCO PODEM TER A 'CONTA FINIBANCO'
      **** ASSOCIADA PARA DÉBITO.
      **** ----------------------------------------------------------
           IF  AMCV7300-CORIGASS NOT = CON-CLI-FINIBANCO
           AND ATCL0001-SEM-ERROS
               PERFORM 4100-VAL-CONTA-FININ
                  THRU 4100-EXIT
           END-IF.
      *
       2599-FORMATA-OUTPUT-EXIT.
           EXIT.
      ******************************************************************
      *            FIM DO PROGRAMA (DEVOLVE A ARQUITECTURA DADOS)      *
      ******************************************************************
       3000-FINAL-PROGRAMA.
           IF SW-DEBUG-SIM
              DISPLAY '3000-FINAL-PROGRAMA - AMI73060'
           END-IF.

           IF ATCL0001-SEM-ERROS AND
              NOT ATCL0001-SIMULACAO-SIM
              PERFORM 3010-JOURNAL
                 THRU 3019-JOURNAL-EXIT
           END-IF.

 MAB***--- VAI CHAMAR A ROTINA DE REGISTO DE TESTES DE PROGRAMAS
 MAB***    IF ATCL0001-ERROS-VALIDOS
 MAB***
 MAB***       INITIALIZE SYCL4500-AREA
 MAB***       MOVE 'AMI73060'            TO SYCL4500-NPROGRAM
 MAB***       MOVE '0001-01-01'          TO SYCL4500-DTEMISS
 MAB***       MOVE AMCV7300-CTIPSOC      TO SYCL4500-CTIPSOC
 MAB***       MOVE AMCV7300-ZSOCIO       TO SYCL4500-ZSOCIO
 MAB***       MOVE AMCV7300-CDIGISOC     TO SYCL4500-CDIGISOC
 MAB***       MOVE AMCV7300-ZINSCRIC     TO SYCL4500-ZINSCRIC
 MAB***       MOVE AMCV7300-CPRODUTO     TO SYCL4500-CPRODUTO
 MAB***       MOVE AMCV7300-CSUBPROD     TO SYCL4500-CSUBPROD
 MAB***       MOVE AMCV7300-CBALCAO      TO SYCL4500-CBALCAO
 MAB***       MOVE AMCV7300-CPRODUTO-N   TO SYCL4500-CPRODUTO
 MAB***       MOVE AMCV7300-CNUMECTA     TO SYCL4500-CNUMECTA
 MAB***       MOVE AMCV7300-CDIGICTA     TO SYCL4500-CDIGICTA
 MAB***       PERFORM SYCP4500-INS-SYT45
 MAB***          THRU SYCP4500-INS-SYT45-EXIT
 MAB***
 MAB***       IF SYCL4500-SEM-ERROS
 MAB***          NEXT SENTENCE
 MAB***       ELSE
 MAB***          MOVE ATCK0001-ERRO-DB2  TO ATCL0001-COD-ERRO-GRAVE
 MAB***          MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
 MAB***          MOVE 1                  TO AMCV7301-CTIPSOC-S
 MAB***          MOVE AMCK0001-CON-841   TO AMCV7301-CTIPSOC-MSG
 MAB***       END-IF
 MAB***
 MAB***    END-IF.

           MOVE AMCV7301-LENGTH            TO ATCL0001-LENGTH-MSG.
           MOVE AMCV7301-NR-CAMPOS         TO ATCL0001-NR-CAMPOS.
           MOVE AMCV7301-MSG               TO ATCL0001-MSG.
      *
           IF NOT ATCL0001-SEM-ERROS
              EXEC CICS
                   SYNCPOINT ROLLBACK
              END-EXEC
           END-IF.
      *
           EXEC CICS
                RETURN
           END-EXEC.
      *
       3999-FINAL-PROGRAMA-EXIT.
           EXIT.
      ******************************************************************
      *            FORMATA AREA DE JOURNAL                             *
      ******************************************************************
       3010-JOURNAL.
           IF SW-DEBUG-SIM DISPLAY '3010-JOURNAL' END-IF.

           COPY ATCP0003.

           MOVE AMCV7300-MSG               TO SYCW0001-MENSAGEM-INP.
           MOVE AMCV7301-NR-CAMPOS         TO SYCW0001-NR-CAMPOS.
           MOVE AMCV7301-LENGTH            TO SYCW0001-LENGTH-MSG.
           MOVE AMCV7301-MSG               TO SYCW0001-MENSAGEM-OUT.

           EXEC SQL INCLUDE ATCP0005 END-EXEC.
      *
       3019-JOURNAL-EXIT.
           EXIT.
      ******************************************************************
       4000-UPD-AMT47.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '4000-UPD-AMT47' END-IF.

           PERFORM 4010-SEL-AMT47
              THRU 4010-EXIT.
      *
           IF AMCLTB47-O-CBIC     (1) NOT = AMCV7301-CBIC
           OR AMCLTB47-O-CIBAN    (1) NOT = AMCV7301-CIBAN
           OR AMCLTB47-O-DAUTORIZ (1) NOT = AMCV7301-DAUTORIZ
           OR AMCLTB47-O-CBALCDO  (1) NOT = AMCV7300-CBALSAQ
           OR AMCLTB47-O-CPRODDO  (1) NOT = AMCV7300-CPRODSAQ
           OR AMCLTB47-O-CCONTADO (1) NOT = AMCV7300-CCNTSAQ
           OR AMCLTB47-O-CDIGDO   (1) NOT = AMCV7300-CDIGISAQ
              PERFORM 4020-UPD-AMT47
                 THRU 4020-EXIT
           END-IF.
      *
       4000-EXIT. EXIT.
      ******************************************************************
       4010-SEL-AMT47.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '4010-SEL-AMT47' END-IF.
      *
           PERFORM AMCPTB47-INICIALIZAR
              THRU AMCPTB47-FIM.
      *
           MOVE AMCV7300-CBALCAO            TO AMCLTB47-I-CBALCAO
           MOVE AMCV7300-CPRODUTO-N         TO AMCLTB47-I-CPRODUTO
           MOVE AMCV7300-CNUMECTA           TO AMCLTB47-I-CNUMECTA
           MOVE AMCV7300-CDIGICTA           TO AMCLTB47-I-CDIGICTA
      ****
           MOVE ATCL0001-DATA-PROCESSO      TO WS-DATA-08.
           MOVE CORR WS-DATA-08             TO WS-DATA-10.
           MOVE WS-DATA-10                  TO AMCLTB47-I-DPROC
           MOVE ATCL0001-CUTILIZA           TO AMCLTB47-I-CUTILIZA
           MOVE 'AMI73060'                  TO AMCLTB47-I-NPROG
           SET  AMCLTB47-SELECT             TO TRUE
           MOVE ATCL0001-CTERM              TO AMCLTB47-I-CTERM
           MOVE ATCL0001-NR-SEQUENCIA       TO AMCLTB47-I-ZJOURNAL
      *
           PERFORM AMCPTB47-CALL-AMR0TB47
              THRU AMCPTB47-EXIT.
      *
           IF NOT AMCLTB47-SEM-ERROS
              MOVE AMCLTB47-IND-ERROS       TO ATCL0001-IND-ERROS
              MOVE AMCLTB47-SQLCA           TO SQLCA
              IF ATCL0001-ERROS-FUNCAO
                 MOVE WS-CON-1              TO AMCV7301-NUMCONTA-S
                 MOVE AMCLTB47-COD-ERRO     TO AMCV7301-NUMCONTA-MSG
              ELSE
                 MOVE AMCLTB47-TABELA       TO ATCL0001-TABLE-NAME
                 MOVE ATCK0001-ERRO-DB2     TO ATCL0001-COD-ERRO-GRAVE
              END-IF
              STRING AMCLTB47-PARAGRAFO (1:5)
                 '.' AMCV7300-CBALCAO
                 '.' AMCV7300-CPRODUTO-N
                 '.' AMCV7300-CNUMECTA
                 '-' AMCV7300-CDIGICTA
                 '.' ATCL0001-CTERM
                 '.' DELIMITED BY SIZE    INTO ATCL0001-SQLERRM-DATA
              END-STRING
              GO TO 3000-FINAL-PROGRAMA
           END-IF.
      *
       4010-EXIT. EXIT.
      ******************************************************************
       4020-UPD-AMT47.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '4020-UPD-AMT47' END-IF.
      *
           PERFORM AMCPTB47-INICIALIZAR
              THRU AMCPTB47-FIM.
      *
           MOVE AMCV7300-CBALCAO            TO AMCLTB47-I-CBALCAO
           MOVE AMCV7300-CPRODUTO-N         TO AMCLTB47-I-CPRODUTO
           MOVE AMCV7300-CNUMECTA           TO AMCLTB47-I-CNUMECTA
           MOVE AMCV7300-CDIGICTA           TO AMCLTB47-I-CDIGICTA
           MOVE AMCV7300-CORIGASS           TO AMCLTB47-I-CORIGASS
      *
           MOVE AMCV7301-CBIC               TO AMCLTB47-I-CBIC
           MOVE AMCV7301-CIBAN              TO AMCLTB47-I-CIBAN
           MOVE AMCV7301-DAUTORIZ           TO AMCLTB47-I-DAUTORIZ
           MOVE AMCLTB47-O-CESTADO (1)      TO AMCLTB47-I-CESTADO
      *
           MOVE ATCL0001-DATA-PROCESSO      TO WS-DATA-08.
           MOVE CORR WS-DATA-08             TO WS-DATA-10.
           MOVE WS-DATA-10                  TO AMCLTB47-I-DPROC
           MOVE ATCL0001-CUTILIZA           TO AMCLTB47-I-CUTILIZA
           MOVE 'AMI73060'                  TO AMCLTB47-I-NPROG
           MOVE ATCL0001-CTERM              TO AMCLTB47-I-CTERM
           MOVE ATCL0001-NR-SEQUENCIA       TO AMCLTB47-I-ZJOURNAL
           SET  AMCLTB47-UPDATE             TO TRUE
      *
           PERFORM AMCPTB47-CALL-AMR0TB47
              THRU AMCPTB47-EXIT.
      *
           IF NOT AMCLTB47-SEM-ERROS
              MOVE AMCLTB47-IND-ERROS       TO ATCL0001-IND-ERROS
              MOVE AMCLTB47-SQLCA           TO SQLCA
              IF ATCL0001-ERROS-FUNCAO
                 MOVE WS-CON-1              TO AMCV7301-NUMCONTA-S
                 MOVE AMCLTB47-COD-ERRO     TO AMCV7301-NUMCONTA-MSG
              ELSE
                 MOVE AMCLTB47-TABELA       TO ATCL0001-TABLE-NAME
                 MOVE ATCK0001-ERRO-DB2     TO ATCL0001-COD-ERRO-GRAVE
              END-IF
              STRING AMCLTB47-PARAGRAFO (1:5)
                 '.' AMCV7300-CBALCAO
                 '.' AMCV7300-CPRODUTO-N
                 '.' AMCV7300-CNUMECTA
                 '-' AMCV7300-CDIGICTA
                 '.' ATCL0001-CTERM
                 '.' DELIMITED BY SIZE    INTO ATCL0001-SQLERRM-DATA
              END-STRING
              GO TO 3000-FINAL-PROGRAMA
           END-IF.
      *
       4020-EXIT. EXIT.
      ******************************************************************
       4100-VAL-CONTA-FININ.
      ******************************************************************
      * OBTER CONTA SAQUE PADRAO P/ CLEIENTES C/ ORIGEM NO FINIBANCO
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '4100-VAL-CONTA-FININ' END-IF.
      *
           EXEC SQL
                SELECT  NELEMC01
                  INTO :TAVT0200-NELEMC01
                  FROM  TAVT0200_TABELAS
                 WHERE  CTABELA  = 'A83'
                   AND  CELEMTAB = 'CTAFINIB'
           END-EXEC
      *
           PERFORM 9020-DB2CHECK
              THRU 9029-DB2CHECK-EXIT.
           EVALUATE TRUE
           WHEN DB2-OK
                MOVE TAVT0200-NELEMC01      TO WS-CONTA-AUX
           WHEN DB2-NOTFND
      ****      AM497 - ERRO CENTRAL DE ACESSO À TATO2
                SET  ATCL0001-ERROS-FUNCAO  TO TRUE
                MOVE '1'                    TO AMCV7301-NUMCONTA-S
                MOVE AMCK0001-CON-497       TO AMCV7301-NUMCONTA-MSG
                PERFORM 3000-FINAL-PROGRAMA
           WHEN OTHER
      ****      ABEND DB2
                MOVE 'TAVT0200'             TO ATCL0001-TABLE-NAME
                SET  ATCL0001-ABEND-DB2     TO TRUE
                MOVE '1'                    TO AMCV7301-NUMCONTA-S
                MOVE AMCK0001-CON-497       TO AMCV7301-NUMCONTA-MSG
                STRING '4100-'
                   '.' 'A83'
                   '.' 'CTAFINIB'
                   '.' ATCL0001-CTERM
                   '.' DELIMITED BY SIZE  INTO ATCL0001-SQLERRM-DATA
                END-STRING
                PERFORM 3000-FINAL-PROGRAMA
           END-EVALUATE.
      *
      *
           IF  AMCV7300-CBALSAQ  = WS-CBALCAO-AUX
           AND AMCV7300-CPRODSAQ = WS-CPRODUTO-AUX
           AND AMCV7300-CCNTSAQ  = WS-CNUMECTA-AUX
           AND AMCV7300-CDIGISAQ = WS-CDIGICTA-AUX
      ****     -------------------------------------------------
      ****     CONTA FINIBANCO ASSOCIADA A CLIENTE NÃO-FINIBANCO
      ****     -------------------------------------------------
      ****     AM023 - OPERAÇÃO NÃO PERMITIDA
      ****     -------------------------------------------------
               SET   ATCL0001-ERROS-FUNCAO  TO TRUE
               MOVE '1'                     TO AMCV7301-NUMCONTA-S
               MOVE AMCK0001-CON-023        TO AMCV7301-NUMCONTA-MSG
               PERFORM 3000-FINAL-PROGRAMA
      ****     -------------------------------------------------
           END-IF.
      *
       4100-EXIT. EXIT.
      ******************************************************************
      *  CALCULA LIBERACOES A CABECA PARA AS MODALIDADES MAE           *
      ******************************************************************
       5000-CALCULA-LIB-MAE.
           IF SW-DEBUG-SIM DISPLAY '5000-CALCULA-LIB-MAE' END-IF.
      *
           INITIALIZE WS-CELEMTAB-COMPLETO
           REPLACING  ALPHANUMERIC DATA BY SPACES
                      NUMERIC DATA BY ZEROS.
      *
           IF AMCV7300-CPLSUBS     EQUAL WS-CON-CA
              MOVE AMCV7300-CPLSUBS      TO WS-CPLSUBS
           ELSE
              MOVE SPACES                TO WS-CPLSUBS
           END-IF
      *
           STRING
                 WS-CON-AM76             DELIMITED BY SIZE
                 AMCV7300-CPRODUTO       DELIMITED BY SIZE
                 AMCV7300-CSUBPROD       DELIMITED BY SIZE
                 WS-CPLSUBS              DELIMITED BY SIZE
                 INTO WS-CELEMTAB-COMPLETO
           END-STRING
      *
           PERFORM 6000-OBTEM-DATA
              THRU 6000-OBTEM-DATA-EXIT
      *
           EXEC SQL
              SET :WS-CURRENTDATE   =  CURRENT DATE
           END-EXEC.

           IF SW-DEBUG-SIM
              DISPLAY '================================ '
              DISPLAY 'WS-NELEMC01          ' WS-NELEMC01
              DISPLAY 'WS-CURRENTDATE       ' WS-CURRENTDATE
              DISPLAY 'WS-CELEMTAB-COMPLETO:' WS-CELEMTAB-COMPLETO
              DISPLAY '================================ '
              DISPLAY 'AMCV7300-CTIPSOC     ' AMCV7300-CTIPSOC
              DISPLAY 'AMCV7300-ZSOCIO      ' AMCV7300-ZSOCIO
              DISPLAY 'AMCV7300-CDIGISOC    ' AMCV7300-CDIGISOC
              DISPLAY 'AMCV7300-GTITULO     ' AMCV7300-GTITULO
              DISPLAY 'AMCV7300-ZINSCRIC    ' AMCV7300-ZINSCRIC
              DISPLAY 'AMCV7300-CPRODUTO    ' AMCV7300-CPRODUTO
              DISPLAY 'AMCV7300-CSUBPROD    ' AMCV7300-CSUBPROD
              DISPLAY 'AMCV7300-CBALCAO     ' AMCV7300-CBALCAO
              DISPLAY 'AMCV7300-NUMCONTA    ' AMCV7300-NUMCONTA
              DISPLAY 'AMCV7300-CPRODUTO-N  ' AMCV7300-CPRODUTO-N
              DISPLAY 'AMCV7300-CNUMECTA    ' AMCV7300-CNUMECTA
              DISPLAY 'AMCV7300-CDIGICTA    ' AMCV7300-CDIGICTA
              DISPLAY '================================ '
           END-IF
      **
           EVALUATE TRUE
              WHEN (AMCV7300-CPRODUTO EQUAL WS-CON-71 AND
                    AMCV7300-CSUBPROD EQUAL (WS-CON-81 OR WS-CON-A1))
                    IF WS-NELEMC01 > WS-CURRENTDATE
                       PERFORM 5010-AMCI6000
                          THRU 5019-AMCI6000-EXIT
                    ELSE
                       PERFORM 6010-AMR07000
                          THRU 6010-AMR07000-EXIT
                    END-IF
              WHEN (AMCV7300-CPRODUTO EQUAL WS-CON-73 AND
                    AMCV7300-CSUBPROD EQUAL WS-CON-83)
                    IF WS-NELEMC01 > WS-CURRENTDATE
                       PERFORM 5010-AMCI6002
                          THRU 5019-AMCI6002-EXIT
                    ELSE
                       PERFORM 6010-AMR07002
                          THRU 6010-AMR07002-EXIT
                    END-IF
              WHEN (AMCV7300-CPRODUTO EQUAL WS-CON-73 AND
                    AMCV7300-CSUBPROD EQUAL (WS-CON-93 OR WS-CON-A3))
                    IF WS-NELEMC01 > WS-CURRENTDATE
                       PERFORM 5010-AMCI6002
                          THRU 5019-AMCI6002-EXIT
                    ELSE
                       PERFORM 6010-AMR07002
                          THRU 6010-AMR07002-EXIT
                    END-IF
              WHEN (AMCV7300-CPRODUTO EQUAL WS-CON-72 AND
                    AMCV7300-CSUBPROD EQUAL (WS-CON-84 OR WS-CON-A4))
                    IF WS-NELEMC01 > WS-CURRENTDATE
                       PERFORM 5010-AMCI6006
                          THRU 5019-AMCI6006-EXIT
                    ELSE
                       PERFORM 6010-AMR07006
                          THRU 6010-AMR07006-EXIT
                    END-IF
              WHEN (AMCV7300-CPRODUTO EQUAL WS-CON-72 AND
                    AMCV7300-CSUBPROD EQUAL (WS-CON-96 OR WS-CON-A6))
                    IF WS-NELEMC01 > WS-CURRENTDATE
                       PERFORM 5010-AMCI6008
                          THRU 5019-AMCI6008-EXIT
                    ELSE
                       PERFORM 6010-AMR07008
                          THRU 6010-AMR07008-EXIT
                    END-IF
              WHEN OTHER
                   MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-938      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-EVALUATE.
      *
       5999-CALCULA-LIB-MAE-EXIT.
           EXIT.
      ******************************************************************
      *  CALCULA LIBERACOES A CABECA PARA AS MODALIDADES FILHAS        *
      ******************************************************************
       5000-CALCULA-LIB-FILHA.
           IF SW-DEBUG-SIM DISPLAY '5000-CALCULA-LIB-FILHA' END-IF.

           INITIALIZE WS-CELEMTAB-COMPLETO
           REPLACING  ALPHANUMERIC DATA BY SPACES
                      NUMERIC DATA BY ZEROS.
      *
           IF AMCV7300-CPLSUBS     EQUAL WS-CON-CA
              MOVE AMCV7300-CPLSUBS      TO WS-CPLSUBS
           ELSE
              MOVE SPACES                TO WS-CPLSUBS
           END-IF
      *
           STRING
                 WS-CON-AM76             DELIMITED BY SIZE
                 AMCV7300-CPRODUTO       DELIMITED BY SIZE
                 AMCV7300-CSUBPROD       DELIMITED BY SIZE
                 WS-CPLSUBS              DELIMITED BY SIZE
                 INTO WS-CELEMTAB-COMPLETO
           END-STRING
      *
           PERFORM 6000-OBTEM-DATA
              THRU 6000-OBTEM-DATA-EXIT
      *
           EXEC SQL
              SET :WS-CURRENTDATE   =  CURRENT DATE
           END-EXEC.
           IF SW-DEBUG-SIM
              DISPLAY '================================ '
              DISPLAY 'WS-NELEMC01          ' WS-NELEMC01
              DISPLAY 'WS-CURRENTDATE       ' WS-CURRENTDATE
              DISPLAY 'WS-CELEMTAB-COMPLETO:' WS-CELEMTAB-COMPLETO
              DISPLAY '================================ '
              DISPLAY 'AMCV7300-CTIPSOC     ' AMCV7300-CTIPSOC
              DISPLAY 'AMCV7300-ZSOCIO      ' AMCV7300-ZSOCIO
              DISPLAY 'AMCV7300-CDIGISOC    ' AMCV7300-CDIGISOC
              DISPLAY 'AMCV7300-GTITULO     ' AMCV7300-GTITULO
              DISPLAY 'AMCV7300-ZINSCRIC    ' AMCV7300-ZINSCRIC
              DISPLAY 'AMCV7300-CPRODUTO    ' AMCV7300-CPRODUTO
              DISPLAY 'AMCV7300-CSUBPROD    ' AMCV7300-CSUBPROD
              DISPLAY 'AMCV7300-CBALCAO     ' AMCV7300-CBALCAO
              DISPLAY 'AMCV7300-NUMCONTA    ' AMCV7300-NUMCONTA
              DISPLAY 'AMCV7300-CPRODUTO-N  ' AMCV7300-CPRODUTO-N
              DISPLAY 'AMCV7300-CNUMECTA    ' AMCV7300-CNUMECTA
              DISPLAY 'AMCV7300-CDIGICTA    ' AMCV7300-CDIGICTA
              DISPLAY '================================ '
           END-IF
      **
           EVALUATE TRUE
              WHEN  AMCV7300-ICTI EQUAL WS-CON-1
                    IF WS-NELEMC01 > WS-CURRENTDATE
                       PERFORM 5010-AMCI6010
                          THRU 5019-AMCI6010-EXIT
                    ELSE
                       PERFORM 6010-AMR07010
                          THRU 6010-AMR07010-EXIT
                    END-IF
           END-EVALUATE.
      *
       5999-CALCULA-LIB-FILHA-EXIT.
           EXIT.
      ******************************************************************
       6000-OBTEM-DATA.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '6000-OBTEM-DATA' END-IF.
      *
           INITIALIZE DCLTAVT0200-TABELAS
                      REPLACING ALPHANUMERIC DATA BY SPACES
                                     NUMERIC DATA BY ZEROS.
      *
           MOVE WS-CELEMTAB-COMPLETO     TO TAVT0200-CELEMTAB
           MOVE WS-CON-AM2               TO TAVT0200-CTABELA
      *
           EXEC SQL
              SELECT NELEMC01
                INTO :TAVT0200-NELEMC01
                FROM TAVT0200_TABELAS
               WHERE CELEMTAB = :TAVT0200-CELEMTAB
                 AND CTABELA = :TAVT0200-CTABELA
                WITH UR
           END-EXEC.
      *
           MOVE WS-CON-TAVT0200          TO ATCL0001-TABLE-NAME.
      *
           PERFORM 9020-DB2CHECK
              THRU 9029-DB2CHECK-EXIT.
      *
           IF ATCL0001-SEM-ERROS
              IF TAVT0200-OK
                 MOVE TAVT0200-NELEMC01  TO WS-NELEMC01
              ELSE
                 IF TAVT0200-NOTFND
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    DISPLAY MSG-SELECT WS-CON-TAVT0200
                    DISPLAY 'CELEMTAB :' TAVT0200-CELEMTAB
                 ELSE
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    DISPLAY MSG-SELECT WS-CON-TAVT0200
                    DISPLAY 'CELEMTAB :' TAVT0200-CELEMTAB
                 END-IF
              END-IF
           ELSE
              DISPLAY MSG-SELECT WS-CON-TAVT0200
              DISPLAY 'CELEMTAB :' TAVT0200-CELEMTAB
           END-IF.
      *
       6000-OBTEM-DATA-EXIT.
            EXIT.
      ******************************************************************
       5010-AMCI6000.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '5010-AMCI6000' END-IF.
      *
           INITIALIZE AMCL6000-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMCV7300-CPRODUTO   TO AMCL6000-CPRODUTO.
           MOVE AMCV7300-CSUBPROD   TO AMCL6000-CSUBPROD.
           MOVE AMCV7300-CMOEDA     TO AMCL6000-CMOEDA.
           MOVE WS-IDADEACT-SOCIO   TO AMCL6000-IDADEACT.
           MOVE AMCV7300-DCONTD     TO AMCL6000-DCONTD.
           MOVE AMCV7300-CPLSUBS    TO AMCL6000-CPLSUBS.
           MOVE AMCV7300-TXPROG     TO AMCL6000-TXPROG.

           IF AMCV7300-MMOVIM EQUAL ZEROS
              MOVE WS-CON-L          TO AMCL6000-ITPCALC
              MOVE AMCV7300-MCAPITAL TO AMCL6000-MMOVIM
           ELSE
              MOVE WS-CON-C          TO AMCL6000-ITPCALC
              MOVE AMCV7300-MMOVIM   TO AMCL6000-MMOVIM
           END-IF.

           PERFORM AMCI6000-ROTINA
              THRU AMCI6000-EXIT.

           IF NOT AMCL6000-SEM-ERROS
              MOVE AMCL6000-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCL6000-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE AMCL6000-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE AMCL6000-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              MOVE AMCL6000-STATUS         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCL6000-ITPCALC EQUAL WS-CON-L
                 MOVE AMCV7300-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCL6000-MENTREGA    TO AMCV7301-MMOVIM
              ELSE
                 MOVE AMCV7300-MMOVIM      TO AMCV7301-MMOVIM
                 MOVE AMCL6000-MCAPITAL    TO AMCV7301-MCAPITAL
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN
           END-IF.
      *
       5019-AMCI6000-EXIT.
           EXIT.
      ******************************************************************
       6010-AMR07000.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '6010-AMR07000' END-IF.
      *
           INITIALIZE AMCB7000-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMCV7300-CPRODUTO   TO AMCB7000-CPRODUTO.
           MOVE AMCV7300-CSUBPROD   TO AMCB7000-CSUBPROD.
           MOVE AMCV7300-CMOEDA     TO AMCB7000-CMOEDA.
           MOVE WS-IDADEACT-SOCIO   TO AMCB7000-IDADEACT.
           MOVE AMCV7300-DCONTD     TO AMCB7000-DCONTD.
           MOVE AMCV7300-CPLSUBS    TO AMCB7000-CPLSUBS.
           MOVE AMCV7300-TXPROG     TO AMCB7000-TXPROG.
      *
      *CAMPOS NOVOS DO COPY AMCB7000
           MOVE AMCV7300-DNASCIM-SOC1 TO AMCB7000-DNASCIM.
           MOVE AMCV7300-DCONTD       TO AMCB7000-DOPER.

      *
           IF AMCV7300-MMOVIM EQUAL ZEROS
              MOVE 'L'               TO AMCB7000-ITPCALC
              MOVE AMCV7300-MCAPITAL TO AMCB7000-MMOVIM
           ELSE
              MOVE 'C'               TO AMCB7000-ITPCALC
              MOVE AMCV7300-MMOVIM   TO AMCB7000-MMOVIM
           END-IF.
      **
           EXEC CICS
                LINK
                PROGRAM (WS-CON-AMR07000)
                COMMAREA (AMCB7000-AREA)
           END-EXEC
      **
           IF NOT AMCB7000-SEM-ERROS
              MOVE AMCB7000-NR-ERRO            TO ATCL0001-SQLCODE
              MOVE AMCB7000-TABLE-NAME         TO ATCL0001-TABLE-NAME
              MOVE AMCB7000-IND-ERROS          TO ATCL0001-IND-ERROS
              MOVE AMCB7000-COD-ERRO-GRAVE     TO AMCV7301-CTIPSOC-MSG
              MOVE AMCB7000-STATUS             TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCB7000-ITPCALC EQUAL 'L'
                 MOVE AMCV7300-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCB7000-MENTREGA    TO AMCV7301-MMOVIM
              ELSE
                 MOVE AMCV7300-MMOVIM      TO AMCV7301-MMOVIM
                 MOVE AMCB7000-MCAPITAL    TO AMCV7301-MCAPITAL
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN
           END-IF.
      *
       6010-AMR07000-EXIT.
           EXIT.
      ******************************************************************
       5010-AMCI6002.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '5010-AMCI6002' END-IF.

           INITIALIZE AMCL6002-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMCV7300-CPRODUTO   TO AMCL6002-CPRODUTO.
           MOVE AMCV7300-CSUBPROD   TO AMCL6002-CSUBPROD.
           MOVE AMCV7300-CMOEDA     TO AMCL6002-CMOEDA.
           MOVE WS-IDADEACT-SOCIO   TO AMCL6002-IDADEACT.
      * ALT02 (I)
      *    MOVE AMCV7300-IDADRECB   TO AMCL6002-IDADRECB.
           MOVE WS-IDADEACT-DTVENCIM
                                    TO AMCL6002-IDADRECB.
      * ALT02 (F)
           MOVE AMCV7300-DCONTD     TO AMCL6002-DCONTD.
           MOVE AMCV7300-CPLSUBS    TO AMCL6002-CPLSUBS.
           MOVE AMCV7300-TXPROG     TO AMCL6002-TXPROG.
           MOVE WS-ICNTSEG-MAE      TO AMCL6002-ICNTSEG.

           IF AMCV7300-MMOVIM EQUAL ZEROS
              MOVE WS-CON-L          TO AMCL6002-ITPCALC
              MOVE AMCV7300-MCAPITAL TO AMCL6002-MMOVIM
           ELSE
              MOVE WS-CON-C          TO AMCL6002-ITPCALC
              MOVE AMCV7300-MMOVIM   TO AMCL6002-MMOVIM
              ADD AMCV7300-MMOVIM-CS TO AMCL6002-MMOVIM
           END-IF.

           PERFORM AMCI6002-ROTINA
              THRU AMCI6002-EXIT.

           IF NOT AMCL6002-SEM-ERROS
              MOVE AMCL6002-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCL6002-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE AMCL6002-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE AMCL6002-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              MOVE AMCL6002-STATUS         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCL6002-ITPCALC EQUAL WS-CON-L
                 MOVE AMCV7300-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCL6002-MENTREGA    TO AMCV7301-MMOVIM
                 MOVE AMCL6002-MENTREGA-CS TO AMCV7301-MMOVIM-CS
              ELSE
                 MOVE AMCL6002-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCL6002-MENTREGA    TO AMCV7301-MMOVIM
                 MOVE AMCL6002-MENTREGA-CS TO AMCV7301-MMOVIM-CS
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN
                                           AMCV7301-MQUOTAIN-CS
           END-IF.
      *
       5019-AMCI6002-EXIT.
           EXIT.
      ******************************************************************
       6010-AMR07002.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '6010-AMR07002' END-IF.
      *
           INITIALIZE AMCB7002-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMCV7300-CPRODUTO   TO AMCB7002-CPRODUTO.
           MOVE AMCV7300-CSUBPROD   TO AMCB7002-CSUBPROD.
           MOVE AMCV7300-CMOEDA     TO AMCB7002-CMOEDA.
           MOVE WS-IDADEACT-SOCIO   TO AMCB7002-IDADEACT.
      * ALT02 (I)
      *    MOVE AMCV7300-IDADRECB   TO AMCB7002-IDADRECB.
           MOVE WS-IDADEACT-DTVENCIM
                                    TO AMCB7002-IDADRECB.
      * ALT02 (I)
           MOVE AMCV7300-DCONTD     TO AMCB7002-DCONTD.
           MOVE AMCV7300-CPLSUBS    TO AMCB7002-CPLSUBS.
           MOVE AMCV7300-TXPROG     TO AMCB7002-TXPROG.
           MOVE WS-ICNTSEG-MAE      TO AMCB7002-ICNTSEG.
      *CAMPOS NOVOS DO COPY AMCB7002
           MOVE AMCV7300-DNASCIM-SOC1 TO AMCB7002-DNASCIM.
           MOVE AMCV7300-DCONTD       TO AMCB7002-DOPER.

           IF AMCV7300-MMOVIM EQUAL ZEROS
              MOVE WS-CON-L          TO AMCB7002-ITPCALC
              MOVE AMCV7300-MCAPITAL TO AMCB7002-MMOVIM
           ELSE
              MOVE WS-CON-C          TO AMCB7002-ITPCALC
              MOVE AMCV7300-MMOVIM   TO AMCB7002-MMOVIM
              ADD AMCV7300-MMOVIM-CS TO AMCB7002-MMOVIM
           END-IF.
      **
           EXEC CICS
                LINK
                PROGRAM (WS-CON-AMR07002)
                COMMAREA (AMCB7002-AREA)
           END-EXEC
      **
           IF NOT AMCB7002-SEM-ERROS
              MOVE AMCB7002-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCB7002-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE AMCB7002-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE AMCB7002-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              MOVE AMCB7002-STATUS         TO AMCV7301-CTIPSOC-S
           END-IF

           IF ATCL0001-SEM-ERROS
              IF AMCB7002-ITPCALC EQUAL WS-CON-L
                 MOVE AMCV7300-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCB7002-MENTREGA    TO AMCV7301-MMOVIM
                 MOVE AMCB7002-MENTREGA-CS TO AMCV7301-MMOVIM-CS
              ELSE
                 MOVE AMCB7002-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCB7002-MENTREGA    TO AMCV7301-MMOVIM
                 MOVE AMCB7002-MENTREGA-CS TO AMCV7301-MMOVIM-CS
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN
                                           AMCV7301-MQUOTAIN-CS
           END-IF.
      *
       6010-AMR07002-EXIT.
           EXIT.
      ******************************************************************
       5010-AMCI6006.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '5010-AMCI6006' END-IF.
      *
           INITIALIZE AMCL6006-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMCV7300-CPRODUTO   TO AMCL6006-CPRODUTO.
           MOVE AMCV7300-CSUBPROD   TO AMCL6006-CSUBPROD.
           MOVE AMCV7300-CMOEDA     TO AMCL6006-CMOEDA.
           MOVE WS-IDADEACT-SOCIO   TO AMCL6006-IDADEACT.
           MOVE AMCV7300-DCONTD     TO AMCL6006-DCONTD.
           MOVE AMCV7300-CPLSUBS    TO AMCL6006-CPLSUBS.
           MOVE AMCV7300-TXPROG     TO AMCL6006-TXPROG.
           MOVE AMCV7300-QPRAZO     TO AMCL6006-QPRAZO.

           IF AMCV7300-MMOVIM EQUAL ZEROS
              MOVE WS-CON-L          TO AMCL6006-ITPCALC
              MOVE AMCV7300-MCAPITAL TO AMCL6006-MMOVIM
           ELSE
              MOVE WS-CON-C          TO AMCL6006-ITPCALC
              MOVE AMCV7300-MMOVIM   TO AMCL6006-MMOVIM
           END-IF.

           PERFORM AMCI6006-ROTINA
              THRU AMCI6006-EXIT.

           IF NOT AMCL6006-SEM-ERROS
              MOVE AMCL6006-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCL6006-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE AMCL6006-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE AMCL6006-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              MOVE AMCL6006-STATUS         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCL6006-ITPCALC EQUAL WS-CON-L
                 MOVE AMCV7300-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCL6006-MENTREGA    TO AMCV7301-MMOVIM
              ELSE
                 MOVE AMCV7300-MMOVIM      TO AMCV7301-MMOVIM
                 MOVE AMCL6006-MCAPITAL    TO AMCV7301-MCAPITAL
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN
           END-IF.
      *
       5019-AMCI6006-EXIT.
           EXIT.
      ******************************************************************
       6010-AMR07006.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '6010-AMR07006' END-IF.
      *
           INITIALIZE AMCB7006-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMCV7300-CPRODUTO   TO AMCB7006-CPRODUTO.
           MOVE AMCV7300-CSUBPROD   TO AMCB7006-CSUBPROD.
           MOVE AMCV7300-CMOEDA     TO AMCB7006-CMOEDA.
           MOVE WS-IDADEACT-SOCIO   TO AMCB7006-IDADEACT.
           MOVE AMCV7300-DCONTD     TO AMCB7006-DCONTD.
           MOVE AMCV7300-CPLSUBS    TO AMCB7006-CPLSUBS.
           MOVE AMCV7300-TXPROG     TO AMCB7006-TXPROG.
           MOVE AMCV7300-QPRAZO     TO AMCB7006-QPRAZO.
      *CAMPOS NOVOS DO COPY AMCB7006
           MOVE AMCV7300-DNASCIM-SOC1 TO AMCB7006-DNASCIM.
           MOVE AMCV7300-DCONTD       TO AMCB7006-DOPER.

           IF AMCV7300-MMOVIM EQUAL ZEROS
              MOVE WS-CON-L          TO AMCB7006-ITPCALC
              MOVE AMCV7300-MCAPITAL TO AMCB7006-MMOVIM
           ELSE
              MOVE WS-CON-C          TO AMCB7006-ITPCALC
              MOVE AMCV7300-MMOVIM   TO AMCB7006-MMOVIM
           END-IF.
      **
           EXEC CICS
                LINK
                PROGRAM (WS-CON-AMR07006)
                COMMAREA (AMCB7006-AREA)
           END-EXEC
      **
           IF NOT AMCB7006-SEM-ERROS
              MOVE AMCB7006-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCB7006-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE AMCB7006-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE AMCB7006-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              MOVE AMCB7006-STATUS         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCB7006-ITPCALC EQUAL WS-CON-L
                 MOVE AMCV7300-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCB7006-MENTREGA    TO AMCV7301-MMOVIM
              ELSE
                 MOVE AMCV7300-MMOVIM      TO AMCV7301-MMOVIM
                 MOVE AMCB7006-MCAPITAL    TO AMCV7301-MCAPITAL
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN
           END-IF.
      *
       6010-AMR07006-EXIT.
           EXIT.
      ******************************************************************
       5010-AMCI6008.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '5010-AMCI6008' END-IF.
      *
           INITIALIZE AMCL6008-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMCV7300-CPRODUTO   TO AMCL6008-CPRODUTO.
           MOVE AMCV7300-CSUBPROD   TO AMCL6008-CSUBPROD.
           MOVE AMCV7300-CMOEDA     TO AMCL6008-CMOEDA.
      ***************
      * A IDADE DO ASSOCIADO NÃO É NECESSÁRIA PARA O CALCULO DO VALOR DA
      * LIBERAÇÃO COMO PODE HAVER ASSOCIADOS COM + DE 80 ANOS E A ROTINA
      * DAS RESPONSABILIDADES VAI UTILIZAR ESTA IDADE É NECESSáRIO QUE
      * SEJA PASSADA UMA IDADE VALIDA, NESTE CASO OPTEI POR PASSAR A
      * 80 ANOS QUE É A MÁXIMA ADMISSIVEL,MAS SÓ NO CASO DA IDADE SER
      * SUPERIOR A 80
      ***************
           MOVE WS-IDADEACT-SOCIO   TO AMCL6008-IDADEACT.
           IF AMCL6008-IDADEACT > 80
              MOVE 80               TO AMCL6008-IDADEACT
           END-IF.
           MOVE WS-IDADEACT-BEN     TO AMCL6008-IDADAIBP.
      * ALT02 (I)
      *    MOVE AMCV7300-IDADRECB   TO AMCL6008-IDADRECB.
           MOVE WS-IDADEACT-DTVENCIM
                                    TO AMCL6008-IDADRECB.
      * ALT02 (I)
           MOVE AMCV7300-DCONTD     TO AMCL6008-DCONTD.
           MOVE AMCV7300-CPLSUBS    TO AMCL6008-CPLSUBS.
           MOVE AMCV7300-TXPROG     TO AMCL6008-TXPROG.

           IF AMCV7300-MMOVIM EQUAL ZEROS
              MOVE WS-CON-L          TO AMCL6008-ITPCALC
              MOVE AMCV7300-MCAPITAL TO AMCL6008-MMOVIM
           ELSE
              MOVE WS-CON-C          TO AMCL6008-ITPCALC
              MOVE AMCV7300-MMOVIM   TO AMCL6008-MMOVIM
           END-IF.

           PERFORM AMCI6008-ROTINA
              THRU AMCI6008-EXIT.

           IF NOT AMCL6008-SEM-ERROS
              MOVE AMCL6008-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCL6008-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE AMCL6008-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE AMCL6008-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              MOVE AMCL6008-STATUS         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCL6008-ITPCALC EQUAL WS-CON-L
                 MOVE AMCV7300-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCL6008-MENTREGA    TO AMCV7301-MMOVIM
              ELSE
                 MOVE AMCV7300-MMOVIM      TO AMCV7301-MMOVIM
                 MOVE AMCL6008-MCAPITAL    TO AMCV7301-MCAPITAL
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN
           END-IF.
      *
       5019-AMCI6008-EXIT.
           EXIT.
      ******************************************************************
       6010-AMR07008.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '6010-AMR07008' END-IF.
      *
           INITIALIZE AMCB7008-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE AMCV7300-CPRODUTO   TO AMCB7008-CPRODUTO.
           MOVE AMCV7300-CSUBPROD   TO AMCB7008-CSUBPROD.
           MOVE AMCV7300-CMOEDA     TO AMCB7008-CMOEDA.
           MOVE WS-IDADEACT-SOCIO   TO AMCB7008-IDADEACT.
           MOVE WS-IDADEACT-BEN     TO AMCB7008-IDADAIBP.
      * ALT02 (I)
      *    MOVE AMCV7300-IDADRECB   TO AMCB7008-IDADRECB.
           MOVE WS-IDADEACT-DTVENCIM
                                    TO AMCB7008-IDADRECB.
      * ALT02 (F)
           MOVE AMCV7300-DCONTD     TO AMCB7008-DCONTD.
           MOVE AMCV7300-CPLSUBS    TO AMCB7008-CPLSUBS.
           MOVE AMCV7300-TXPROG     TO AMCB7008-TXPROG.
      *CAMPOS NOVOS DO COPY AMCB7008
           MOVE AMCV7300-DNASCIM-SOC1 TO AMCB7008-DNASCIM.
           MOVE AMCV7301-DNASCIM-BEN  TO AMCB7008-DNASCIMB.
           MOVE AMCV7300-DCONTD       TO AMCB7008-DOPER.

           IF AMCV7300-MMOVIM EQUAL ZEROS
              MOVE WS-CON-L          TO AMCB7008-ITPCALC
              MOVE AMCV7300-MCAPITAL TO AMCB7008-MMOVIM
           ELSE
              MOVE WS-CON-C          TO AMCB7008-ITPCALC
              MOVE AMCV7300-MMOVIM   TO AMCB7008-MMOVIM
           END-IF.
      **
           EXEC CICS
                LINK
                PROGRAM (WS-CON-AMR07008)
                COMMAREA (AMCB7008-AREA)
           END-EXEC
      **
           IF NOT AMCB7008-SEM-ERROS
              MOVE AMCB7008-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCB7008-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE AMCB7008-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE AMCB7008-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              MOVE AMCB7008-STATUS         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCB7008-ITPCALC EQUAL WS-CON-L
                 MOVE AMCV7300-MCAPITAL    TO AMCV7301-MCAPITAL
                 MOVE AMCB7008-MENTREGA    TO AMCV7301-MMOVIM
              ELSE
                 MOVE AMCV7300-MMOVIM      TO AMCV7301-MMOVIM
                 MOVE AMCB7008-MCAPITAL    TO AMCV7301-MCAPITAL
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN
           END-IF.
      *
       6010-AMR07008-EXIT.
           EXIT.
      ******************************************************************
       5010-AMCI6010.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '5010-AMCI6010' END-IF.
      *
           INITIALIZE AMCL6010-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE WS-CON-74            TO AMCL6010-CPRODUTO.
      *    MOVE WS-CON-89            TO AMCL6010-CSUBPROD.
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9       TO AMCL6010-CSUBPROD
           ELSE
              MOVE WS-CON-89       TO AMCL6010-CSUBPROD
           END-IF
           MOVE AMCV7300-CMOEDA      TO AMCL6010-CMOEDA.
           MOVE WS-IDADEACT-SOCIO    TO AMCL6010-IDADEACT.
           MOVE AMCV7300-DCONTD      TO AMCL6010-DCONTD.
           MOVE AMCV7300-CPLSUBS     TO AMCL6010-CPLSUBS.
           MOVE AMCV7300-TXPROG      TO AMCL6010-TXPROG.
           MOVE WS-QPRAZO-CTI        TO AMCL6010-QPRAZO.
      *** NOTA:
      *** INDSBPRO-CTI  NAO ESTAVA A SER PASSADO NO MODO ANTIGO

           IF AMCV7301-INDSBPRO-CTI EQUAL SPACES
              MOVE ZEROS                 TO AMCL6010-CCOBADIC
           ELSE
              MOVE AMCV7301-INDSBPRO-CTI TO AMCL6010-CCOBADIC
           END-IF.

           IF SW-DEBUG-SIM
              DISPLAY 'AMCV7301-INDSBPRO-CTI ' AMCV7301-INDSBPRO-CTI
           END-IF
      ***
           IF AMCV7300-MMOVIM-CTI EQUAL ZEROS
              MOVE WS-CON-L              TO AMCL6010-ITPCALC
              MOVE AMCV7300-MCAPITAL-CTI TO AMCL6010-MMOVIM
           ELSE
              MOVE WS-CON-C              TO AMCL6010-ITPCALC
              MOVE AMCV7300-MMOVIM-CTI   TO AMCL6010-MMOVIM
           END-IF.

           PERFORM AMCI6010-ROTINA
              THRU AMCI6010-EXIT.

           IF NOT AMCL6010-SEM-ERROS
              MOVE AMCL6010-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCL6010-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE AMCL6010-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE AMCL6010-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              MOVE AMCL6010-STATUS         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCL6010-ITPCALC EQUAL WS-CON-L
                 MOVE AMCV7300-MCAPITAL-CTI TO AMCV7301-MCAPITAL-CTI
                 MOVE AMCL6010-MENTREGA     TO AMCV7301-MMOVIM-CTI
              ELSE
                 MOVE AMCV7300-MMOVIM-CTI  TO AMCV7301-MMOVIM-CTI
                 MOVE AMCL6010-MCAPITAL    TO AMCV7301-MCAPITAL-CTI
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN-CTI
           END-IF.
      *
       5019-AMCI6010-EXIT.
           EXIT.
      ******************************************************************
       6010-AMR07010.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '6010-AMR07010' END-IF.
      *
           INITIALIZE AMCB7010-AREA
               REPLACING ALPHANUMERIC DATA BY SPACES
                         NUMERIC DATA BY ZEROS.

           MOVE WS-CON-74             TO AMCB7010-CPRODUTO.
      *    MOVE WS-CON-89             TO AMCB7010-CSUBPROD.
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9       TO AMCB7010-CSUBPROD
           ELSE
              MOVE WS-CON-89       TO AMCB7010-CSUBPROD
           END-IF
           MOVE AMCV7300-CMOEDA       TO AMCB7010-CMOEDA.
           MOVE WS-IDADEACT-SOCIO     TO AMCB7010-IDADEACT.
           MOVE AMCV7300-DCONTD       TO AMCB7010-DCONTD.
           MOVE AMCV7300-CPLSUBS      TO AMCB7010-CPLSUBS.
           MOVE AMCV7300-TXPROG       TO AMCB7010-TXPROG.
           MOVE WS-QPRAZO-CTI         TO AMCB7010-QPRAZO.

      *
           IF AMCV7301-INDSBPRO-CTI EQUAL SPACES
              MOVE ZEROS                 TO AMCB7010-CCOBADIC
           ELSE
              MOVE AMCV7301-INDSBPRO-CTI TO AMCB7010-CCOBADIC
           END-IF.
           IF SW-DEBUG-SIM
              DISPLAY 'AMCV7301-INDSBPRO-CTI ' AMCV7301-INDSBPRO-CTI
           END-IF

      *CAMPOS NOVOS DO COPY AMCB7010
           MOVE AMCV7300-DNASCIM-SOC1 TO AMCB7010-DNASCIM.
           MOVE AMCV7300-DCONTD       TO AMCB7010-DOPER.

           IF AMCV7300-MMOVIM-CTI EQUAL ZEROS
              MOVE WS-CON-L              TO AMCB7010-ITPCALC
              MOVE AMCV7300-MCAPITAL-CTI TO AMCB7010-MMOVIM
           ELSE
              MOVE WS-CON-C              TO AMCB7010-ITPCALC
              MOVE AMCV7300-MMOVIM-CTI   TO AMCB7010-MMOVIM
           END-IF.
      **
           EXEC CICS
                LINK
                PROGRAM (WS-CON-AMR07010)
                COMMAREA (AMCB7010-AREA)
           END-EXEC
      **

           IF NOT AMCB7010-SEM-ERROS
              MOVE AMCB7010-NR-ERRO        TO ATCL0001-SQLCODE
              MOVE AMCB7010-TABLE-NAME     TO ATCL0001-TABLE-NAME
              MOVE AMCB7010-IND-ERROS      TO ATCL0001-IND-ERROS
              MOVE AMCB7010-COD-ERRO-GRAVE TO AMCV7301-CTIPSOC-MSG
              MOVE AMCB7010-STATUS         TO AMCV7301-CTIPSOC-S
           END-IF.

           IF ATCL0001-SEM-ERROS
              IF AMCB7010-ITPCALC EQUAL WS-CON-L
                 MOVE AMCV7300-MCAPITAL-CTI TO AMCV7301-MCAPITAL-CTI
                 MOVE AMCB7010-MENTREGA     TO AMCV7301-MMOVIM-CTI
              ELSE
                 MOVE AMCV7300-MMOVIM-CTI  TO AMCV7301-MMOVIM-CTI
                 MOVE AMCB7010-MCAPITAL    TO AMCV7301-MCAPITAL-CTI
              END-IF
              MOVE ZEROS                TO AMCV7301-MQUOTAIN-CTI
           END-IF.
      *
       6010-AMR07010-EXIT.
           EXIT.
      ******************************************************************
       6200-OBTEM-ULTDIA-MESANT.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '6200-OBTEM-ULTDIA-MESANT' END-IF.

           INITIALIZE SYCL0200-AREA-COMUNICACAO REPLACING
                    ALPHANUMERIC DATA BY SPACES
                    NUMERIC DATA BY ZEROS.

           MOVE WS-CON-23              TO SYCL0200-COD-PROCESSO.
           MOVE WS-CON-999             TO SYCL0200-COD-BALCAO.
           MOVE WS-DATA-AAAAMMDD-ANO   TO SYCL0200-I1-A.
           MOVE WS-DATA-AAAAMMDD-MES   TO SYCL0200-I1-M.
           MOVE WS-CON-N1              TO SYCL0200-I1-D.
           MOVE WS-CON-N1              TO SYCL0200-PRZ-D.

           PERFORM SYCP0200-ROTINA-DATAS
              THRU SYCP0200-EXIT.

           MOVE SYCL0200-IND-ERROS      TO ATCL0001-IND-ERROS.

           IF NOT ATCL0001-SEM-ERROS
              MOVE WS-CON-1                TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-221        TO AMCV7301-CTIPSOC-MSG
              MOVE ATCK0002-ERROS-FUNCAO   TO ATCL0001-IND-ERROS
           END-IF.
      *
       6299-OBTEM-ULTDIA-MESANT-EXIT.
           EXIT.
      ******************************************************************
       6300-OBTEM-IDADRECB.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '6300-OBTEM-IDADRECB' END-IF.

           INITIALIZE SYCL0200-AREA-COMUNICACAO REPLACING
                    ALPHANUMERIC DATA BY SPACES
                    NUMERIC DATA BY ZEROS.

           MOVE WS-CON-21              TO SYCL0200-COD-PROCESSO.
           MOVE WS-CON-999             TO SYCL0200-COD-BALCAO.
           MOVE WS-DATA-AAAAMMDD       TO SYCL0200-DAT-INPUT1.
           MOVE WS-COD-PRAZO           TO SYCL0200-COD-PRZ.

           PERFORM SYCP0200-ROTINA-DATAS
              THRU SYCP0200-EXIT.

           MOVE SYCL0200-IND-ERROS      TO ATCL0001-IND-ERROS.

           IF NOT ATCL0001-SEM-ERROS
              MOVE WS-CON-1                TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-221        TO AMCV7301-CTIPSOC-MSG
              MOVE ATCK0002-ERROS-FUNCAO   TO ATCL0001-IND-ERROS
           END-IF.
      *
       6399-OBTEM-IDADRECB-EXIT.
           EXIT.
      ******************************************************************
       6400-OBTEM-IDADRECB.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '6400-OBTEM-IDADRECB' END-IF.

           INITIALIZE SYCL0200-AREA-COMUNICACAO REPLACING
                    ALPHANUMERIC DATA BY SPACES
                    NUMERIC DATA BY ZEROS.

           MOVE WS-CON-23              TO SYCL0200-COD-PROCESSO.
           MOVE WS-CON-999             TO SYCL0200-COD-BALCAO.
           MOVE WS-DATA-AAAAMMDD       TO SYCL0200-DAT-INPUT1.
           MOVE WS-CON-N6              TO SYCL0200-PRZ-M.

           PERFORM SYCP0200-ROTINA-DATAS
              THRU SYCP0200-EXIT.

           MOVE SYCL0200-IND-ERROS      TO ATCL0001-IND-ERROS.

           IF NOT ATCL0001-SEM-ERROS
              MOVE WS-CON-1                TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-221        TO AMCV7301-CTIPSOC-MSG
              MOVE ATCK0002-ERROS-FUNCAO   TO ATCL0001-IND-ERROS
           END-IF.
      *
       6499-OBTEM-IDADRECB-EXIT.
           EXIT.
      ******************************************************************
       7000-SOMA-CAPITAIS-INSP.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '7000-SOMA-CAPITAIS-INSP' END-IF.

           MOVE AMCV7300-CTIPSOC  TO AMVT0102-CTIPSOC.
           MOVE AMCV7300-ZSOCIO   TO AMVT0102-ZSOCIO.
           MOVE AMCV7300-CDIGISOC TO AMVT0102-CDIGISOC.
           MOVE AMCV7300-ZINSCRIC TO AMVT0102-ZINSCRIC.

           EXEC SQL
               OPEN CRS-AMT01-INSP
           END-EXEC.

           MOVE WS-CON-AMVT0102   TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF NOT AMVT0102-OK
              MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-771 TO AMCV7301-CTIPSOC-MSG
           END-IF.

           IF ATCL0001-SEM-ERROS
              PERFORM 7100-FETCH-AMT01-INSP
                 THRU 7199-FETCH-AMT01-INSP-EXIT
                UNTIL NOT ATCL0001-SEM-ERROS
                   OR AMVT0102-NOTFND
           END-IF.

           IF ATCL0001-ERROS-VALIDOS
              EXEC SQL
                  CLOSE CRS-AMT01-INSP
              END-EXEC

              MOVE WS-CON-AMVT0102  TO ATCL0001-TABLE-NAME
              PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

              IF NOT AMVT0102-OK
                 MOVE WS-CON-1         TO AMCV7301-CTIPSOC-S
                 MOVE AMCK0001-CON-773 TO AMCV7301-CTIPSOC-MSG
              END-IF
           END-IF.
      *
       7299-SOMA-CAPITAIS-INSP-EXIT.
           EXIT.
      ******************************************************************
       7100-FETCH-AMT01-INSP.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '7100-FETCH-AMT01-INSP' END-IF.

           MOVE SPACES            TO WS-CPRODUTO-MAE.
           MOVE SPACES            TO WS-CBALCAO-MAE .
           MOVE SPACES            TO WS-CNUMECTA-MAE.
           MOVE SPACES            TO WS-CDIGICTA-MAE.
           MOVE SPACES            TO WS-CSUBPROD-MAE.
           MOVE ZEROS             TO WS-MCAPACTU-MAE.
           MOVE SPACES            TO WS-CPRODUTO-CTI.
           MOVE SPACES            TO WS-CSUBPROD-CTI.
           MOVE ZEROS             TO WS-ZINSCRIC-CTI.
           MOVE ZEROS             TO WS-MCAPACTU-CTI.

           EXEC SQL
               FETCH CRS-AMT01-INSP
                INTO :AMVT0102-CPRODUTO,
                     :AMVT0102-CBALCAO ,
                     :AMVT0102-CNUMECTA,
                     :AMVT0102-CDIGICTA,
                     :AMVT0102-CSUBPROD,
                     :AMVT0102-ZINSCRIC,
                     :AMVT0102-ZORDPROC,
                     :AMVT0102-MCAPACTU
           END-EXEC.

           MOVE WS-CON-AMVT0102   TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF AMVT0102-OK
                 PERFORM 7200-SOMA-CAPITAL-INSP
                    THRU 7299-SOMA-CAPITAL-INSP-EXIT
              ELSE
                 IF NOT AMVT0102-NOTFND
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                    MOVE AMCK0001-CON-772   TO AMCV7301-CTIPSOC-MSG
                 END-IF
              END-IF
           ELSE
              MOVE WS-CON-1                   TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-772           TO AMCV7301-CTIPSOC-MSG
           END-IF.
      *
       7199-FETCH-AMT01-INSP-EXIT.
           EXIT.
      ******************************************************************
       7200-SOMA-CAPITAL-INSP.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '7200-SOMA-CAPITAL-INSP' END-IF.

           IF AMVT0102-CPRODUTO EQUAL WS-CON-74
              MOVE AMVT0102-CPRODUTO TO WS-CPRODUTO-CTI
              MOVE AMVT0102-CSUBPROD TO WS-CSUBPROD-CTI
              MOVE AMVT0102-ZINSCRIC TO WS-ZINSCRIC-CTI
              MOVE AMVT0102-MCAPACTU TO WS-MCAPACTU-CTI
              PERFORM 7210-TRATA-CAPITAL-MAE
                 THRU 7219-TRATA-CAPITAL-MAE-EXIT
           ELSE
              IF AMVT0102-CSUBPROD EQUAL WS-CON-60 OR
                (AMVT0102-CSUBPROD EQUAL WS-CON-70 AND
                 AMVT0115-DCONTD < '2007-07-01')
                 ADD  AMVT0102-MCAPACTU TO WS-MCAPITAL-INSP
              ELSE
                 IF AMVT0102-CSUBPROD EQUAL WS-CON-80 OR
                (AMVT0102-CSUBPROD EQUAL WS-CON-70 AND
                 AMVT0115-DCONTD >= '2007-07-01')
                    MOVE AMVT0102-CPRODUTO TO WS-CPRODUTO-MAE
                    MOVE AMVT0102-CBALCAO  TO WS-CBALCAO-MAE
                    MOVE AMVT0102-CNUMECTA TO WS-CNUMECTA-MAE
                    MOVE AMVT0102-CDIGICTA TO WS-CDIGICTA-MAE
                    MOVE AMVT0102-CSUBPROD TO WS-CSUBPROD-MAE
                    MOVE AMVT0102-MCAPACTU TO WS-MCAPACTU-MAE
                    PERFORM 7220-TRATA-CAPITAL-GPE
                       THRU 7229-TRATA-CAPITAL-GPE-EXIT
                 END-IF
              END-IF
           END-IF.
      *
       7299-SOMA-CAPITAL-INSP-EXIT.
           EXIT.
      ******************************************************************
       7210-TRATA-CAPITAL-MAE.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '7210-TRATA-CAPITAL-MAE' END-IF.

           EXEC SQL
               FETCH CRS-AMT01-INSP
                INTO :AMVT0102-CPRODUTO,
                     :AMVT0102-CBALCAO ,
                     :AMVT0102-CNUMECTA,
                     :AMVT0102-CDIGICTA,
                     :AMVT0102-CSUBPROD,
                     :AMVT0102-ZINSCRIC,
                     :AMVT0102-ZORDPROC,
                     :AMVT0102-MCAPACTU
           END-EXEC.

           MOVE WS-CON-AMVT0102   TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF AMVT0102-OK
                 IF AMVT0102-CPRODUTO NOT EQUAL WS-CON-74
                    MOVE AMVT0102-CPRODUTO TO WS-CPRODUTO-MAE
                    MOVE AMVT0102-CSUBPROD TO WS-CSUBPROD-MAE
                    MOVE AMVT0102-ZINSCRIC TO WS-ZINSCRIC-MAE
                    MOVE AMVT0102-MCAPACTU TO WS-MCAPACTU-MAE

                    IF WS-ZINSCRIC-MAE EQUAL WS-ZINSCRIC-CTI
                       ADD  WS-MCAPACTU-MAE TO WS-MCAPITAL-INSP
                       ADD  WS-MCAPACTU-CTI TO WS-MCAPITAL-INSP
                    END-IF
                 END-IF
              ELSE
                 IF NOT AMVT0102-NOTFND
                    MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                    MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
                    MOVE AMCK0001-CON-772   TO AMCV7301-CTIPSOC-MSG
                 END-IF
              END-IF
           ELSE
              MOVE WS-CON-1                   TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-772           TO AMCV7301-CTIPSOC-MSG
           END-IF.
      *
       7219-TRATA-CAPITAL-MAE-EXIT.
           EXIT.
      ******************************************************************
       7220-TRATA-CAPITAL-GPE.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '7220-TRATA-CAPITAL-GPE' END-IF.
      *
           MOVE WS-CPRODUTO-MAE   TO AMVT0800-CPRODUTO.
           MOVE WS-CBALCAO-MAE    TO AMVT0800-CBALCAO .
           MOVE WS-CNUMECTA-MAE   TO AMVT0800-CNUMECTA.
           MOVE WS-CDIGICTA-MAE   TO AMVT0800-CDIGICTA.
      *
           EXEC SQL
                SELECT  CRISCO
                  INTO :AMVT0800-CRISCO
                  FROM  AMVT0800_SUBSCGPE
                 WHERE  CPRODUTO = :AMVT0800-CPRODUTO
                   AND  CBALCAO  = :AMVT0800-CBALCAO
                   AND  CNUMECTA = :AMVT0800-CNUMECTA
                   AND  CDIGICTA = :AMVT0800-CDIGICTA
           END-EXEC.
      *
           MOVE WS-CON-AMVT0800      TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT .
      *
           IF ATCL0001-SEM-ERROS
              IF AMVT0800-OK
                 IF AMVT0800-CRISCO EQUAL WS-CON-A
                    ADD  WS-MCAPACTU-MAE TO WS-MCAPITAL-INSP
                 END-IF
              ELSE
                 MOVE ATCK0002-ABEND-DB2 TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-504   TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-504   TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1           TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       7229-TRATA-CAPITAL-GPE-EXIT.
           EXIT.
      ******************************************************************
       9010-ERRO-CICS.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '9010-ERRO-CICS' END-IF.

           MOVE ATCK0001-LINK-PGMJOURNAL TO ATCL0001-COD-ERRO-GRAVE.
           EXEC SQL INCLUDE ATCP0001 END-EXEC.
      *
       9019-ERRO-CICS-EXIT.
           EXIT.
      ******************************************************************
       9000-VALIDA-QA.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '9000-VALIDA-QA' END-IF.

           EXEC SQL
                SELECT  CESTADO
                  INTO :WS-AMT01-CESTADO
                  FROM  AMVT0115_BASIOPER
                 WHERE  CTIPSOC  = :AMVT1004-CTIPSOC
                   AND  ZSOCIO   = :AMVT1004-ZSOCIO
                   AND  CDIGISOC = :AMVT1004-CDIGISOC
                   AND  CPRODUTO = '70'
                   AND  CSUBPROD = '50'
           END-EXEC.

           MOVE WS-CON-AMVT0115 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF AMVT0115-OK
               IF WS-AMT01-CESTADO NOT LESS WS-CON-03
                   MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-303      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
               END-IF
           ELSE
               IF AMVT0115-NOTFND
                   MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-302      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
               ELSE
                   MOVE ATCK0002-ABEND-DB2    TO ATCL0001-IND-ERROS
                   MOVE AMCK0001-CON-520      TO AMCV7301-CTIPSOC-MSG
                   MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
               END-IF
           END-IF.
      *
       9099-VALIDA-QA-EXIT.
           EXIT.
      ******************************************************************
       9100-OBTEM-ULTDIA-MES.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '9100-OBTEM-ULTDIA-MES' END-IF.

           INITIALIZE SYCL0200-AREA-COMUNICACAO REPLACING
                    ALPHANUMERIC DATA BY SPACES
                    NUMERIC DATA BY ZEROS.

           MOVE WS-CON-09              TO SYCL0200-COD-PROCESSO.
           MOVE WS-CON-999             TO SYCL0200-COD-BALCAO.
           MOVE WS-DATA-AAAAMMDD-ANO   TO SYCL0200-I1-A.
           MOVE WS-DATA-AAAAMMDD-MES   TO SYCL0200-I1-M.
           MOVE WS-CON-N1              TO SYCL0200-I1-D.

           PERFORM SYCP0200-ROTINA-DATAS
              THRU SYCP0200-EXIT.

           MOVE SYCL0200-IND-ERROS      TO ATCL0001-IND-ERROS.

           IF NOT ATCL0001-SEM-ERROS
              MOVE WS-CON-1                TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-221        TO AMCV7301-CTIPSOC-MSG
              MOVE ATCK0002-ERROS-FUNCAO   TO ATCL0001-IND-ERROS
           END-IF.
      *
       9199-OBTEM-ULTDIA-MES-EXIT.
           EXIT.
      ******************************************************************
       9200-OBTEM-ULTDIA-MESANT.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '9200-OBTEM-ULTDIA-MESANT' END-IF.
           INITIALIZE SYCL0200-AREA-COMUNICACAO REPLACING
                    ALPHANUMERIC DATA BY SPACES
                    NUMERIC DATA BY ZEROS.

           MOVE WS-CON-23              TO SYCL0200-COD-PROCESSO.
           MOVE WS-CON-999             TO SYCL0200-COD-BALCAO.
           MOVE WS-DATA-AAAAMMDD-ANO   TO SYCL0200-I1-A.
           MOVE WS-DATA-AAAAMMDD-MES   TO SYCL0200-I1-M.
           MOVE WS-CON-N1              TO SYCL0200-I1-D.
           MOVE WS-CON-N1              TO SYCL0200-PRZ-D.

           PERFORM SYCP0200-ROTINA-DATAS
              THRU SYCP0200-EXIT.

           MOVE SYCL0200-IND-ERROS      TO ATCL0001-IND-ERROS.

           IF NOT ATCL0001-SEM-ERROS
              MOVE WS-CON-1                TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-221        TO AMCV7301-CTIPSOC-MSG
              MOVE ATCK0002-ERROS-FUNCAO   TO ATCL0001-IND-ERROS
           END-IF.
      *
       9299-OBTEM-ULTDIA-MESANT-EXIT.
           EXIT.
      ******************************************************************
       9300-OBTEM-IDADRECB.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '9300-OBTEM-IDADRECB' END-IF.

           INITIALIZE SYCL0200-AREA-COMUNICACAO REPLACING
                    ALPHANUMERIC DATA BY SPACES
                    NUMERIC DATA BY ZEROS.

           MOVE WS-CON-21              TO SYCL0200-COD-PROCESSO.
           MOVE WS-CON-999             TO SYCL0200-COD-BALCAO.
           MOVE WS-DATA-AAAAMMDD       TO SYCL0200-DAT-INPUT1.
           MOVE WS-COD-PRAZO           TO SYCL0200-COD-PRZ.

           PERFORM SYCP0200-ROTINA-DATAS
              THRU SYCP0200-EXIT.

           MOVE SYCL0200-IND-ERROS      TO ATCL0001-IND-ERROS.

           IF NOT ATCL0001-SEM-ERROS
              MOVE WS-CON-1                TO AMCV7301-CTIPSOC-S
              MOVE AMCK0001-CON-221        TO AMCV7301-CTIPSOC-MSG
              MOVE ATCK0002-ERROS-FUNCAO   TO ATCL0001-IND-ERROS
           END-IF.
      *
       9399-OBTEM-IDADRECB-EXIT.
           EXIT.
      ******************************************************************
       9400-OBTER-MCAPITAL.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '9400-OBTER-MCAPITAL' END-IF.

           MOVE AMCV7300-CTIPSOC        TO WS-AMVT0115-CTIPSOC.
           MOVE AMCV7300-ZSOCIO         TO WS-AMVT0115-ZSOCIO.
           MOVE AMCV7300-CDIGISOC       TO WS-AMVT0115-CDIGISOC.
           MOVE AMCV7300-ZINSCRIC       TO WS-AMVT0115-ZINSCRIC.

           EXEC SQL
                SELECT  MCAPITAL
                  INTO :WS-AMVT0115-MCAPITAL
                  FROM  AMVT0115_BASIOPER
                 WHERE  CTIPSOC  = :WS-AMVT0115-CTIPSOC
                   AND  ZSOCIO   = :WS-AMVT0115-ZSOCIO
                   AND  CDIGISOC = :WS-AMVT0115-CDIGISOC
                   AND  ZINSCRIC = :WS-AMVT0115-ZINSCRIC
                   AND  CPRODUTO = :WS-AMVT0115-CPRODUTO
                   AND  CSUBPROD = :WS-AMVT0115-CSUBPROD
           END-EXEC.

           MOVE WS-CON-AMVT0115        TO ATCL0001-TABLE-NAME
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT

           IF ATCL0001-SEM-ERROS
              IF NOT AMVT0115-OK
                 MOVE ATCK0002-ABEND-DB2  TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-500    TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
              END-IF
           ELSE
              MOVE AMCK0001-CON-500    TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1            TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       9499-OBTER-MCAPITAL-EXIT.
           EXIT.
      ******************************************************************
      * VALIDACAO QUE PREVINE A DESMARCACAO DA CHECKBOX DO CTI         *
      *                                                                *
      ******************************************************************
       9500-SELECT-AMT01.
      ******************************************************************
           IF SW-DEBUG-SIM DISPLAY '9500-SELECT-AMT01' END-IF.
      *
           MOVE AMCV7300-CTIPSOC  TO AMVT0115-CTIPSOC.
           MOVE AMCV7300-ZSOCIO   TO AMVT0115-ZSOCIO .
           MOVE AMCV7300-CDIGISOC TO AMVT0115-CDIGISOC.
           MOVE AMCV7300-ZINSCRIC TO AMVT0115-ZINSCRIC.
           MOVE WS-CON-74         TO AMVT0115-CPRODUTO.
      *    MOVE WS-CON-89         TO AMVT0115-CSUBPROD.
           IF AMCV7301-CSUBPROD(1:1) EQUAL 'A'
              MOVE WS-CON-A9       TO AMVT0115-CSUBPROD
           ELSE
              MOVE WS-CON-89       TO AMVT0115-CSUBPROD
           END-IF
      *
           EXEC SQL
                SELECT  CPRODUTO,
                        CBALCAO ,
                        CNUMECTA,
                        CDIGICTA,
                        CCOBADIC,
                        QPRAZO
                  INTO :AMVT0115-CPRODUTO,
                       :AMVT0115-CBALCAO ,
                       :AMVT0115-CNUMECTA,
                       :AMVT0115-CDIGICTA,
                       :AMVT0115-CCOBADIC,
                       :AMVT0115-QPRAZO
                  FROM  AMVT0115_BASIOPER
                 WHERE  CTIPSOC  = :AMVT0115-CTIPSOC
                   AND  ZSOCIO   = :AMVT0115-ZSOCIO
                   AND  CDIGISOC = :AMVT0115-CDIGISOC
                   AND  ZINSCRIC = :AMVT0115-ZINSCRIC
                   AND  CPRODUTO = :AMVT0115-CPRODUTO
                   AND  CSUBPROD = :AMVT0115-CSUBPROD
           END-EXEC.

           MOVE WS-CON-AMVT0115 TO ATCL0001-TABLE-NAME.
           PERFORM 9020-DB2CHECK THRU 9029-DB2CHECK-EXIT.

           IF ATCL0001-SEM-ERROS
              IF AMVT0115-OK AND AMCV7300-ICTI EQUAL ZEROS
                 MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                 MOVE AMCK0001-CON-023      TO AMCV7301-CTIPSOC-MSG
                 MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
              ELSE
                 IF AMVT0115-NOTFND AND AMCV7300-ICTI EQUAL WS-CON-N1
                    MOVE ATCK0002-ERROS-FUNCAO TO ATCL0001-IND-ERROS
                    MOVE AMCK0001-CON-023      TO AMCV7301-CTIPSOC-MSG
                    MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
                 END-IF
              END-IF
           ELSE
              MOVE AMCK0001-CON-500      TO AMCV7301-CTIPSOC-MSG
              MOVE WS-CON-1              TO AMCV7301-CTIPSOC-S
           END-IF.
      *
       9500-SELECT-AMT01-EXIT.
           EXIT.
      ******************************************************************
      *                    ROTINAS PRE-CODIFICADAS                     *
      ******************************************************************
           EXEC SQL INCLUDE AMCI1062 END-EXEC.
      *
           EXEC SQL INCLUDE ATCP0002 END-EXEC.
           EXEC SQL INCLUDE ATCP0007 END-EXEC.
           EXEC SQL INCLUDE ATCP0009 END-EXEC.

           EXEC SQL INCLUDE AMCPCL00 END-EXEC.
ALT03      EXEC SQL INCLUDE AMCPGM00 END-EXEC.
           EXEC SQL INCLUDE AMCPDC00 END-EXEC.
           EXEC SQL INCLUDE AMCPDC01 END-EXEC.
           EXEC SQL INCLUDE AMCI0100 END-EXEC.
           EXEC SQL INCLUDE AMCI1014 END-EXEC.
           EXEC SQL INCLUDE AMCI1500 END-EXEC.
           EXEC SQL INCLUDE CMCI0300 END-EXEC.
           EXEC SQL INCLUDE CMCP0100 END-EXEC.
           EXEC SQL INCLUDE SYCP0200 END-EXEC.

           EXEC SQL INCLUDE AMCI6000 END-EXEC.
           EXEC SQL INCLUDE AMCI6002 END-EXEC.
           EXEC SQL INCLUDE AMCI6006 END-EXEC.
           EXEC SQL INCLUDE AMCI6008 END-EXEC.
           EXEC SQL INCLUDE AMCI6010 END-EXEC.

           EXEC SQL INCLUDE AMCPTB47 END-EXEC.
      *
           EXEC SQL INCLUDE AMCP0004 END-EXEC.
       COPY AMCP1000.
       COPY DPCP0010.
       COPY ATCP3000.
       COPY ATCP6000.
      * C82065 (I)
       COPY CICP0011.
      * C82065 (F)
      *--- CHAMADA PROGRAMA SYR45000
 mab***    EXEC SQL INCLUDE SYCP4500 END-EXEC.
      *
      *C123517 2021jun21
       COPY CLCP0001.
